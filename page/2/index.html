<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"jarod.vip",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"always",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="记录生活中的点点滴滴"><meta property="og:type" content="website"><meta property="og:title" content="Jarod&#39;s Blog"><meta property="og:url" content="https://jarod.vip/page/2/index.html"><meta property="og:site_name" content="Jarod&#39;s Blog"><meta property="og:description" content="记录生活中的点点滴滴"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="Jarod"><meta property="article:tag" content="VPS,hexo,linux,debian,windows,macos"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://jarod.vip/page/2/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!0,isPost:!1,lang:"zh-CN"}</script><title>Jarod's Blog</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-R131WF8QZC"></script><script>function gtag(){dataLayer.push(arguments)}CONFIG.hostname===location.hostname&&(window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-R131WF8QZC"))</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?e67344a16e268228733f496a595ecb7a",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Jarod's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Jarod's Blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content index posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/06/linux%E7%BB%88%E7%AB%AF%E4%B8%8B%E6%88%AA%E5%9B%BE/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/06/linux%E7%BB%88%E7%AB%AF%E4%B8%8B%E6%88%AA%E5%9B%BE/" class="post-title-link" itemprop="url">Linux终端下截图</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-06 00:06:22" itemprop="dateCreated datePublished" datetime="2022-01-06T00:06:22+08:00">2022-01-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>916</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="网页截图"><a href="#网页截图" class="headerlink" title="网页截图"></a>网页截图</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libqt4-webkit libqt4-dev g++ sudo </span><br><span class="line">apt-get install xvfb sudo </span><br><span class="line">apt-get install cutycapt</span><br></pre></td></tr></table></figure><p>安装中文字体：</p><p>复制windows下的字体文件到&#x2F;usr&#x2F;share&#x2F;fonts&#x2F;目录下</p><p>执行fc-cache刷新字体缓存</p><p>使用方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xvfb-run cutycapt --url=http://malu.me --out=malu.png</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="注："><a href="#注：" class="headerlink" title="注："></a>注：</h3><blockquote><p>个人用户字体文件在~&#x2F;.local&#x2F;share&#x2F;fonts</p><p>系统字体文件在&#x2F;usr&#x2F;share&#x2F;fonts</p><p>字体配置文件在&#x2F;etc&#x2F;fonts&#x2F;</p></blockquote><h3 id="更多命令行截图参考："><a href="#更多命令行截图参考：" class="headerlink" title="更多命令行截图参考："></a>更多命令行截图参考：</h3><p>Ghost.py网页截图: <a target="_blank" rel="noopener" href="http://git.malu.me/Ghost.py%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/">http://git.malu.me/Ghost.py%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/</a></p><h1 id="显示桌面截图"><a href="#显示桌面截图" class="headerlink" title="显示桌面截图"></a>显示桌面截图</h1><p>需要安装fbcat</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install fbcat</span><br></pre></td></tr></table></figure><p>使用脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">NAME=`date &quot;+%Y%m%d_%H_%M_%S&quot;`</span><br><span class="line">PNG_PATH=&quot;/tmp/fbcat_&quot;$NAME&quot;.png&quot;</span><br><span class="line">fbgrab $PNG_PATH &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">sz $PNG_PATH</span><br></pre></td></tr></table></figure><h1 id="摄像头截图"><a href="#摄像头截图" class="headerlink" title="摄像头截图"></a>摄像头截图</h1><p>借助命令streamer：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install streamer</span><br></pre></td></tr></table></figure><p>使用脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">NAME=`date &quot;+%Y%m%d_%H_%M_%S&quot;`</span><br><span class="line">streamer -c /dev/video0 -t 3 -r 0.1 -q -b 16 -o /root/camera/jp_$NAME-00.jpeg &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">sz /root/camera/jp_$NAME-02.jpeg</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">killall streamer</span></span><br></pre></td></tr></table></figure><p>其中：</p><p>-t 抓取3张图</p><p>-r 0.1帧率</p><p>以上参数为了给摄像头启动时间（部分摄像头会休眠）</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/06/%E4%BA%8C%E7%BA%A7proxy%E9%83%A8%E7%BD%B2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/06/%E4%BA%8C%E7%BA%A7proxy%E9%83%A8%E7%BD%B2/" class="post-title-link" itemprop="url">二级proxy部署</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-06 00:05:29" itemprop="dateCreated datePublished" datetime="2022-01-06T00:05:29+08:00">2022-01-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>4k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>4 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>shadowsocks:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install -y python-pip python-m2crypto</span><br><span class="line">pip install shadowsocks</span><br></pre></td></tr></table></figure><p>Debian &#x2F; Ubuntu:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install python-pip</span><br><span class="line">pip install shadowsocks</span><br></pre></td></tr></table></figure><p>CentOS:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install python-setuptools &amp;&amp; easy_install pip</span><br><span class="line">pip install shadowsocks</span><br></pre></td></tr></table></figure><p>启动：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssserver -p 3000 -k password -m aes-128-cfb -d start</span><br></pre></td></tr></table></figure><p>停止：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssserver -d stop</span><br></pre></td></tr></table></figure><p>二级COW架设源码:<a target="_blank" rel="noopener" href="https://github.com/cyfdecyf/cow">https://github.com/cyfdecyf/cow</a></p><p>安装过程：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L git.io/cow  bash</span><br></pre></td></tr></table></figure><p>配置文件路径:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.cow/rc</span><br></pre></td></tr></table></figure><p>手工安装：</p><p><a target="_blank" rel="noopener" href="http://dl.chenyufei.info/cow/0.9.6/cow-linux64-0.9.6.gz">http://dl.chenyufei.info/cow/0.9.6/cow-linux64-0.9.6.gz</a></p><p>配置文件：</p><p><a target="_blank" rel="noopener" href="https://raw.github.com/cyfdecyf/cow/0.9.6/doc/sample-config/rc">https://raw.github.com/cyfdecyf/cow/0.9.6/doc/sample-config/rc</a> &#x2F;root&#x2F;.cow&#x2F;rc</p><h1 id="二级proxy部署-第二篇"><a href="#二级proxy部署-第二篇" class="headerlink" title="二级proxy部署 第二篇"></a>二级proxy部署 第二篇</h1><p>上面写的是shadowsocks+cow实现二级proxy，接下来用一种简单的方式来实现二级proxy：</p><p>首先，一级proxy开启ssh服务。</p><p>二级proxy上用SSH端口转发：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -N -f -D 0.0.0.0:8888 username@ssh.malu.me</span><br></pre></td></tr></table></figure><p>输入密码，这段命令意思是连接远程主机ssh.malu.me,然后在本地0.0.0.0地址、端口8888上开启socket5监听。</p><p>这样只要访问二级proxy上的socket5代理就能穿过两层代理了。</p><h1 id="二级proxy部署-自动脚本"><a href="#二级proxy部署-自动脚本" class="headerlink" title="二级proxy部署 自动脚本"></a>二级proxy部署 自动脚本</h1><p>相关参数根据实际修改</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/expect -f</span></span><br><span class="line">set timeout 30</span><br><span class="line">set host ssh.malu.me</span><br><span class="line">set name root</span><br><span class="line">set passwd userpasswd</span><br><span class="line">set port 22</span><br><span class="line">set lisenport 8888</span><br><span class="line">spawn sudo /etc/init.d/ssh start</span><br><span class="line">expect &quot;*#&quot;</span><br><span class="line">spawn killall ssh</span><br><span class="line">expect &quot;*#&quot;</span><br><span class="line">spawn ssh -NfR 1234:localhost:2222 $host -l $name -p $port</span><br><span class="line">expect &#123;</span><br><span class="line">&quot;yes/no&quot; &#123; send &quot;yes\r&quot;; exp_continue &#125;</span><br><span class="line">&quot;password:&quot; &#123; sleep 1;send &quot;$passwd\r&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect &quot;*#&quot;</span><br><span class="line">spawn ssh $host -l $name -p $port</span><br><span class="line">expect &#123;</span><br><span class="line">&quot;yes/no&quot; &#123; send &quot;yes\r&quot;; exp_continue &#125;</span><br><span class="line">&quot;password:&quot; &#123; sleep 1;send &quot;$passwd\r&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect &quot;]$&quot;</span><br><span class="line">sleep 1</span><br><span class="line">send &quot;ssh -N -f -D 0.0.0.0:$lisenport root@localhost -p1234\r&quot;</span><br><span class="line">expect &#123;</span><br><span class="line">&quot;yes/no&quot; &#123; send &quot;yes\r&quot;; exp_continue &#125;</span><br><span class="line">&quot;password:&quot; &#123; sleep 1;send &quot;$passwd\r&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect  &quot;]$&quot;</span><br><span class="line">sleep 1</span><br><span class="line">send &quot;exit\r&quot; </span><br><span class="line">expect eof</span><br><span class="line">exit</span><br></pre></td></tr></table></figure><h1 id="二级proxy部署-直连windows"><a href="#二级proxy部署-直连windows" class="headerlink" title="二级proxy部署 - 直连windows"></a>二级proxy部署 - 直连windows</h1><p>windows下安装openssh</p><p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/PowerShell/Win32-OpenSSH/releases">https://github.com/PowerShell/Win32-OpenSSH/releases</a></p><p>1.解压OpenSSH-Win64.zip到C:\Program Files\OpenSSH目录下，在DOS窗口进入OpenSSH目录</p><p>2.安装SSH host keys</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\ssh-keygen.exe -A</span><br></pre></td></tr></table></figure><p>3.打开防火墙22端口</p><p>4.安装SSHD服务并在服务窗口找到名为“SSHD”的服务，右键将其启动，并设置为随操作系统自动启动</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\sshd.exe install</span><br></pre></td></tr></table></figure><p>也可以直接启动：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\sshd.exe</span><br></pre></td></tr></table></figure><p>5.查看启动端口,如果需要监听外网，可以修改当前目录sshd_config文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ant</span><br></pre></td></tr></table></figure><p>sshd_config:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ListenAddress 0.0.0.0</span><br></pre></td></tr></table></figure><h1 id="内网穿透"><a href="#内网穿透" class="headerlink" title="内网穿透"></a>内网穿透</h1><p>根据二级proxy的原理，实质上是在两台服务器之间实现端口转发。</p><p>那么对应内网的服务器，只要能访问外网，那么利用SSH隧道端口映射就能实现内网穿透。</p><p>首先需要一台能远程登录的外网服务器。</p><p>然后内网服务器上执行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -gCNfR 80:localhost:8080 ssh.malu.me -l root -p 22</span><br></pre></td></tr></table></figure><p>g：在-L&#x2F;-R&#x2F;-D参数中，允许远程主机连接到建立的转发的端口，如果不加这个参数，只允许本地主机建立连接。</p><p>（-g参数如果不生效，其实这是ssh默认的安全策略所致，需要在服务端&#x2F;etc&#x2F;ssh&#x2F;sshd_config 添加 gatewayports yes 重启sshd即可）</p><p>C：压缩数据传输。</p><p>N：不执行脚本或命令，通常与-f连用。</p><p>f：后台认证用户&#x2F;密码，通常和-N连用，不用登录到远程主机。</p><p>-R 本地端口:目标IP:目标端口</p><p>将远程主机(服务器)的某个端口转发到本地端指定机器的指定端口. 工作原理是这样的, 远程主机上分配了一个 socket 侦听 port 端口, 一旦这个端口上有了连接, 该连接就经过安全通道转向出去, 同时本地主机和 host 的 hostport 端口建立连接. 可以在配置文件中指定端口的转发. 只有用 root 登录远程主机才能转发特权端口. IPv6 地址用另一种格式说明: port&#x2F;host&#x2F;hostport</p><p>-L 本地端口:目标IP:目标端口</p><p>将本地机(客户机)的某个端口转发到远端指定机器的指定端口. 工作原理是这样的, 本地机器上分配了一个 socket 侦听 port 端口, 一旦这个端口上有了连接, 该连接就经过安全通道转发出去, 同时远程主机和 host 的 hostport 端口建立连接. 可以在配置文件中指定端口的转发. 只有 root 才能转发特权端口. IPv6 地址用另一种格式说明: port&#x2F;host&#x2F;hostport</p><p>-D IP:port</p><p>指定一个本地机器 “动态的’’ 应用程序端口转发. 工作原理是这样的, 本地机器上分配了一个 socket 侦听 port 端口, 一旦这个端口上有了连接, 该连接就经过安全通道转发出去, 根据应用程序的协议可以判断出远程主机将和哪里连接. 目前支持 SOCKS4 协议, 将充当 SOCKS4 服务器. 只有 root 才能转发特权端口. 可以在配置文件中指定动态端口的转发.</p><h2 id="serveo"><a href="#serveo" class="headerlink" title="serveo"></a>serveo</h2><p>官网：<a target="_blank" rel="noopener" href="https://serveo.net/">https://serveo.net</a></p><p>eg:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -R testname:80:localhost:80 serveo.net -o ServerAliveInterval=60</span><br></pre></td></tr></table></figure><p>文档：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/d0b3991a9ce1">https://www.jianshu.com/p/d0b3991a9ce1</a></p><h2 id="zerotier"><a href="#zerotier" class="headerlink" title="zerotier"></a>zerotier</h2><p>官网：<a target="_blank" rel="noopener" href="https://www.zerotier.com/">https://www.zerotier.com</a></p><p>文档：<a target="_blank" rel="noopener" href="https://www.zerotier.com/manual">https://www.zerotier.com/manual</a></p><p>国内服务：<a target="_blank" rel="noopener" href="https://www.kancloud.cn/baoji/_enku/tx/_ip/_01/936021">https://www.kancloud.cn/baoji\_enku/tx\_ip\_01/936021</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 启动</span><br><span class="line">zerotier-one -d</span><br><span class="line"></span><br><span class="line"># 获取地址和服务状态</span><br><span class="line">zerotier-cli status</span><br><span class="line"></span><br><span class="line"># 加入、离开、列出网络</span><br><span class="line">zerotier-cli join &lt;Network ID&gt;</span><br><span class="line">zerotier-cli leave &lt;Network ID&gt;</span><br><span class="line">zerotier-cli listnetworks</span><br><span class="line"></span><br><span class="line"># 重启</span><br><span class="line">systemctl restart zerotier-one</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="报错：Cannot-connect-to-Zerotier-service"><a href="#报错：Cannot-connect-to-Zerotier-service" class="headerlink" title="报错：Cannot connect to Zerotier service"></a>报错：Cannot connect to Zerotier service</h3><p>查看9993端口是否被占用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ab</span><br></pre></td></tr></table></figure><h1 id="二级proxy部署-轻量级SSH安装"><a href="#二级proxy部署-轻量级SSH安装" class="headerlink" title="二级proxy部署 - 轻量级SSH安装"></a>二级proxy部署 - 轻量级SSH安装</h1><p>下载地址：<a target="_blank" rel="noopener" href="https://matt.ucc.asn.au/dropbear/">https://matt.ucc.asn.au/dropbear/</a></p><p>dropbear的编译安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ./configure --prefix=/usr/local/dropbear --sysconfdir=/etc/dropbear --disable-pam </span><br><span class="line"># make PROGRAMS=&quot;dropbear dbclient dropbearkey dropbearconvert scp&quot;</span><br><span class="line"># make PROGRAMS=&quot;dropbear dbclient dropbearkey dropbearconvert scp&quot; install</span><br></pre></td></tr></table></figure><p>加入环境变量：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/usr/local/dropbear/bin:/usr/local/dropbear/sbin:$PATH</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/06/linux%E4%B8%8B%E6%9F%A5%E7%9C%8B%E7%BD%91%E9%80%9F%E8%84%9A%E6%9C%AC/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/06/linux%E4%B8%8B%E6%9F%A5%E7%9C%8B%E7%BD%91%E9%80%9F%E8%84%9A%E6%9C%AC/" class="post-title-link" itemprop="url">Linux下查看网速脚本</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-06 00:04:07" itemprop="dateCreated datePublished" datetime="2022-01-06T00:04:07+08:00">2022-01-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>2k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>2 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>使用方法:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./n1.sh eth0</span><br></pre></td></tr></table></figure><p>cat n1.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">eth=<span class="variable">$1</span></span><br><span class="line">RXpre=$(<span class="built_in">cat</span> /proc/net/dev  grep <span class="variable">$eth</span>  <span class="built_in">tr</span> : <span class="string">&quot; &quot;</span>  awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">TXpre=$(<span class="built_in">cat</span> /proc/net/dev  grep <span class="variable">$eth</span>  <span class="built_in">tr</span> : <span class="string">&quot; &quot;</span>  awk <span class="string">&#x27;&#123;print $10&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line">RXnext=$(<span class="built_in">cat</span> /proc/net/dev  grep <span class="variable">$eth</span>  <span class="built_in">tr</span> : <span class="string">&quot; &quot;</span>  awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">TXnext=$(<span class="built_in">cat</span> /proc/net/dev  grep <span class="variable">$eth</span>  <span class="built_in">tr</span> : <span class="string">&quot; &quot;</span>  awk <span class="string">&#x27;&#123;print $10&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">#clear</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\t RX `date +%k:%M:%S` TX&quot;</span></span><br><span class="line">RX=$((<span class="variable">$&#123;RXnext&#125;</span>-<span class="variable">$&#123;RXpre&#125;</span>))</span><br><span class="line">TX=$((<span class="variable">$&#123;TXnext&#125;</span>-<span class="variable">$&#123;TXpre&#125;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$RX</span> -lt 1024 ]];<span class="keyword">then</span></span><br><span class="line">RX=<span class="string">&quot;<span class="variable">$&#123;RX&#125;</span>B/s&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [[ <span class="variable">$RX</span> -gt 1048576 ]];<span class="keyword">then</span></span><br><span class="line">RX=$(<span class="built_in">echo</span> <span class="variable">$RX</span>  awk <span class="string">&#x27;&#123;print $1/1048576 &quot;MB/s&quot;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">RX=$(<span class="built_in">echo</span> <span class="variable">$RX</span>  awk <span class="string">&#x27;&#123;print $1/1024 &quot;KB/s&quot;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$TX</span> -lt 1024 ]];<span class="keyword">then</span></span><br><span class="line">TX=<span class="string">&quot;<span class="variable">$&#123;TX&#125;</span>B/s&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [[ <span class="variable">$TX</span> -gt 1048576 ]];<span class="keyword">then</span></span><br><span class="line">TX=$(<span class="built_in">echo</span> <span class="variable">$TX</span>  awk <span class="string">&#x27;&#123;print $1/1048576 &quot;MB/s&quot;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">TX=$(<span class="built_in">echo</span> <span class="variable">$TX</span>  awk <span class="string">&#x27;&#123;print $1/1024 &quot;KB/s&quot;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="iftop"><a href="#iftop" class="headerlink" title="iftop"></a>iftop</h1><p>1、iftop界面相关说明</p><p>界面上面显示的是类似刻度尺的刻度范围，为显示流量图形的长条作标尺用的。 中间的&lt;&#x3D; &#x3D;&gt;这两个左右箭头，表示的是流量的方向。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TX：发送流量 </span><br><span class="line">RX：接收流量 </span><br><span class="line">TOTAL：总流量 </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、iftop相关参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-i设定监测的网卡，如：# iftop -i eth1 </span><br><span class="line">-B 以bytes为单位显示流量(默认是bits)，如：# iftop -B </span><br><span class="line">-n使host信息默认直接都显示IP，如：# iftop -n </span><br><span class="line">-N使端口信息默认直接都显示端口号，如: # iftop -N </span><br><span class="line">-F显示特定网段的进出流量，如# iftop -F 10.10.1.0/24或# iftop -F 10.10.1.0/255.255.255.0 </span><br><span class="line">-h（display this message），帮助，显示参数信息 </span><br><span class="line">-p使用这个参数后，中间的列表显示的本地主机信息，出现了本机以外的IP信息; </span><br><span class="line">-b使流量图形条默认就显示; </span><br><span class="line">-f这个暂时还不太会用，过滤计算包用的; </span><br><span class="line">-P使host信息及端口信息默认就都显示; </span><br><span class="line">-m设置界面最上边的刻度的最大值，刻度分五个大段显示，例：# iftop -m 100M </span><br></pre></td></tr></table></figure><p>3、进入iftop画面后的一些操作命令(注意大小写)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">按h切换是否显示帮助; </span><br><span class="line">按n切换显示本机的IP或主机名; </span><br><span class="line">按s切换是否显示本机的host信息; </span><br><span class="line">按d切换是否显示远端目标主机的host信息; </span><br><span class="line">按t切换显示格式为2行/1行/只显示发送流量/只显示接收流量; </span><br><span class="line">按N切换显示端口号或端口服务名称; </span><br><span class="line">按S切换是否显示本机的端口信息; </span><br><span class="line">按D切换是否显示远端目标主机的端口信息; </span><br><span class="line">按p切换是否显示端口信息; </span><br><span class="line">按P切换暂停/继续显示; </span><br><span class="line">按b切换是否显示平均流量图形条; </span><br><span class="line">按B切换计算2秒或10秒或40秒内的平均流量; </span><br><span class="line">按T切换是否显示每个连接的总流量; </span><br><span class="line">按l打开屏幕过滤功能，输入要过滤的字符，比如ip,按回车后，屏幕就只显示这个IP相关的流量信息; </span><br><span class="line">按L切换显示画面上边的刻度;刻度不同，流量图形条会有变化; </span><br><span class="line">按j或按k可以向上或向下滚动屏幕显示的连接记录; </span><br><span class="line">按1或2或3可以根据右侧显示的三列流量数据进行排序; </span><br><span class="line">按&lt;根据左边的本机名或IP排序; </span><br><span class="line">按&gt;根据远端目标主机的主机名或IP排序; </span><br><span class="line">按o切换是否固定只显示当前的连接; </span><br><span class="line">按f可以编辑过滤代码</span><br><span class="line">按!可以使用Shell命令</span><br><span class="line">按q退出监控。</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/06/ssh%E5%8F%8D%E5%90%91%E8%BF%9E%E6%8E%A5/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/06/ssh%E5%8F%8D%E5%90%91%E8%BF%9E%E6%8E%A5/" class="post-title-link" itemprop="url">SSH反向连接</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-06 00:03:41" itemprop="dateCreated datePublished" datetime="2022-01-06T00:03:41+08:00">2022-01-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>1.8k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>2 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>首先2台主机都要安装ssh服务端：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install openssh-server</span><br></pre></td></tr></table></figure><p>如果有需要开启root远程登录，可以修改&#x2F;etc&#x2F;ssh&#x2F;sshd_config</p><p>找到PermitRootLogin no一行，改为PermitRootLogin yes</p><h3 id="A要控制B"><a href="#A要控制B" class="headerlink" title="A要控制B"></a>A要控制B</h3><p>A主机：外网，ip：123.123.123.123，sshd端口：2221</p><p>B主机：内网，sshd端口：2223</p><p>无论是外网主机A，还是内网主机B都需要跑ssh daemon</p><h3 id="1-首先在B上执行"><a href="#1-首先在B上执行" class="headerlink" title="1.首先在B上执行"></a>1.首先在B上执行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -NfR 1234:localhost:2223 user1@123.123.123.123 -p2221</span><br></pre></td></tr></table></figure><p>这句话的意思是将A主机的1234端口和B主机的2223端口绑定，相当于远程端口映射（Remote Port Forwarding）。</p><h3 id="2-这时在A主机上sshd会listen本地1234端口"><a href="#2-这时在A主机上sshd会listen本地1234端口" class="headerlink" title="2.这时在A主机上sshd会listen本地1234端口"></a>2.这时在A主机上sshd会listen本地1234端口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh localhost -p1234</span><br></pre></td></tr></table></figure><h3 id="自动登录"><a href="#自动登录" class="headerlink" title="自动登录"></a>自动登录</h3><p>方法1.在内网B主机上生产公钥和私钥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen</span><br></pre></td></tr></table></figure><p>…(一直按Enter，最后在~&#x2F;.ssh&#x2F;下生成密钥)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls ~/.ssh/</span><br><span class="line">id_rsa id_rsa.pub known_hosts</span><br></pre></td></tr></table></figure><p>复制B主机上生成的id_rsa.pub公钥到外网A主机上，并将内容加入到~&#x2F;.ssh&#x2F;authorized_keys中</p><p>方法2.直接在B主机上执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-copy-id user1@123.123.123.123</span><br></pre></td></tr></table></figure><h3 id="SSH-keygen-根据私钥生成公钥"><a href="#SSH-keygen-根据私钥生成公钥" class="headerlink" title="SSH-keygen 根据私钥生成公钥"></a>SSH-keygen 根据私钥生成公钥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -y -f id_rsa</span><br></pre></td></tr></table></figure><h3 id="用Autossh保持ssh反向隧道一直连接"><a href="#用Autossh保持ssh反向隧道一直连接" class="headerlink" title="用Autossh保持ssh反向隧道一直连接"></a>用Autossh保持ssh反向隧道一直连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autossh -NfR 1234:localhost:2223 user1@123.123.123.123 -p2221</span><br></pre></td></tr></table></figure><p>注：默认autossh没有配置环境变量，需要自己设定</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export AUTOSSH_PIDFILE=/var/run/autossh.pid</span><br><span class="line">export AUTOSSH_POLL=60</span><br><span class="line">export AUTOSSH_FIRST_POLL=30</span><br><span class="line">export AUTOSSH_GATETIME=0</span><br><span class="line">export AUTOSSH_DEBUG=1</span><br></pre></td></tr></table></figure><p>为了保证开机时就启动，需要把以上环境变量写入&#x2F;etc&#x2F;profile中</p><p>然后在&#x2F;etc&#x2F;init&#x2F;rc.local中添加：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autossh -NfR 1234:localhost:2223 user1@123.123.123.123 -p2221</span><br></pre></td></tr></table></figure><h3 id="使用curl让反向隧道保持连接"><a href="#使用curl让反向隧道保持连接" class="headerlink" title="使用curl让反向隧道保持连接"></a>使用curl让反向隧道保持连接</h3><p>在A主机上配置计划任务：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * * netstat -lnt4pgrep &quot;sshd: root&quot;awk &#x27;&#123;print $4&#125;&#x27;awk -F &#x27;:&#x27; &#x27;&#123;print $2&#125;&#x27;xargs -i curl localhost:&#123;&#125;</span><br></pre></td></tr></table></figure><p>定时向本地的隧道端口请求数据</p><h1 id="其他技巧"><a href="#其他技巧" class="headerlink" title="其他技巧"></a>其他技巧</h1><p>默认只能通过ssh localhost -p来连接，如果要实现远程登录内网B主机，可以在A主机上再开一个本地端口转发：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -g -L 80:localhost:1234 localhost</span><br></pre></td></tr></table></figure><p>远程就可以通过A主机的80端口去连接B主机了。</p><p>我们甚至可以启动socket5隧道：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -N -f -D 0.0.0.0:8888 root@localhost -p1234</span><br></pre></td></tr></table></figure><h3 id="ssh-指定私钥文件"><a href="#ssh-指定私钥文件" class="headerlink" title="ssh 指定私钥文件:"></a>ssh 指定私钥文件:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i /root/.ssh/idrsa root@malu.me -p 2111</span><br></pre></td></tr></table></figure><h3 id="ssh取消主机密钥检查"><a href="#ssh取消主机密钥检查" class="headerlink" title="ssh取消主机密钥检查"></a>ssh取消主机密钥检查</h3><p>1.使用ssh连接远程主机时加上“-o StrictHostKeyChecking&#x3D;no”的选项，如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh  -o StrictHostKeyChecking=no  192.168.xxx.xxx</span><br></pre></td></tr></table></figure><p>2.一个彻底去掉这个提示的方法是，修改&#x2F;etc&#x2F;ssh&#x2F;ssh_config文件（或$HOME&#x2F;.ssh&#x2F;config）中的配置，添加如下两行配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StrictHostKeyChecking no</span><br><span class="line">UserKnownHostsFile /dev/null</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/06/vim%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/06/vim%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Vim日常笔记</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-06 00:03:06" itemprop="dateCreated datePublished" datetime="2022-01-06T00:03:06+08:00">2022-01-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>659</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="Vim乱码处理"><a href="#Vim乱码处理" class="headerlink" title="Vim乱码处理"></a>Vim乱码处理</h1><p>在<code>/etc/vim/vimrc</code>文件末尾添加</p><p><code>set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936</code></p><h1 id="vim-去掉自动注释和自动回车"><a href="#vim-去掉自动注释和自动回车" class="headerlink" title="vim 去掉自动注释和自动回车"></a>vim 去掉自动注释和自动回车</h1><p>取消</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:set paste</span><br></pre></td></tr></table></figure><p>恢复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:set paste!</span><br></pre></td></tr></table></figure><h1 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h1><p>vim删除</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x        删除当前光标下的字符</span><br><span class="line">dw       删除光标之后的单词剩余部分。</span><br><span class="line">d$       删除光标之后的该行剩余部分。</span><br><span class="line">dd       删除当前行。</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>vim撤销、恢复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">u   撤销上一步的操作</span><br><span class="line">Ctrl+r 恢复上一步被撤销的操作</span><br></pre></td></tr></table></figure><p>快速移动光标</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w    移动到下一个单词</span><br></pre></td></tr></table></figure><p>行编辑</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+v,hjkl,Shift+i</span><br></pre></td></tr></table></figure><p>vim折叠</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set foldmethod=syntax 或者是其它方法。设置好了之后可以用 zM 和 zR 来打开或关闭所有的折叠。</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>设置行号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:set number</span><br></pre></td></tr></table></figure><p>设置相对行号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:set relativenumber</span><br></pre></td></tr></table></figure><p>查找时忽略大小写</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set ic</span><br></pre></td></tr></table></figure><p>取消设置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:set no*****</span><br></pre></td></tr></table></figure><p>每行最后添加字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s/$/需要追加的字符</span><br></pre></td></tr></table></figure><h1 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h1><p>编辑~&#x2F;.vimrc文件</p><h3 id="vim中文乱码"><a href="#vim中文乱码" class="headerlink" title="vim中文乱码"></a>vim中文乱码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set encoding=utf-8</span><br></pre></td></tr></table></figure><h3 id="vim记录上次编辑的位置（编辑-x2F-vimrc文件）"><a href="#vim记录上次编辑的位置（编辑-x2F-vimrc文件）" class="headerlink" title="vim记录上次编辑的位置（编辑~&#x2F;.vimrc文件）"></a>vim记录上次编辑的位置（编辑~&#x2F;.vimrc文件）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">autocmd BufReadPost *</span><br><span class="line">      \  if line(&quot;&#x27;\&quot;&quot;) &gt; 0 &amp;&amp; line (&quot;&#x27;\&quot;&quot;) &lt;= line(&quot;$&quot;) </span><br><span class="line">      \      exe &quot;normal g&#x27;\&quot;&quot; </span><br><span class="line">      \  endif</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/06/wamp%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/06/wamp%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">WAMP本地环境搭建笔记</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-06 00:02:36" itemprop="dateCreated datePublished" datetime="2022-01-06T00:02:36+08:00">2022-01-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Win/" itemprop="url" rel="index"><span itemprop="name">Win</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>611</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="开启虚拟主机"><a href="#开启虚拟主机" class="headerlink" title="开启虚拟主机"></a>开启虚拟主机</h3><p>1.编辑文件 F:\wamp\bin\apache\apache2.4.9\conf\httpd.conf</p><p>去掉httpd-vhosts.conf的注释</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Virtual hosts</span><br><span class="line">Include conf/extra/httpd-vhosts.conf</span><br></pre></td></tr></table></figure><p>把Directory修改成如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory /&gt;</span><br><span class="line">    Order Deny,Allow</span><br><span class="line">    Deny from all</span><br><span class="line">Allow from all</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>2.编辑文件 F:\wamp\bin\apache\apache2.4.9\conf\extra\httpd-vhosts.conf</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot D:/00_cloud/server-php</span><br><span class="line">    ServerName server-php.com</span><br><span class="line">    &lt;Directory &quot;D:/00_cloud/server-php&quot;&gt;</span><br><span class="line">    Options Indexes FollowSymLinks</span><br><span class="line">    AllowOverride None</span><br><span class="line">    Order allow,deny</span><br><span class="line">    Allow from all</span><br><span class="line">    &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3.修改 C:\Windows\System32\drivers\etc\hosts</p><p>添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 server-php.com</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/06/windows%E6%97%A5%E5%B8%B8%E6%93%8D%E4%BD%9C/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/06/windows%E6%97%A5%E5%B8%B8%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">Windows日常操作</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-06 00:01:26" itemprop="dateCreated datePublished" datetime="2022-01-06T00:01:26+08:00">2022-01-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Win/" itemprop="url" rel="index"><span itemprop="name">Win</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>5.6k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>5 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="启动时加载bat"><a href="#启动时加载bat" class="headerlink" title="启动时加载bat"></a>启动时加载bat</h2><p>运行： shell:startup -&gt; startup.vbs</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set ws=WScript.CreateObject(&quot;WScript.Shell&quot;)</span><br><span class="line">ws.Run &quot;C:\auto_run\startup\start.bat /start&quot;,0</span><br></pre></td></tr></table></figure><h1 id="命令行工具"><a href="#命令行工具" class="headerlink" title="命令行工具"></a>命令行工具</h1><h2 id="windows-curl"><a href="#windows-curl" class="headerlink" title="windows curl"></a>windows curl</h2><p>下载地址：<a target="_blank" rel="noopener" href="https://curl.haxx.se/windows/">https://curl.haxx.se/windows/</a></p><h2 id="计算文件Hash值："><a href="#计算文件Hash值：" class="headerlink" title="计算文件Hash值："></a>计算文件Hash值：</h2><p>在Windows中可以通过以下方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">certutil -hashfile yourfilename MD5</span><br><span class="line">certutil -hashfile yourfilename SHA1</span><br><span class="line">certutil -hashfile yourfilename SHA256</span><br></pre></td></tr></table></figure><p>而在Linux下，命令为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">md5sum yourfilename</span><br><span class="line">sha1sum yourfilename</span><br><span class="line">sha256sum yourfilename</span><br></pre></td></tr></table></figure><h2 id="windows命令行工具-nircmd"><a href="#windows命令行工具-nircmd" class="headerlink" title="windows命令行工具 nircmd"></a>windows命令行工具 nircmd</h2><p>下载地址：<a target="_blank" rel="noopener" href="http://www.nirsoft.net/utils/nircmd.html">http://www.nirsoft.net/utils/nircmd.html</a></p><p>关闭监视器：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nircmd.exe monitor off</span><br></pre></td></tr></table></figure><p>锁屏：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nircmd.exe lockws</span><br></pre></td></tr></table></figure><p>截屏：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nircmd.exe savescreenshotfull &quot;f:\tmp\shot.png&quot;</span><br></pre></td></tr></table></figure><p>设置鼠标在屏幕位置:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nircmd.exe setcursor 100 50</span><br></pre></td></tr></table></figure><p>按鼠标键:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">① sendmouse right click 右键鼠标</span><br><span class="line">② sendmouse left click  左键鼠标</span><br><span class="line">③ sendmouse left dblclick 双击鼠标左键</span><br><span class="line">④ sendmouse left down  按下鼠标左键</span><br><span class="line">⑤ sendmouse left up  松开鼠标左键</span><br><span class="line">⑥ sendmouse middle click</span><br></pre></td></tr></table></figure><h2 id="工具集"><a href="#工具集" class="headerlink" title="工具集"></a>工具集</h2><p>视频下载工具 annie</p><p><a target="_blank" rel="noopener" href="https://github.com/iawia002/annie">https://github.com/iawia002/annie</a></p><p>视频转码工具 FFmpeg</p><p><a target="_blank" rel="noopener" href="https://www.ffmpeg.org/">https://www.ffmpeg.org/</a></p><p>比如mp4转mp3: <code>ffmpeg -i xx.mp4 xx.mp3</code></p><p>tcping</p><p><a target="_blank" rel="noopener" href="https://elifulkerson.com/projects/index.php">https://elifulkerson.com/projects/index.php</a></p><p>nircmd,wake_on_lan,GUIPropView</p><p><a target="_blank" rel="noopener" href="http://www.nirsoft.net/utils/index.html">http://www.nirsoft.net/utils/index.html</a></p><p>网络唤醒wol</p><p><a target="_blank" rel="noopener" href="https://www.depicus.com/wake-on-lan/wake-on-lan-cmd">https://www.depicus.com/wake-on-lan/wake-on-lan-cmd</a></p><p>设置分辨率 QRes</p><p><a target="_blank" rel="noopener" href="http://www.softpedia.com/progDownload/QRes-Download-618.html">http://www.softpedia.com/progDownload/QRes-Download-618.html</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QRes.exe /x:1920 /y:1080</span><br></pre></td></tr></table></figure><h2 id="windows开启关闭防火墙"><a href="#windows开启关闭防火墙" class="headerlink" title="windows开启关闭防火墙"></a>windows开启关闭防火墙</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NetSh Advfirewall set allprofiles state off   #关闭防火墙</span><br><span class="line">NetSh Advfirewall set allprofiles state on    #开启防火墙</span><br><span class="line">Netsh Advfirewall show allprofiles            #查看防火墙状态</span><br></pre></td></tr></table></figure><h2 id="在-Windows-10-中启用可匿名访问的共享"><a href="#在-Windows-10-中启用可匿名访问的共享" class="headerlink" title="在 Windows 10 中启用可匿名访问的共享"></a>在 Windows 10 中启用可匿名访问的共享</h2><p>就是不用输入用户名和密码，直接通过网上邻居可以访问的共享。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1、打开本地组策略编辑器（快捷键Win+R，打开运行，输入gpedit.msc，确定）；</span><br><span class="line">2、打开：“本地计算机策略-&gt;计算机配置-&gt;Windows设置-&gt;安全设置-&gt;本地策略-&gt;用户权限分配”；</span><br><span class="line">3、找到：“拒绝从网络访问这台计算机”，将列表中的“Guest”删除；</span><br><span class="line">4、打开：“本地计算机策略-&gt;计算机配置-&gt;Windows设置-&gt;安全设置-&gt;本地策略-&gt;安全选项”；</span><br><span class="line">5、找到：“网络访问：本地帐户的共享和安全模型”，改为：“仅来宾 - 对本地用户进行身份验证，其身份为来宾”；</span><br><span class="line">6、找到：“网络访问：将 Everyone 权限应用于匿名用户”，改为：“已启用”；</span><br><span class="line">7、找到：“账户：来宾账户状态”，改为：“已启用”；</span><br></pre></td></tr></table></figure><p>注意：如果访问共享文件夹时出现“你不能访问此共享文件夹，因为你组织的安全策略阻止未经身份验证的来宾访问，这些策略可帮助保护你的电脑免受网络上不安全设备或者恶意设备的威胁” 需要如下操作：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、打开本地组策略编辑器（快捷键Win+R，打开运行，输入gpedit.msc，确定）；</span><br><span class="line">2、在“计算机配置”中找到“管理模板”-&gt;“网络”-&gt;“Lanman工作站”；</span><br><span class="line">3、在本地策略编辑器的右侧双击“启用不安全的来宾登录”。选择“已启用”，并点击确定，解决问题。</span><br></pre></td></tr></table></figure><h2 id="Win10-开机自动登录"><a href="#Win10-开机自动登录" class="headerlink" title="Win10 开机自动登录"></a>Win10 开机自动登录</h2><p>方法一：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">control userpasswords2</span><br></pre></td></tr></table></figure><p>方法二：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netplwiz</span><br></pre></td></tr></table></figure><p>方法三：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32 netplwiz.dll,UsersRunDll</span><br></pre></td></tr></table></figure><p>方法四：</p><p>创建autologin.reg文件，双击导入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Win10-右键菜单Intel图形属性删除"><a href="#Win10-右键菜单Intel图形属性删除" class="headerlink" title="Win10 右键菜单Intel图形属性删除"></a>Win10 右键菜单Intel图形属性删除</h2><p>以<strong>管理员权限</strong>打开cmd，输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regsvr32 /u igfxDTCM.dll</span><br></pre></td></tr></table></figure><p>恢复</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regsvr32 igfxDTCM.dll</span><br></pre></td></tr></table></figure><h2 id="windows-删除进程"><a href="#windows-删除进程" class="headerlink" title="windows 删除进程"></a>windows 删除进程</h2><p>查看指定端口的连接信息:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano  findstr &quot;8080&quot;</span><br></pre></td></tr></table></figure><p>查看进程列表:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist  findstr &quot;java&quot;</span><br></pre></td></tr></table></figure><p>通过上面的方式可以查看占用端口号的进程ID:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill -PID 进程号 -F</span><br></pre></td></tr></table></figure><h1 id="win10"><a href="#win10" class="headerlink" title="win10"></a>win10</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>微软官方下载地址：<a target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/software-download/windows10">https://www.microsoft.com/zh-cn/software-download/windows10</a></p><h2 id="激活"><a href="#激活" class="headerlink" title="激活"></a>激活</h2><p>序列号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Home: TX9XD-98N7V-6WMQ6-BX7FG-H8Q99</span><br><span class="line">Home N: 3KHY7-WNT83-DGQKR-F7HPR-844BM</span><br><span class="line">Home Single Language: 7HNRX-D7KGG-3K4RQ-4WPJ4-YTDFH</span><br><span class="line">Home Country Specific: PVMJN-6DFY6-9CCP6-7BKTT-D3WVR</span><br><span class="line">Professional: W269N-WFGWX-YVC9B-4J6C9-T83GX</span><br><span class="line">Professional N: MH37W-N47XK-V7XM9-C7227-GCQG9</span><br><span class="line">Education: NW6C2-QMPVW-D7KKK-3GKT6-VCFB2</span><br><span class="line">Education N: 2WH4N-8QGBV-H22JP-CT43Q-MDWWJ</span><br><span class="line">Enterprise: NPPR9-FWDCX-D2C8J-H872K-2YT43</span><br><span class="line">Enterprise N: DPH2V-TTNVB-4X9Q3-TJR4H-KHJW4</span><br></pre></td></tr></table></figure><p>激活步骤：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX</span><br><span class="line">slmgr /skms kms8.msguides.com</span><br><span class="line">slmgr /ato</span><br></pre></td></tr></table></figure><h1 id="win11"><a href="#win11" class="headerlink" title="win11"></a>win11</h1><h2 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h2><p>微软官方下载地址：<a target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/software-download/windows11">https://www.microsoft.com/zh-cn/software-download/windows11</a></p><h2 id="绕过-TPM-2-0-检测"><a href="#绕过-TPM-2-0-检测" class="headerlink" title="绕过 TPM 2.0 检测"></a>绕过 TPM 2.0 检测</h2><p>Win11 会提示“该电脑无法运行 Win11”解决办法：</p><h3 id="1、注册表大法"><a href="#1、注册表大法" class="headerlink" title="1、注册表大法"></a>1、注册表大法</h3><p>在安装界面按 Shift+F10，打开命令行界面，输入 regedit 打开注册表，然后定位到：</p><blockquote><p><em>HKEY_LOCAL_MACHINE\SYSTEM\Setup</em></p></blockquote><p>创建一个名为“LabConfig”的项，接着在“LabConfig”下创建两个 DWORD 值：</p><ul><li>键为“BypassTPMCheck”，值为“00000001”</li><li>键为“BypassSecureBootCheck”，值为“00000001”</li><li>键为“BypassRAMCheck”，值为“00000001”</li></ul><p>保存退出后，上图的提示就消失了，就可以正常安装 Win11。</p><h3 id="2、修改-ISO-镜像"><a href="#2、修改-ISO-镜像" class="headerlink" title="2、修改 ISO 镜像"></a>2、修改 ISO 镜像</h3><p>如果想通过直接从 Win11 ISO 镜像运行 setup.exe 程序来升级系统，而非全新安装，还有另一种简单的解决方法。</p><p>需要找到 Win10 ISO 的 appraiserres.dll 文件，替换 Win11 ISO 的同名文件。完成后，需要使用第三方工具（如 Rufus 或 AnyBurn）重新创建 ISO 镜像，然后再次运行安装文件。</p><h2 id="激活-1"><a href="#激活-1" class="headerlink" title="激活"></a>激活</h2><p>win11激活工具</p><p><a target="_blank" rel="noopener" href="https://github.com/zbezj/HEU_KMS_Activator">https://github.com/zbezj/HEU_KMS_Activator</a></p><h1 id="脚本重连蓝牙耳机"><a href="#脚本重连蓝牙耳机" class="headerlink" title="脚本重连蓝牙耳机"></a>脚本重连蓝牙耳机</h1><p>首先去该网站下载：<a target="_blank" rel="noopener" href="http://bluetoothinstaller.com/bluetooth-command-line-tools/">蓝牙命令行管理工具</a></p><p>然后打开命令行，输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btdiscovery -s  # 扫描蓝牙设备，需要等待一会</span><br></pre></td></tr></table></figure><p>获取到设备的 DEVICE_ADDRESS 和 SERVICE_UUID</p><p>DEVICE_ADDRESS 是蓝牙设备的mac地址</p><p>SERVICE_UUID 是设备的服务ID，比如耳麦是1108，免提网关111E</p><h2 id="自动重新连接bat脚本"><a href="#自动重新连接bat脚本" class="headerlink" title="自动重新连接bat脚本"></a>自动重新连接bat脚本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">rem   The following line is needed only if you haven&#x27;t added Bluetooth Command Line Tools to system PATH</span><br><span class="line">REM set PATH=C:\Program Files (x86)\Bluetooth Command Line Tools\bin;%PATH%</span><br><span class="line"></span><br><span class="line">rem   Change the following 2 lines to match your device</span><br><span class="line">set DEVICE_ADDRESS=1C:52:16:58:8F:95</span><br><span class="line">set SERVICE_UUID=1108</span><br><span class="line"></span><br><span class="line">rem   If your device requires PIN code other than &#x27;0000&#x27;, uncomment and change the following line</span><br><span class="line">set PIN=0000</span><br><span class="line"></span><br><span class="line">rem   Remove the device. Ignoring possible error here </span><br><span class="line">btpair -u -b&quot;%DEVICE_ADDRESS%&quot;</span><br><span class="line"></span><br><span class="line">rem   Pair the device</span><br><span class="line">btpair -p%PIN% -b&quot;%DEVICE_ADDRESS%&quot;</span><br><span class="line">if errorlevel 1 goto error</span><br><span class="line"></span><br><span class="line">rem   Enable the service</span><br><span class="line">REM btcom -c -b&quot;%DEVICE_ADDRESS%&quot; -s%SERVICE_UUID%</span><br><span class="line">REM if errorlevel 1 goto error</span><br><span class="line"></span><br><span class="line">goto success</span><br><span class="line"></span><br><span class="line">rem   Allow user to read error message before window is closed</span><br><span class="line">:error</span><br><span class="line">pause</span><br><span class="line">exit</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="查看AC电源状态"><a href="#查看AC电源状态" class="headerlink" title="查看AC电源状态"></a>查看AC电源状态</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WMIC Path Win32_Battery Get BatteryStatus</span><br></pre></td></tr></table></figure><h1 id="操作系统中查看硬件制造商和BIOS版本"><a href="#操作系统中查看硬件制造商和BIOS版本" class="headerlink" title="操作系统中查看硬件制造商和BIOS版本"></a>操作系统中查看硬件制造商和BIOS版本</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dxdiag</span><br></pre></td></tr></table></figure><p>或者cmd里输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic bios get biosversion</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic bios get SMBIOSBIOSVersion</span><br></pre></td></tr></table></figure><h1 id="查看磁盘硬件名称"><a href="#查看磁盘硬件名称" class="headerlink" title="查看磁盘硬件名称"></a>查看磁盘硬件名称</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic diskdrive get caption</span><br></pre></td></tr></table></figure><h1 id="查看内存"><a href="#查看内存" class="headerlink" title="查看内存"></a>查看内存</h1><h3 id="查看内存信息"><a href="#查看内存信息" class="headerlink" title="查看内存信息"></a>查看内存信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic memorychip</span><br></pre></td></tr></table></figure><h3 id="查看内存硬件厂商"><a href="#查看内存硬件厂商" class="headerlink" title="查看内存硬件厂商"></a>查看内存硬件厂商</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic memorychip get Manufacturer</span><br></pre></td></tr></table></figure><h1 id="利用Windows内置工具测试硬盘速度"><a href="#利用Windows内置工具测试硬盘速度" class="headerlink" title="利用Windows内置工具测试硬盘速度"></a>利用Windows内置工具测试硬盘速度</h1><p>测试默认磁盘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winsat disk</span><br></pre></td></tr></table></figure><p>指定磁盘进行测速</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winsat disk -drive d </span><br></pre></td></tr></table></figure><p>注：请使用管理员权限打开cmd，否则在win10下面最终测试结果会一闪而过</p><h1 id="windows下查看wifi信息"><a href="#windows下查看wifi信息" class="headerlink" title="windows下查看wifi信息"></a>windows下查看wifi信息</h1><p>进入cmd输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh wlan show interface</span><br></pre></td></tr></table></figure><h1 id="Win7下格式化成-FAT32"><a href="#Win7下格式化成-FAT32" class="headerlink" title="Win7下格式化成 FAT32"></a>Win7下格式化成 FAT32</h1><p>右键管理员身份打开cmd</p><p>如果你格式化的是E盘</p><p>输入format E: &#x2F;fs:fat32</p><p>回车后会提示输入卷标，就是指该分区名称</p><h1 id="win8远程连接win10"><a href="#win8远程连接win10" class="headerlink" title="win8远程连接win10"></a>win8远程连接win10</h1><p>1.账户前面需跟计算机名,如:计算机名\用户名.</p><p>2.win10上，运行gpedit.msc-计算机配置-Windows设置-安全设置-本地策略-安全选项-网络访问：本地账户的共享安全模型</p><p>设置成：经典-对本地用户进行身份验证,不改变其本来身份</p><h1 id="指定用户访问共享samba"><a href="#指定用户访问共享samba" class="headerlink" title="指定用户访问共享samba"></a>指定用户访问共享samba</h1><p>清除用户记录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use \\192.168.1.1 /del</span><br></pre></td></tr></table></figure><p>指定用户登录（需要输入密码）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use \\192.168.1.1 /user:malu</span><br></pre></td></tr></table></figure><p>携带密码登录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use \\192.168.1.1 &quot;password&quot; /user:malu /persistent:yes</span><br></pre></td></tr></table></figure><p>查看状态：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use</span><br></pre></td></tr></table></figure><p>自动登录脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">net use \\192.168.0.1 /delete</span><br><span class="line">net use \\192.168.0.1 &quot;password&quot; /user:malu /persistent:yes</span><br><span class="line">explorer \\192.168.0.1\</span><br></pre></td></tr></table></figure><h1 id="指定DNS"><a href="#指定DNS" class="headerlink" title="指定DNS"></a>指定DNS</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">netsh interface ip set dns name=&quot;本地连接&quot; source=dhcp</span><br><span class="line">netsh interface ip set dns name=&quot;以太网&quot; source=dhcp</span><br><span class="line">netsh interface ip add dns &quot;以太网&quot; 192.168.11.200</span><br><span class="line">netsh interface ip add dns &quot;本地连接&quot; 192.168.11.200</span><br><span class="line">netsh interface ip add dns &quot;以太网&quot; 61.177.7.1 index=2</span><br><span class="line">netsh interface ip add dns &quot;本地连接&quot; 61.177.7.1 index=2</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/05/nodejs/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/05/nodejs/" class="post-title-link" itemprop="url">Nodejs</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-05 23:53:33" itemprop="dateCreated datePublished" datetime="2022-01-05T23:53:33+08:00">2022-01-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>4.1k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>4 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>本文记录nvm、node、npm、yarn安装过程</p><h1 id="Windows下安装"><a href="#Windows下安装" class="headerlink" title="Windows下安装"></a>Windows下安装</h1><p>nvm-windowns下载 <a target="_blank" rel="noopener" href="https://github.com/coreybutler/nvm-windows/releases">https://github.com/coreybutler/nvm-windows/releases</a></p><h2 id="切换nvm安装源："><a href="#切换nvm安装源：" class="headerlink" title="切换nvm安装源："></a>切换nvm安装源：</h2><p>在 nvm 的安装路径下，找到 settings.txt，在后面加上这两行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node_mirror: https://npm.taobao.org/mirrors/node/</span><br><span class="line">npm_mirror: https://npm.taobao.org/mirrors/npm/</span><br></pre></td></tr></table></figure><p>切换npm安装源：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><h1 id="Linux下安装"><a href="#Linux下安装" class="headerlink" title="Linux下安装"></a>Linux下安装</h1><p>官方地址：<a target="_blank" rel="noopener" href="https://github.com/creationix/nvm">https://github.com/creationix/nvm</a></p><p>Linux下推荐使用nvm来安装nodejs</p><h2 id="安装nvm"><a href="#安装nvm" class="headerlink" title="安装nvm"></a>安装nvm</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh  bash</span><br></pre></td></tr></table></figure><p>脚本会自动把以下执行环境写入.bashrc：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export NVM_DIR=&quot;$HOME/.nvm&quot;</span><br><span class="line">[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;  # This loads nvm</span><br><span class="line">[ -s &quot;$NVM_DIR/bash_completion&quot; ] &amp;&amp; \. &quot;$NVM_DIR/bash_completion&quot;  # This loads nvm bash_completion</span><br></pre></td></tr></table></figure><h2 id="安装nodejs"><a href="#安装nodejs" class="headerlink" title="安装nodejs"></a>安装nodejs</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install 10.8.0</span><br></pre></td></tr></table></figure><h3 id="国内使用淘宝node镜像，加速nodejs安装过程："><a href="#国内使用淘宝node镜像，加速nodejs安装过程：" class="headerlink" title="国内使用淘宝node镜像，加速nodejs安装过程："></a>国内使用淘宝node镜像，加速nodejs安装过程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export NVM_NODEJS_ORG_MIRROR=https://npm.taobao.org/mirrors/node/</span><br><span class="line">nvm install 10.11.0</span><br></pre></td></tr></table></figure><p>或者：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NVM_NODEJS_ORG_MIRROR=https://npm.taobao.org/mirrors/node/ nvm install 10.11.0</span><br></pre></td></tr></table></figure><h3 id="Linux使用淘宝NPM镜像："><a href="#Linux使用淘宝NPM镜像：" class="headerlink" title="Linux使用淘宝NPM镜像："></a>Linux使用淘宝NPM镜像：</h3><p>编辑 ~&#x2F;.npmrc，添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">registry=https://npm.taobao.org/mirrors/npm/</span><br></pre></td></tr></table></figure><p>若不想将本源设置为默认源，只想使用本源安装某个软件包，可在安装包时采用以下用法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm --registry https://npm.taobao.org/mirrors/npm/ install &lt;packagename&gt;</span><br></pre></td></tr></table></figure><h1 id="windows下安装"><a href="#windows下安装" class="headerlink" title="windows下安装"></a>windows下安装</h1><p>直接去github下载msi安装包： <a target="_blank" rel="noopener" href="https://github.com/coreybutler/nvm-windows/releases">https://github.com/coreybutler/nvm-windows/releases</a></p><p>windows使用淘宝node镜像：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm node_mirror https://npm.taobao.org/mirrors/node/</span><br></pre></td></tr></table></figure><p>windows使用淘宝npm镜像：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm npm_mirror https://npm.taobao.org/mirrors/npm/</span><br></pre></td></tr></table></figure><h1 id="CNPM"><a href="#CNPM" class="headerlink" title="CNPM"></a>CNPM</h1><p>安装方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><h1 id="YARN"><a href="#YARN" class="headerlink" title="YARN"></a>YARN</h1><p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/yarnpkg/yarn/releases">https://github.com/yarnpkg/yarn/releases</a></p><p>使用文档：<a target="_blank" rel="noopener" href="https://yarnpkg.com/zh-Hans/docs">https://yarnpkg.com/zh-Hans/docs</a></p><h3 id="升级自身yarn"><a href="#升级自身yarn" class="headerlink" title="升级自身yarn"></a>升级自身yarn</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install yarn -g</span><br></pre></td></tr></table></figure><p>查看yarn版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn -v</span><br></pre></td></tr></table></figure><p>Yarn 设置淘宝镜像</p><p>1.查询当前配置的镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn config get registry</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.设置成淘宝镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn config set registry http://registry.npm.taobao.org/</span><br></pre></td></tr></table></figure><p>3.显示当前安装的全局yarn依赖库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn global list</span><br></pre></td></tr></table></figure><h3 id="npm与yarn-CLI-命令比较"><a href="#npm与yarn-CLI-命令比较" class="headerlink" title="npm与yarn CLI 命令比较"></a>npm与yarn CLI 命令比较</h3><p>npm (v5)</p><p>Yarn</p><p>npm install</p><p>yarn install</p><p>(不适用)</p><p>yarn install –flat</p><p>(不适用)</p><p>yarn install –har</p><p>npm install –no-package-lock</p><p>yarn install –no-lockfile</p><p>(不适用)</p><p>yarn install –pure-lockfile</p><p>npm install [package]</p><p>yarn add [package]</p><p>npm install [package] –save-dev</p><p>yarn add [package] –dev</p><p>(不适用)</p><p>yarn add [package] –peer</p><p>npm install [package] –save-optional</p><p>yarn add [package] –optional</p><p>npm install [package] –save-exact</p><p>yarn add [package] –exact</p><p>(不适用)</p><p>yarn add [package] –tilde</p><p>npm install [package] –global</p><p>yarn global add [package]</p><p>npm update –global</p><p>yarn global upgrade</p><p>npm rebuild</p><p>yarn install –force</p><p>npm uninstall [package]</p><p>yarn remove [package]</p><p>npm cache clean</p><p>yarn cache clean [package]</p><p>rm -rf node_modules &amp;&amp; npm install</p><p>yarn upgrade</p><h3 id="异常处理-使用yarn升级vue-cli后显示-‘vue’-不是内部或外部命令，也不是可运行的程序"><a href="#异常处理-使用yarn升级vue-cli后显示-‘vue’-不是内部或外部命令，也不是可运行的程序" class="headerlink" title="异常处理: 使用yarn升级vue cli后显示 ‘vue’ 不是内部或外部命令，也不是可运行的程序"></a>异常处理: 使用yarn升级vue cli后显示 ‘vue’ 不是内部或外部命令，也不是可运行的程序</h3><p>解决办法：把yarn的包执行目录添加到系统环境变量里。</p><p>处理方式：</p><p>1.执行yarn global dir 显示出yarn安装路径</p><p>2.定位到Yarn\bin目录，把该路径复制到系统环境变量Path里</p><h1 id="nvm使用方法"><a href="#nvm使用方法" class="headerlink" title="nvm使用方法"></a>nvm使用方法</h1><p>列出全部可以安装的版本号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm ls-remote</span><br></pre></td></tr></table></figure><p>（windows下为）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm list available</span><br></pre></td></tr></table></figure><p>安装指定版本nodejs</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install 9.3.0</span><br></pre></td></tr></table></figure><p>切换指定版本，切换效果是全局的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm use v8.0.0</span><br></pre></td></tr></table></figure><p>查看当前使用的版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm current</span><br></pre></td></tr></table></figure><p>查看本地安装版本，这个命令也能看到当前使用的是哪个版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm ls --depth 0</span><br></pre></td></tr></table></figure><p>清空模块</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf node_modules/ &amp;&amp; npm cache clean &amp;&amp; npm prune</span><br></pre></td></tr></table></figure><h1 id="npm的常用命令"><a href="#npm的常用命令" class="headerlink" title="npm的常用命令:"></a>npm的常用命令:</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">npm ci                #使用安装package.lock.json安装，锁定依赖版本</span><br><span class="line"></span><br><span class="line">npm -v                #显示版本，检查npm 是否正确安装。</span><br><span class="line"> </span><br><span class="line">npm install express   #安装express模块</span><br><span class="line"> </span><br><span class="line">npm install -g express  #全局安装express模块</span><br><span class="line"> </span><br><span class="line">npm list              #列出已安装模块</span><br><span class="line"> </span><br><span class="line">npm show express      #显示模块详情</span><br><span class="line"> </span><br><span class="line">npm update            #升级当前目录下的项目的所有模块</span><br><span class="line"> </span><br><span class="line">npm update express    #升级当前目录下的项目的指定模块</span><br><span class="line"> </span><br><span class="line">npm update -g express  #升级全局安装的express模块</span><br><span class="line"> </span><br><span class="line">npm uninstall express  #删除指定的模块</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="生成package-json文件"><a href="#生成package-json文件" class="headerlink" title="生成package.json文件"></a>生成package.json文件</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node init</span><br></pre></td></tr></table></figure><h1 id="其他安装方式-old"><a href="#其他安装方式-old" class="headerlink" title="其他安装方式 old"></a>其他安装方式 old</h1><p>快速安装过程:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y nodejs npm</span><br><span class="line">npm config set registry http://registry.npm.taobao.org  #使用淘宝源</span><br><span class="line">npm install -g n     #安装n模块</span><br><span class="line">n stable#升级到nodejs最新稳定版</span><br></pre></td></tr></table></figure><p>n后面也可以跟随版本号比如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n v0.10.26</span><br><span class="line">n 0.10.26</span><br></pre></td></tr></table></figure><p>编译安装：</p><p>nodejs下载地址：<a target="_blank" rel="noopener" href="https://nodejs.org/dist/">https://nodejs.org/dist/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget https://nodejs.org/download/rc/v4.0.0-rc.1/node-v4.0.0-rc.1.tar.gz</span><br><span class="line">tar -zxvf node-v4.0.0-rc.1.tar.gz</span><br><span class="line">cd node-v4.0.0-rc.1</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">node -v</span><br></pre></td></tr></table></figure><p>源码安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp &amp;&amp; \</span><br><span class="line">wget http://nodejs.org/dist/node-latest.tar.gz &amp;&amp; \</span><br><span class="line">tar xvzf node-latest.tar.gz &amp;&amp; \</span><br><span class="line">rm -f node-latest.tar.gz &amp;&amp; \</span><br><span class="line">cd node-v* &amp;&amp; \</span><br><span class="line">./configure &amp;&amp; \</span><br><span class="line">CXX=&quot;g++ -Wno-unused-local-typedefs&quot; make &amp;&amp; \</span><br><span class="line">CXX=&quot;g++ -Wno-unused-local-typedefs&quot; make install &amp;&amp; \</span><br><span class="line">cd /tmp &amp;&amp; \</span><br><span class="line">rm -rf /tmp/node-v* &amp;&amp; \</span><br><span class="line">npm install -g npm &amp;&amp; \</span><br><span class="line">printf &#x27;\n# Node.js\nexport PATH=&quot;node_modules/.bin:$PATH&quot;&#x27; &gt;&gt; /root/.bashrc</span><br></pre></td></tr></table></figure><h1 id="ERROR"><a href="#ERROR" class="headerlink" title="ERROR"></a>ERROR</h1><h3 id="MSBUILD-error-MSB3428-未能加载-Visual-C-组件“VCBuild-exe”。"><a href="#MSBUILD-error-MSB3428-未能加载-Visual-C-组件“VCBuild-exe”。" class="headerlink" title="MSBUILD : error MSB3428: 未能加载 Visual C++ 组件“VCBuild.exe”。"></a>MSBUILD : error MSB3428: 未能加载 Visual C++ 组件“VCBuild.exe”。</h3><p>解决方法：npm install –global –production windows-build-tools （全局安装windows构建工具）</p><h3 id="Module-build-failed-Error-ENOENT-no-such-file-or-directory-scandir-node-sass"><a href="#Module-build-failed-Error-ENOENT-no-such-file-or-directory-scandir-node-sass" class="headerlink" title="Module build failed: Error: ENOENT: no such file or directory, scandir node-sass"></a>Module build failed: Error: ENOENT: no such file or directory, scandir node-sass</h3><p>解决办法：npm rebuild node-sass</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/05/wol%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/05/wol%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92/" class="post-title-link" itemprop="url">wol网络唤醒</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-05 23:52:03" itemprop="dateCreated datePublished" datetime="2022-01-05T23:52:03+08:00">2022-01-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>802</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>首先网络唤醒需要硬件支持，目前大部分主流的板载网卡都支持，只需在bios里开启即可，笔记本中thinkpad全系列都支持，部分品牌的部分型号是不支持的，比如我有2台acer笔记本不支持。(很多时候wol是为了节电考虑，但是电源插座是必须通电的，笔记本也是)</p><h1 id="路由器下安装"><a href="#路由器下安装" class="headerlink" title="路由器下安装"></a>路由器下安装</h1><p>路由器中有相关插件可以直接进行唤醒，比如OpenWRT提供了wol和etherwake两个包来实现WOL功能</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">opkg update</span><br><span class="line">opkg install wol etherwake</span><br></pre></td></tr></table></figure><p>使用方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/wol 00:1D:5C:1F:5D:16</span><br><span class="line">/usr/bin/etherwake 00:1D:5C:1F:5D:16</span><br></pre></td></tr></table></figure><h1 id="ubuntu下安装："><a href="#ubuntu下安装：" class="headerlink" title="ubuntu下安装："></a>ubuntu下安装：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install wakeonlan</span><br></pre></td></tr></table></figure><p>使用方法:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wakeonlan 00:1D:5C:1F:5D:16</span><br></pre></td></tr></table></figure><h1 id="windows下安装"><a href="#windows下安装" class="headerlink" title="windows下安装:"></a>windows下安装:</h1><p>下载地址：<a target="_blank" rel="noopener" href="https://www.depicus.com/downloads/wolcmd.zip">https://www.depicus.com/downloads/wolcmd.zip</a></p><p>使用方法：</p><p>打开cmd，CD到下载wolcmd的文件路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wolcmd [mac address] [ip address] [subnet mask] [port number]</span><br></pre></td></tr></table></figure><p>比如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WolCmd.exe 1016932061F0 192.168.0.255 255.255.255.0 80</span><br></pre></td></tr></table></figure><h1 id="公网唤醒内网主机"><a href="#公网唤醒内网主机" class="headerlink" title="公网唤醒内网主机"></a>公网唤醒内网主机</h1><p>外网进行唤醒，前提是路由器上得设置端口映射，和mac绑定。</p><p>原理是这样的：</p><p>1.魔术包数据发送到外网地址的映射端口上。</p><p>2.由于做了映射，路由器会找到对应的IP地址。</p><p>3.IP与对应的mac地址绑定了，所以路由器自然得将数据包发到对应mac地址上。</p><p>4.此时数据包已经发到内网待唤醒主机上了，网卡判断数据帧符合唤醒内容，就把机器启动。</p><p>公网唤醒工具：<a target="_blank" rel="noopener" href="http://ip.malu.me/wol/">http://ip.malu.me/wol/</a></p><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p>断电后再通电自动唤醒：在BIOS中电源设置，Restore on AC设置为Last Stste。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/01/05/mysql%E7%BA%BF%E4%B8%8A%E4%B8%8E%E6%9C%AC%E5%9C%B0%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/01/05/mysql%E7%BA%BF%E4%B8%8A%E4%B8%8E%E6%9C%AC%E5%9C%B0%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5/" class="post-title-link" itemprop="url">MySQL线上与本地实时同步</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-01-05 23:51:19" itemprop="dateCreated datePublished" datetime="2022-01-05T23:51:19+08:00">2022-01-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:46" itemprop="dateModified" datetime="2022-09-29T21:27:46+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>5.9k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>5 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="运行环境："><a href="#运行环境：" class="headerlink" title="运行环境："></a>运行环境：</h3><p>线上：RDS（内网）+ECS</p><p>本地：xampp</p><p>由于本地只能访问ECS，需要在ECS上架设mysql代理：</p><p>参考这篇笔记：<a target="_blank" rel="noopener" href="http://git.malu.me/MySQL-Proxy/">http://git.malu.me/MySQL-Proxy/</a></p><h1 id="mysql线上与本地实现主从同步"><a href="#mysql线上与本地实现主从同步" class="headerlink" title="mysql线上与本地实现主从同步"></a>mysql线上与本地实现主从同步</h1><h3 id="ECS配置（作为主服务器master）"><a href="#ECS配置（作为主服务器master）" class="headerlink" title="ECS配置（作为主服务器master）:"></a>ECS配置（作为主服务器master）:</h3><p>修改配置文件:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#vim /etc/my.cnf</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>重启mysql：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/mysql restart</span><br></pre></td></tr></table></figure><p>在主服务器上建立帐户mysync并授权给slave主机:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -h localhost</span><br><span class="line"></span><br><span class="line">mysql&gt; GRANT REPLICATION SLAVE ON *.* to &#x27;mysync&#x27;@&#x27;%&#x27; identified by &#x27;passwd&#x27;;</span><br><span class="line"></span><br><span class="line">mysql&gt; show master status;    #查看master的状态</span><br><span class="line">+------------------+----------+--------------+------------------+</span><br><span class="line"> File              Position  Binlog_Do_DB  Binlog_Ignore_DB </span><br><span class="line">+------------------+----------+--------------+------------------+</span><br><span class="line"> mysql-bin.000002       532                                 </span><br><span class="line">+------------------+----------+--------------+------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">注：执行完此步骤后不要再操作主服务器MYSQL，防止主服务器状态值Position变化</span><br><span class="line"></span><br><span class="line">mysql&gt; show master logs;    #查看master二进制日志位置</span><br><span class="line"></span><br><span class="line">mysql&gt; show variables like &#x27;server_id&#x27;;   #查看server_id</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="本地xampp配置（作为从服务器slave）："><a href="#本地xampp配置（作为从服务器slave）：" class="headerlink" title="本地xampp配置（作为从服务器slave）："></a>本地xampp配置（作为从服务器slave）：</h3><p>修改配置文件:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X:\Xampp\mysql\bin\my.ini   #xampp默认配置文件</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>配置Slave：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; change master to  master_host=&#x27;mysql.malu.me&#x27;,master_port=3306,master_user=&#x27;mysync&#x27;,master_password=&#x27;passwd&#x27;,master_log_file=&#x27;mysql-bin.000001&#x27;,master_log_pos=532;</span><br><span class="line"></span><br><span class="line">mysql&gt; start slave;          #启动从服务器复制功能</span><br><span class="line"></span><br><span class="line">注：master_log_pos即为master主机状态里的Position</span><br><span class="line"></span><br><span class="line">mysql&gt; show slave status\G   #检查slave的状态</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>接下来往RDS写入数据的时候会自动同步到本地mysql</p><h1 id="mysql线上与本地实现主主同步"><a href="#mysql线上与本地实现主主同步" class="headerlink" title="mysql线上与本地实现主主同步"></a>mysql线上与本地实现主主同步</h1><p>双主架构需要mysql双方能互相通讯，但是本地mysql在内网，所以必须先让ECS穿透到内网:</p><p>内网穿透参考这篇笔记：<a target="_blank" rel="noopener" href="http://git.malu.me/%E4%BA%8C%E7%BA%A7proxy%E9%83%A8%E7%BD%B2/">http://git.malu.me/二级proxy部署/</a></p><h3 id="ECS-（作为master-A）"><a href="#ECS-（作为master-A）" class="headerlink" title="ECS （作为master-A）:"></a>ECS （作为master-A）:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">log-bin=mysql-bin                           #开启二进制日志功能</span><br><span class="line">server-id=1                                 #注意server-id的唯一性</span><br><span class="line">binlog-ignore-db = mysql,information_schema #忽略写入binlog日志的库</span><br><span class="line">relay-log=/app/mysql/relaylogs/relay-bin    #指定中继日志路径</span><br><span class="line">log_slave_updates=1                         #开启从库更新操作写入二进制日志功能*</span><br><span class="line">auto_increment_increment=2                  #双主复制中自增长字段的步长*</span><br><span class="line">auto_increment_offset=1                     #双主复制中自增长字段的起始值，主为1 副为2*</span><br><span class="line">sync_binlog = 1                             #可保证事务日志及时写入磁盘文件</span><br><span class="line">binlog-do-db = TestXXX                      #指定binlog日志记录哪个db</span><br><span class="line">slave-skip-errors                           #定义复制过程中从服务器可以自动跳过错误</span><br></pre></td></tr></table></figure><h3 id="本地xampp（作为master-B）："><a href="#本地xampp（作为master-B）：" class="headerlink" title="本地xampp（作为master-B）："></a>本地xampp（作为master-B）：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">log-bin=mysql-bin                           #开启二进制日志功能</span><br><span class="line">server-id=2                                 #注意server-id的唯一性</span><br><span class="line">binlog-ignore-db = mysql,information_schema #忽略写入binlog日志的库</span><br><span class="line">relay-log=/app/mysql/relaylogs/relay-bin    #指定中继日志路径</span><br><span class="line">log_slave_updates=1                         #开启从库更新操作写入二进制日志功能*</span><br><span class="line">auto_increment_increment=2                  #双主复制中自增长字段的步长*</span><br><span class="line">auto_increment_offset=2                     #双主复制中自增长字段的起始值，主为1 副为2*</span><br><span class="line">sync_binlog = 1                             #可保证事务日志及时写入磁盘文件</span><br><span class="line">binlog-do-db = TestXXX                      #指定binlog日志记录哪个db</span><br><span class="line">slave-skip-errors                           #定义复制过程中从服务器可以自动跳过错误</span><br></pre></td></tr></table></figure><h3 id="ECS执行："><a href="#ECS执行：" class="headerlink" title="ECS执行："></a>ECS执行：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT REPLICATION SLAVE ON *.* to &#x27;mysync&#x27;@&#x27;%&#x27; identified by &#x27;passwd&#x27;;</span><br><span class="line">mysql&gt; flush  privileges;</span><br><span class="line">mysql&gt; change master to  master_host=&#x27;127.0.0.1&#x27;,master_port=3307,master_user=&#x27;mysync&#x27;,master_password=&#x27;passwd&#x27;,master_log_file=&#x27;mysql-bin.000001&#x27;,master_log_pos=532;</span><br><span class="line"></span><br><span class="line">注：3307为隧道入口</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="本地xampp执行："><a href="#本地xampp执行：" class="headerlink" title="本地xampp执行："></a>本地xampp执行：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT REPLICATION SLAVE ON *.* to &#x27;mysync&#x27;@&#x27;%&#x27; identified by &#x27;passwd&#x27;;</span><br><span class="line">mysql&gt; flush  privileges;</span><br><span class="line">mysql&gt; change master to  master_host=&#x27;mysql.malu.me&#x27;,master_port=3306,master_user=&#x27;mysync&#x27;,master_password=&#x27;passwd&#x27;,master_log_file=&#x27;mysql-bin.000001&#x27;,master_log_pos=532;</span><br><span class="line"></span><br><span class="line">mysql&gt; start slave;          #启动master-B复制功能</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>接下来写入数据试试吧！</p><p>附录：</p><p>mysql主从自动切换脚本:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">cat &lt;&lt; README</span><br><span class="line">#####################################################################################################</span><br><span class="line">#Step 1: point the slave IP                                                                         #</span><br><span class="line">#Step 2: check the master and slave information whether good for change                             #</span><br><span class="line">#Step 3: stop old slave,then get new master binlog name and postation,then execute change master to #</span><br><span class="line">#Step 4: start slave,and show whether change successed.                                             #</span><br><span class="line">#####################################################################################################</span><br><span class="line">README</span><br><span class="line">User=root</span><br><span class="line">PW=123456</span><br><span class="line">read -p &quot;-- Please input the slave IP:&quot; Slave</span><br><span class="line">Master=$(mysql -u$&#123;User&#125; -h$&#123;Slave&#125; -p$&#123;PW&#125; -e &quot;show slave status \G;&quot;awk &#x27;/Master_Host/&#123;print $2&#125;&#x27;)</span><br><span class="line"> if [ -n &quot;$&#123;Master&#125;&quot; ]</span><br><span class="line"> then</span><br><span class="line">echo -e &quot;--Master IP:$&#123;Master&#125;,Slave IP:$&#123;Slave&#125;&quot;</span><br><span class="line">M=$(mysql -u$&#123;User&#125; -h$&#123;Master&#125; -p$&#123;PW&#125; -e &quot;show master status;&quot;awk &#x27;NR==2&#123;print $2&#125;&#x27;)</span><br><span class="line">S=$(mysql -u$&#123;User&#125; -h$&#123;Slave&#125; -p$&#123;PW&#125; -e &quot;show slave status \G;&quot;awk &#x27;/Read_Master_Log_Pos/&#123;print $2&#125;&#x27;)</span><br><span class="line">echo -e &quot;-- master pos:$&#123;M&#125;;slave pos is:$&#123;S&#125;&quot;</span><br><span class="line"> else</span><br><span class="line">echo &quot;-- Slave IP input wrong,please input again ! &quot;</span><br><span class="line">exit 1</span><br><span class="line"> fi</span><br><span class="line">       if [ &quot;$&#123;M&#125;&quot; -eq &quot;$&#123;S&#125;&quot; ]</span><br><span class="line">       then</span><br><span class="line">            read -p &quot;-- Master-Slave is accordance,input Yes to start changing:&quot; var</span><br><span class="line">            case &quot;$var&quot; in</span><br><span class="line">                [Yy]es)</span><br><span class="line">                    mysql -u$&#123;User&#125; -h$&#123;Slave&#125; -p$&#123;PW&#125; -e &quot;stop slave;reset slave;change master to master_host=&#x27;&#x27;;&quot;</span><br><span class="line">                    Pos=$(mysql -u$&#123;User&#125; -h$&#123;Slave&#125; -p$&#123;PW&#125; -e &quot;show master status;&quot;awk &#x27;NR==2&#123;print $2&#125;&#x27;)</span><br><span class="line">                    File=$(mysql -u$&#123;User&#125; -h$&#123;Slave&#125; -p$&#123;PW&#125; -e &quot;show master status;&quot;awk &#x27;NR==2&#123;print $1&#125;&#x27;)</span><br><span class="line">                    mysql -u$&#123;User&#125; -h$&#123;Master&#125; -p$&#123;PW&#125; -e &quot;stop slave;</span><br><span class="line">                    change master to master_user=&#x27;ideal&#x27;,master_host=&#x27;$&#123;Slave&#125;&#x27;,master_password=&#x27;123456&#x27;,master_log_file=&#x27;$&#123;File&#125;&#x27;,master_log_pos=$&#123;Pos&#125;;</span><br><span class="line">                   start slave;&quot;</span><br><span class="line">                   ;;</span><br><span class="line">                *)</span><br><span class="line">                   echo &quot;-- error input .... exit!&quot;</span><br><span class="line">                   ;;</span><br><span class="line">           esac</span><br><span class="line">               echo &quot;-- changing, please wait 3s....&quot;</span><br><span class="line">               sleep 3</span><br><span class="line">               echo &quot;-- change successfull,the new master is:$&#123;Slave&#125;,new slave is $&#123;Master&#125;&quot;</span><br><span class="line">                SlaveIOStatus=$(mysql -u$&#123;User&#125; -h$&#123;Master&#125; -p$&#123;PW&#125; -e &quot;show slave status \G;&quot;awk &#x27;/Slave_IO_Running/&#123;print $2&#125;&#x27;)</span><br><span class="line">                SlaveSQLStatus=$(mysql -u$&#123;User&#125; -h$&#123;Master&#125; -p$&#123;PW&#125; -e &quot;show slave status \G;&quot;awk &#x27;/Slave_SQL_Running/&#123;print $2&#125;&#x27;)</span><br><span class="line">                printf &quot;The new master is: \n Slave_IO_Running=$&#123;SlaveIOStatus&#125;\n&quot;</span><br><span class="line">                printf &quot;Slave_SQL_Running=$&#123;SlaveSQLStatus&#125;\n&quot;</span><br><span class="line">       else</span><br><span class="line">          echo &quot;node change failed please change again ! &quot;</span><br><span class="line">          exit 1</span><br><span class="line">       fi</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><nav class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a></nav></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Jarod</p><div class="site-description" itemprop="description">记录生活中的点点滴滴</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">258</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">306</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/jarodvip" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jarodvip" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Jarod</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">647k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">9:48</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script></body></html>