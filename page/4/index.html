<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"jarod.vip","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script><meta name="description" content="记录生活中的点点滴滴"><meta property="og:type" content="website"><meta property="og:title" content="Jarod&#39;s Blog"><meta property="og:url" content="https://jarod.vip/page/4/index.html"><meta property="og:site_name" content="Jarod&#39;s Blog"><meta property="og:description" content="记录生活中的点点滴滴"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="Jarod"><meta property="article:tag" content="VPS,hexo,linux,debian,windows,macos,生活,工作"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://jarod.vip/page/4/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/4/index.html","title":""}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Jarod's Blog</title><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script><script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Jarod's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Jarod's Blog</h1><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-overview-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Jarod</p><div class="site-description" itemprop="description">记录生活中的点点滴滴</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">299</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">345</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/jarodvip" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jarodvip" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></span></div></div></div></div></aside></div><div class="main-inner index posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2024/06/26/%E8%80%97%E5%AD%90%E9%9D%A2%E6%9D%BF%EF%BC%9A%E4%BD%BF%E7%94%A8-golang-vue-%E5%BC%80%E5%8F%91%E7%9A%84%E5%BC%80%E6%BA%90%E8%BD%BB%E9%87%8F-linux-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2024/06/26/%E8%80%97%E5%AD%90%E9%9D%A2%E6%9D%BF%EF%BC%9A%E4%BD%BF%E7%94%A8-golang-vue-%E5%BC%80%E5%8F%91%E7%9A%84%E5%BC%80%E6%BA%90%E8%BD%BB%E9%87%8F-linux-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/" class="post-title-link" itemprop="url">耗子面板：使用 Golang + Vue 开发的开源轻量 Linux 服务器运维管理面板</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2024-06-26 12:03:13" itemprop="dateCreated datePublished" datetime="2024-06-26T12:03:13+08:00">2024-06-26</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/VPS/" itemprop="url" rel="index"><span itemprop="name">VPS</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>656</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p><strong>耗子面板优势</strong> 极低占用: 在 Debian 12 下部署面板 + LNMP 环境，内存占用不到 500 MB，遥遥领先于使用容器化的其他面板。 低破坏性: 面板的设计理念是尽可能减少对系统的额外修改，在同类面板中，我们对系统的修改最少。 追随时代: 面板所有组件均走在时代前沿，更新快，功能强大，安全性有保障。 高效运维: 面板 UI 界面简洁，操作简单，无需繁琐的配置，即可快速部署各类环境、调整应用设置。 离线运行: 面板运行可不依赖任何外部服务，你甚至可以在部署完成后停止面板进程，不会对已部署服务造成任何影响。 久经考验: 我们生产环境自 2022 年即开始使用，已稳定运行 1 年以上无事故。 开源开放: 面板开源，你可以自由修改、审计面板源码，安全性有保障。 <img src="https://www.jarods.org/wp-content/uploads/2024/06/TheTNB.png"> Root下安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HAOZI_DL_URL=&quot;https://dl.cdn.haozi.net/panel&quot;; curl -sSL -O $&#123;HAOZI_DL_URL&#125;/install_panel.sh &amp;&amp; curl -sSL -O $&#123;HAOZI_DL_URL&#125;/install_panel.sh.checksum.txt &amp;&amp; sha256sum -c install_panel.sh.checksum.txt &amp;&amp; bash install_panel.sh  echo &quot;Checksum 验证失败，文件可能被篡改，已终止操作&quot;</span><br></pre></td></tr></table></figure><p>已开源：<a target="_blank" rel="noopener" href="https://github.com/TheTNB/panel">https://github.com/TheTNB/panel</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2024/01/05/screenshot-to-code/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2024/01/05/screenshot-to-code/" class="post-title-link" itemprop="url">screenshot-to-code</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2024-01-05 09:54:06" itemprop="dateCreated datePublished" datetime="2024-01-05T09:54:06+08:00">2024-01-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>771</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>项目地址， <a target="_blank" rel="noopener" href="https://github.com/abi/screenshot-to-code">https://github.com/abi/screenshot-to-code</a> 如果你没有安装过Python或者Yarn，那就用下面两条命令来安装Python，Node或者Yarn</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">brew install python</span><br><span class="line">brew install node</span><br><span class="line">brew install yarn</span><br><span class="line">brew install git</span><br></pre></td></tr></table></figure><p>并且通过一下两个命令来确认，安装是否成功</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">node --version</span><br><span class="line">npm --version</span><br><span class="line">python --version</span><br><span class="line">yarn --version</span><br><span class="line"></span><br><span class="line"><span class="title class_">Node</span>: v18<span class="number">.12</span><span class="number">.1</span></span><br><span class="line"><span class="attr">npm</span>: <span class="number">8.19</span><span class="number">.2</span></span><br><span class="line"><span class="title class_">Python</span>: <span class="number">3.11</span><span class="number">.5</span></span><br><span class="line"><span class="title class_">Yarn</span>: <span class="number">1.22</span><span class="number">.19</span></span><br></pre></td></tr></table></figure><p>这个软件对版本要求并不高，所以最新版的就行，我用的版本如下，你可以对照一下 然后Clone这个软件包</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">git clone &lt;<span class="attr">https</span>:<span class="comment">//github.com/abi/screenshot-to-code&gt;</span></span><br><span class="line"># 进入软件目录</span><br><span class="line">cd screenshot-to-code</span><br><span class="line"># 进入后台目录</span><br><span class="line">cd backend</span><br><span class="line"># <span class="title class_">GPT4</span> 的<span class="variable constant_">API</span> key</span><br><span class="line">echo <span class="string">&quot;OPENAI_API_KEY=sk-your-key&quot;</span> &gt; .<span class="property">env</span></span><br><span class="line"># 安装<span class="title class_">Poetry</span> 依赖包管理器</span><br><span class="line">pip install poetry</span><br><span class="line"># 安装依赖包</span><br><span class="line">poetry install</span><br><span class="line"># 激活命令行</span><br><span class="line">poetry shell</span><br><span class="line"># 运行程序</span><br><span class="line">poetry run uvicorn <span class="attr">main</span>:app --reload --port <span class="number">7000</span></span><br></pre></td></tr></table></figure><p>后台运行好之后，再打开另外一个命令行 来运行前段程序</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 同样的进入软件目录</span><br><span class="line">cd screenshot-to-code</span><br><span class="line"># 进入前台目录</span><br><span class="line">cd frontend</span><br><span class="line"># 安装前台依赖包</span><br><span class="line">yarn</span><br><span class="line">yarn dev</span><br></pre></td></tr></table></figure><p>打开浏览器地址，就可以使用了 <a target="_blank" rel="noopener" href="http://localhost:5173/">http://localhost:5173/</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2023/07/30/lark%EF%BC%9A%E5%85%8D%E8%B4%B9%E6%8F%90%E4%BE%9B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E9%82%AE%E7%AE%B1/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2023/07/30/lark%EF%BC%9A%E5%85%8D%E8%B4%B9%E6%8F%90%E4%BE%9B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E9%82%AE%E7%AE%B1/" class="post-title-link" itemprop="url">Lark：免费提供自定义域名邮箱</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-07-30 23:15:39" itemprop="dateCreated datePublished" datetime="2023-07-30T23:15:39+08:00">2023-07-30</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>207</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Lark是一个由字节跳动开发的企业协作与管理平台，其中免费提供自定义域名邮箱。 官网注册：<a target="_blank" rel="noopener" href="https://www.larksuite.com/">https://www.larksuite.com/</a>（需全局代理，或 国外win机上注册） 1、创建企业（信息随意） 2、进入控制中心：<a target="_blank" rel="noopener" href="https://www.larksuite.com/admin">https://www.larksuite.com/admin</a> 3、配置自定义域名邮箱：邮箱 – 服务管理 – 域名管理 – 独立的邮件收发服务 4、邮箱使用：<a target="_blank" rel="noopener" href="https://larksuite.com/mail">https://larksuite.com/mail</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2023/07/30/port-forward%EF%BC%9A%E4%B8%80%E6%AC%BE%E5%85%8D%E8%B4%B9%E7%9A%84%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E5%B7%A5%E5%85%B7%EF%BC%8Cweb%E7%AE%A1%E7%90%86%EF%BC%8C%E6%94%AF%E6%8C%81linux%E5%92%8Cwindows/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2023/07/30/port-forward%EF%BC%9A%E4%B8%80%E6%AC%BE%E5%85%8D%E8%B4%B9%E7%9A%84%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E5%B7%A5%E5%85%B7%EF%BC%8Cweb%E7%AE%A1%E7%90%86%EF%BC%8C%E6%94%AF%E6%8C%81linux%E5%92%8Cwindows/" class="post-title-link" itemprop="url">port-forward：一款免费的端口转发工具，web管理，支持Linux和windows</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-07-30 23:14:31" itemprop="dateCreated datePublished" datetime="2023-07-30T23:14:31+08:00">2023-07-30</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Win/" itemprop="url" rel="index"><span itemprop="name">Win</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>716</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p><strong>1、port-forward功能介绍</strong> 支持Web控制台添加端口映射 支持对每条端口映射进行开启和关闭控制 支持 RestfulAPI 接口，方便被其它系统集成 支持每条端口转发的同时，再分发给多个端口，满足某些测试场景 类似企业交换机的功能，即软交换机，主要是方便企业网络维护人员或开发人员 <em>forward-server.linux64（端口转发服务-linux版本） forward-agent.linux64（内网穿透代理-linux版本）</em> <em>forward-server.win64（端口转发服务-windows版本） forward-agent.win64（内网穿透代理-windows版本）</em> <strong>2、port-forward安装（Linux）</strong> 下载</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y install unzip</span><br><span class="line">wget https://gitee.com/tavenli/port-forward/releases/download/v1.3.7/forward-server.linux64.v1.3.7.zip</span><br><span class="line">unzip forward-server.linux64.v1.3.7</span><br></pre></td></tr></table></figure><p>启用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 start.sh</span><br><span class="line">./start.sh</span><br></pre></td></tr></table></figure><p>已开源：<a target="_blank" rel="noopener" href="https://gitee.com/tavenli/port-forward">https://gitee.com/tavenli/port-forward</a> <strong>3、port-forwardv1.3.7版本地备份</strong>： <a target="_blank" rel="noopener" href="https://zhujiwiki.com/wp-content/uploads/2023/07/forward-server.linux64.v1.3.7.zip">forward-server.linux64</a>（端口转发服务-linux版本） <a target="_blank" rel="noopener" href="https://zhujiwiki.com/wp-content/uploads/2023/07/forward-agent.linux64.v1.3.7.zip">forward-agent.linux64</a>（内网穿透代理-linux版本） <a target="_blank" rel="noopener" href="https://zhujiwiki.com/wp-content/uploads/2023/07forward-server.win64.v1.3.7.zip">forward-server.win64</a>（端口转发服务-windows版本） <a target="_blank" rel="noopener" href="https://zhujiwiki.com/wp-content/uploads/2023/07/forward-agent.win64.v1.3.7.zip">forward-agent.win64</a>（内网穿透代理-windows版本） <img src="https://www.jarods.org/wp-content/uploads/2023/07/port-forward.jpg"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2023/07/02/debian9%E5%8D%87%E7%BA%A7%E8%87%B310-11%E7%89%88%E6%9C%AC%EF%BC%88%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%A8%A1%E5%BC%8F-%E6%89%8B%E5%8A%A8%E5%8D%87%E7%BA%A7%EF%BC%89/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2023/07/02/debian9%E5%8D%87%E7%BA%A7%E8%87%B310-11%E7%89%88%E6%9C%AC%EF%BC%88%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%A8%A1%E5%BC%8F-%E6%89%8B%E5%8A%A8%E5%8D%87%E7%BA%A7%EF%BC%89/" class="post-title-link" itemprop="url">Debian9升级至10/11/12版本（命令行模式/手动升级）</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-07-02 00:27:08" itemprop="dateCreated datePublished" datetime="2023-07-02T00:27:08+08:00">2023-07-02</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>1.2k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>1 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h5 id="升级说明"><a href="#升级说明" class="headerlink" title="升级说明"></a>升级说明</h5><p>手动升级版本逐步版本升级，如9-10-11 <img src="https://www.jarods.org/wp-content/uploads/2023/07/6_2RNVGAZ2EQG597R.jpg"></p><h5 id="Debian9至10"><a href="#Debian9至10" class="headerlink" title="Debian9至10"></a>Debian9至10</h5><p>备份sources文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/apt/sources.list /etc/apt/sources.list.bk</span><br></pre></td></tr></table></figure><p>修改apt源为10，请提前备份原文件，strech 为 debian9 代号, 将其替换为 buster 为 debian10 代号；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">sed -i &#x27;s/stretch/buster/g&#x27; /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>更新apt索引#</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br></pre></td></tr></table></figure><p>升级到debian10#</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt upgrade</span><br><span class="line">apt dist-upgrade</span><br></pre></td></tr></table></figure><h5 id="Debian10升级至11"><a href="#Debian10升级至11" class="headerlink" title="Debian10升级至11"></a>Debian10升级至11</h5><p>Debian11 已经在2021年8月15日正式发布，内核升级为了5.10，这里记录了如何在命令行模式下将Debian10 升级为Debian11. 1.先将Debian10现有的补丁都打全</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update -y &amp;&amp; apt upgrade -y</span><br><span class="line">apt dist-upgrade</span><br></pre></td></tr></table></figure><p>2. 修改 &#x2F;etc&#x2F;apt&#x2F;sources.list 文档，将源buster 替换为bullseye。（注意备份sources.list）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">sed -i &#x27;s/buster/bullseye/g&#x27; /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>3.重新update和full-upgrade,遇到对话框，yes&#x2F;ok即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt full-upgrade</span><br></pre></td></tr></table></figure><h5 id="Debian11升级至12"><a href="#Debian11升级至12" class="headerlink" title="Debian11升级至12"></a>Debian11升级至12</h5><p>Debian11 已经在2023年6月10日正式发布，内核升级为了6.10，这里记录了如何在命令行模式下将Debian11 升级为Debian12. 1.先将Debian11现有的补丁都打全</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update -y &amp;&amp; apt upgrade -y</span><br><span class="line">apt dist-upgrade</span><br></pre></td></tr></table></figure><p>2. 修改 &#x2F;etc&#x2F;apt&#x2F;sources.list 文档，将源bullseye 替换为bookworm。（注意备份sources.list）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">sed -i &#x27;s/bullseye/bookworm/g&#x27; /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>3.重新update和full-upgrade,遇到对话框，yes&#x2F;ok即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt full-upgrade</span><br></pre></td></tr></table></figure><p>4. reboot，检查系统版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/os-release</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/10/26/windows-10-%E4%B8%93%E4%B8%9A%E7%89%88%E5%BF%85%E9%A1%BB%E7%A6%81%E7%94%A8%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%9C%89%E5%93%AA%E4%BA%9B/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/10/26/windows-10-%E4%B8%93%E4%B8%9A%E7%89%88%E5%BF%85%E9%A1%BB%E7%A6%81%E7%94%A8%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%9C%89%E5%93%AA%E4%BA%9B/" class="post-title-link" itemprop="url">WinDows 10 专业版必须禁用的服务有哪些</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-10-26 20:26:21" itemprop="dateCreated datePublished" datetime="2022-10-26T20:26:21+08:00">2022-10-26</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Win/" itemprop="url" rel="index"><span itemprop="name">Win</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>2.7k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>2 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Win10专业版系统中自带服务有很多，一个服务对应一个功能，但是很多服务其实普通用户是用不到的，如果你的电脑配置没那么高，运行时常会卡顿，那么建议你关掉没有必要的服务来提升运行速度，那么Win10专业版必须禁用的服务有哪些？ **        Win10专业版必须禁用的服务表** Application Layer Gateway Service《Win10Application Layer Gateway Service服务有什么用》 Diagnostic System Host 同上 Distributed Link Tracking Client 参考《Distributed Link Tracking Client是什么服务》 Microsoft App-V Client （App-V是微软应用程序虚拟化技术客户端，一般用不上，禁用） Microsoft iSCSI Initiator Service （iscsi远程连接服务，禁用吧） Microsoft Software Shadow Copy Provider （卷影服务，貌似和备份还原有点像，但是用不到） Net.Tcp Port Sharing Service （TCP端口共享服务，一般用户用不上） ASP.NET State Service《Win10 ASP.NET State Service服务是什么》 Connected User Experiences and Telemetry 关于是什么服务为什么可以禁用参考：《Win10 Connected User Experiences and Telemetry服务可以禁用吗》 Diagnostic Policy Service 《Diagnostic Policy Service服务是什么》 <a target="_blank" rel="noopener" href="http://www.winwin7.com/">www.winwin7.com</a> Win7系统之家 Diagnostic Service Host 基本和Diagnostic Policy Service&#x2F;Diagnostic Service Host是同类，可以一起禁用 Downloaded Maps Manager （供应用程序访问已下载地图的 Windows 服务。此服务由访问已下载地图的应用程序按需启动。禁用此服务将阻止应用访问地图。） Function Discovery Provider Host （当电脑加入域后，共享文件需要的一个服务，非域则禁用） HomeGroup Listener （家庭组相关服务，不使用家庭组就禁用） HomeGroup Provider （家庭组相关服务，不使用家庭组就禁用） <a target="_blank" rel="noopener" href="http://www.winwin7.com/">www.winwin7.com</a> Win7系统之家 Human Interface Device Service （简单的支持一些多媒体功能的键盘，蓝牙耳机上的控制按钮，没啥用） Internet Connection Sharing （ICS） （无线共享相关服务，如不需要无线共享，AP热点等可关闭否则不要关） IP Helper （IP V6协议版本相关服务，目关来说应用不多，可以关闭） IPsec Policy Agent （防火墙相关，是用来协商和配置IPSEC安全策略的，一般用户都用不上，可以禁止掉） Link-Layer Topology Discovery Mapper （网络映射相关，不使用可禁用） Offline Files （Offline Files是什么服务 脱机服务，一般用不上） Performance Logs &amp; Alerts （搜集计算机性能、日志、报警信息的服务项） Portable Device Enumerator Service （Portable Device Enumerator Service服务有什么用） Program Compatibility Assistant Service （Windows兼容性助理，处理程序兼容性（主要是老旧软件），不需要可关闭） Quality Windows Audio Video Experience 《Quality Windows Audio Video Experience是什么服务》 Remote Desktop Configuration （远程桌面相关服务，不使用可关） Routing and Remote Access （软路由服务，可禁用） Secondary Logon （二次登录服务，建议关闭） Remote Registry 《Remote Registry是什么服务》这个是远程注册表服务，建议禁用。 Security Center （Windows安全中心服务，不需要的话就禁用吧，详细介绍（Win10 Security Center是什么服务可以禁用吗）） Server （局域网共享相关服务，不使用局域网可以禁用 ） Remote Desktop Services （远程桌面相关服务，不使用可关） Remote Desktop Services UserMode Port Redirector （远程桌面相关服务，不使用可关） Shared PC Account Manager （共享PC帐户管理器，可以禁用） Shell Hardware Detection （提供自动播放事件通知，禁用） Smart Card （智能卡服务，禁用） Smart Card Device Enumeration Service （同上，还是服务于智能卡，禁用） Smart Card Removal Policy （智能卡相关服务） SSDP Discovery （发现网络上的UPnP设备，网络发现相关服务，不使用局域网可禁用） Superfetch （superfetch是什么服务 超级预读取服务 禁用无影响） SynTPEnh Caller Service （同步电话呼叫服务 禁用） TCP&#x2F;IP NetBIOS Helper （局域网共享相关服务，不用可禁用） Telephony （电话应用程序编程接口 （TAPI） 提供支持 ，拨号用户不要关，其它就禁用） User Experience Virtualization Service （用户体验虚拟化服务，不需要禁用） Windows Biometric Service （生物识别服务，不使用指纹、不使用人脸识别可以禁用） Windows Search （Windows搜索服务，为文件建立索引加快搜索速度） Windows Update （自动更新服务，不想自动更新的可以禁用） Windows 备份 （备份相关服务，一般也不会去用） Windows 推送通知系统服务 （建议关闭，会狂占内存、CPU） WinHTTP Web Proxy Auto-Discovery Service （默认手动，可禁用） Workstation （局域网共享相关，不需要可禁用） Xbox Live 身份验证管理器 （禁用） Xbox Live 游戏保存 （禁用） XboxNetApiSvc （禁用） 零售演示服务 （演示禁用） 自动时区更新程序 （时间同步，不需要可禁用）</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/10/12/%E4%BC%81%E4%B8%9A%E5%86%85%E7%BD%91dns%E6%90%AD%E5%BB%BA%EF%BC%8Csmartdns%EF%BC%8C%E7%BD%91%E7%AB%99%E8%AE%BF%E9%97%AE%E5%8A%A0%E9%80%9F%EF%BC%8C%E8%A7%A3%E5%86%B3dns%E6%B1%A1%E6%9F%93%E7%AD%89/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/10/12/%E4%BC%81%E4%B8%9A%E5%86%85%E7%BD%91dns%E6%90%AD%E5%BB%BA%EF%BC%8Csmartdns%EF%BC%8C%E7%BD%91%E7%AB%99%E8%AE%BF%E9%97%AE%E5%8A%A0%E9%80%9F%EF%BC%8C%E8%A7%A3%E5%86%B3dns%E6%B1%A1%E6%9F%93%E7%AD%89/" class="post-title-link" itemprop="url">企业内网DNS搭建，SmartDNS，网站访问加速，解决dns污染等问题</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-10-12 00:34:32" itemprop="dateCreated datePublished" datetime="2022-10-12T00:34:32+08:00">2022-10-12</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>9.1k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>8 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>smart安装链接 [<a target="_blank" rel="noopener" href="https://github.com/pymumu/smartdns/releases/](https://github.com/pymumu/smartdns/releases)">https://github.com/pymumu/smartdns/releases\](https://github.com/pymumu/smartdns/releases)</a>  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/pymumu/smartdns/releases/download/all-best-ip/smartdns.1.2022.05.03-1046.x86_64-linux-all.tar.gz</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# ls</span><br><span class="line">anaconda-ks.cfg  initial-setup-ks.cfg  smartdns.1.2022.05.03-1046.x86_64-linux-all.tar.gz</span><br><span class="line">[root@localhost ~]# </span><br><span class="line"></span><br><span class="line">tar zxf  smartdns.1.2022.05.03-1046.x86_64-linux-all.tar.gz</span><br><span class="line">[root@localhost ~]# tar zxf  smartdns.1.2022.05.03-1046.x86_64-linux-all.tar.gz</span><br><span class="line">[root@localhost ~]# cd smartdns</span><br><span class="line">[root@localhost smartdns]# chmod +x ./install</span><br><span class="line">[root@localhost smartdns]# ./install -i</span><br><span class="line">install: 正在创建目录&quot;/etc/smartdns&quot;</span><br><span class="line">&quot;usr/sbin/smartdns&quot; -&gt; &quot;/usr/sbin/smartdns&quot;</span><br><span class="line">&quot;etc/smartdns/smartdns.conf&quot; -&gt; &quot;/etc/smartdns/smartdns.conf&quot;</span><br><span class="line">&quot;etc/default/smartdns&quot; -&gt; &quot;/etc/default/smartdns&quot;</span><br><span class="line">&quot;etc/init.d/smartdns&quot; -&gt; &quot;/etc/init.d/smartdns&quot;</span><br><span class="line">&quot;systemd/smartdns.service&quot; -&gt; &quot;/usr/lib/systemd/system/smartdns.service&quot;</span><br><span class="line">Created symlink from /etc/systemd/system/smartdns.service to /usr/lib/systemd/system/smartdns.service.</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/smartdns.service to /usr/lib/systemd/system/smartdns.service.</span><br><span class="line">[root@localhost smartdns]# </span><br><span class="line"></span><br><span class="line">vi /etc/smartdns/smartdns.conf</span><br><span class="line"></span><br><span class="line">systemctl enable smartdns</span><br><span class="line">systemctl start smartdns</span><br></pre></td></tr></table></figure><p>飞书收集</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#飞书</span><br><span class="line">.feishu.cn</span><br><span class="line">.q9jvw0u5f5.feishu.cn</span><br><span class="line">.ccm-frontier.feishu.cn</span><br><span class="line">.internal-api.feishu.cn</span><br><span class="line">.hryn145hsh.feishu.cn</span><br><span class="line">.internal-api-drive-stream.feishu.cn</span><br><span class="line">.internal-api-lark-api.feishu.cn</span><br><span class="line">.slardar-bd.feishu.cn</span><br><span class="line">.ccm-frontier-hl.feishu.cn</span><br><span class="line">.mcs-bd.feishu.cn</span><br><span class="line">.feishucdn.com</span><br><span class="line">.sf3-scmcdn2-cn.feishucdn.com</span><br><span class="line">.s1-imfile.feishucdn.com </span><br><span class="line">.sf6-scmcdn-cn.feishucdn.com</span><br><span class="line">.ai.feishu.com</span><br><span class="line">.lf9-img-sign.bytehwm.com</span><br><span class="line">.lf3-short.ibytedapm.com</span><br><span class="line">.mon.zijieapi.com</span><br><span class="line">#百度</span><br><span class="line">.baidu.com </span><br><span class="line">#京东</span><br><span class="line">.jd.com</span><br><span class="line">#阿里</span><br><span class="line">#淘宝</span><br><span class="line">.taobao.com</span><br><span class="line">#wechat</span><br><span class="line">.weixin.qq.com</span><br><span class="line">.qq.com</span><br><span class="line">.wechat.com</span><br><span class="line">.wx.qq.com</span><br><span class="line">#csdn</span><br><span class="line">.csdn.net </span><br></pre></td></tr></table></figure><p>配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/smartdns/smartdns.conf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># dns server name, default is host name</span><br><span class="line"># server-name,</span><br><span class="line"># example:</span><br><span class="line">server-name smartdns1</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># Include another configuration options</span><br><span class="line"># conf-file [file]</span><br><span class="line"># conf-file blacklist-ip.conf</span><br><span class="line"></span><br><span class="line"># dns server bind ip and port, default dns server port is 53, support binding multi ip and port</span><br><span class="line"># bind udp server</span><br><span class="line">#   bind [IP]:[port] [-group [group]] [-no-rule-addr] [-no-rule-nameserver] [-no-rule-ipset] [-no-speed-check] [-no-cache] [-no-rule-soa] [-no-dualstack-selection]</span><br><span class="line"># bind tcp server</span><br><span class="line"># option:</span><br><span class="line">#   -group: set domain request to use the appropriate server group.</span><br><span class="line">#   -no-rule-addr: skip address rule.</span><br><span class="line">#   -no-rule-nameserver: skip nameserver rule.</span><br><span class="line">#   -no-rule-ipset: skip ipset rule.</span><br><span class="line">#   -no-speed-check: do not check speed.</span><br><span class="line">#   -no-cache: skip cache.</span><br><span class="line">#   -no-rule-soa: Skip address SOA(#) rules.</span><br><span class="line">#   -no-dualstack-selection: Disable dualstack ip selection.</span><br><span class="line">#   -force-aaaa-soa: force AAAA query return SOA.</span><br><span class="line"># example:</span><br><span class="line">#  IPV4:</span><br><span class="line">#    bind :53</span><br><span class="line">#    bind :6053 -group office -no-speed-check</span><br><span class="line">#  IPV6:</span><br><span class="line">#    bind [::]:53</span><br><span class="line">#    bind-tcp [::]:53</span><br><span class="line">bind [::]:53</span><br><span class="line"></span><br><span class="line"># tcp connection idle timeout</span><br><span class="line"># tcp-idle-time [second]</span><br><span class="line"></span><br><span class="line"># dns cache size</span><br><span class="line"># cache-size [number]</span><br><span class="line">#   0: for no cache</span><br><span class="line">cache-size 4096</span><br><span class="line"></span><br><span class="line"># enable persist cache when restart</span><br><span class="line"># cache-persist yes</span><br><span class="line"></span><br><span class="line"># cache persist file</span><br><span class="line"># cache-file /tmp/smartdns.cache</span><br><span class="line"></span><br><span class="line"># prefetch domain</span><br><span class="line"># prefetch-domain [yesno]</span><br><span class="line">#启用域名预获取</span><br><span class="line">prefetch-domain yes</span><br><span class="line"></span><br><span class="line"># cache serve expired</span><br><span class="line"># serve-expired [yesno]</span><br><span class="line">#启用过期缓存服务</span><br><span class="line">serve-expired yes</span><br><span class="line"></span><br><span class="line"># cache serve expired TTL</span><br><span class="line"># serve-expired-ttl [num]</span><br><span class="line">#</span><br><span class="line">serve-expired-ttl 0</span><br><span class="line"></span><br><span class="line"># reply TTL value to use when replying with expired data</span><br><span class="line"># serve-expired-reply-ttl [num]</span><br><span class="line"># serve-expired-reply-ttl 30</span><br><span class="line"></span><br><span class="line"># List of hosts that supply bogus NX domain results</span><br><span class="line"># bogus-nxdomain [ip/subnet]</span><br><span class="line"></span><br><span class="line"># List of IPs that will be filtered when nameserver is configured -blacklist-ip parameter</span><br><span class="line"># blacklist-ip [ip/subnet]</span><br><span class="line"></span><br><span class="line"># List of IPs that will be accepted when nameserver is configured -whitelist-ip parameter</span><br><span class="line"># whitelist-ip [ip/subnet]</span><br><span class="line"></span><br><span class="line"># List of IPs that will be ignored</span><br><span class="line"># ignore-ip [ip/subnet]</span><br><span class="line"></span><br><span class="line"># speed check mode</span><br><span class="line"># speed-check-mode [pingtcp:portnone,]</span><br><span class="line"># example:</span><br><span class="line">#测速模式选择，一般只检测两种协议</span><br><span class="line">#   speed-check-mode ping,tcp:80</span><br><span class="line">   speed-check-mode tcp:443,ping</span><br><span class="line">#   speed-check-mode none</span><br><span class="line"></span><br><span class="line"># force AAAA query return SOA</span><br><span class="line"># force-AAAA-SOA [yesno]</span><br><span class="line">#禁用IPV6解析</span><br><span class="line">force-AAAA-SOA yes</span><br><span class="line"></span><br><span class="line"># force specific qtype return soa</span><br><span class="line"># force-qtype-SOA [qtypeid ...]</span><br><span class="line"># force-qtype-SOA 65 28</span><br><span class="line"></span><br><span class="line"># Enable IPV4, IPV6 dual stack IP optimization selection strategy</span><br><span class="line"># dualstack-ip-selection-threshold [num] (0~1000)</span><br><span class="line"># dualstack-ip-selection [yesno]</span><br><span class="line">dualstack-ip-selection no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># edns client subnet</span><br><span class="line"># edns-client-subnet [ip/subnet]</span><br><span class="line"># edns-client-subnet 192.168.1.1/24</span><br><span class="line"># edns-client-subnet [8::8]/56</span><br><span class="line"></span><br><span class="line"># ttl for all resource record</span><br><span class="line"># rr-ttl: ttl for all record</span><br><span class="line"># rr-ttl-min: minimum ttl for resource record</span><br><span class="line"># rr-ttl-max: maximum ttl for resource record</span><br><span class="line"># tr-ttl-reply-max: maximum reply ttl for resource record</span><br><span class="line"># example:</span><br><span class="line">#设置TTL最小值和最大值</span><br><span class="line">#rr-ttl 300</span><br><span class="line">rr-ttl-min 60</span><br><span class="line">rr-ttl-max 86400</span><br><span class="line"># rr-ttl-reply-max 60</span><br><span class="line"></span><br><span class="line"># set log level</span><br><span class="line"># log-level: [level], level=fatal, error, warn, notice, info, debug</span><br><span class="line"># log-file: file path of log file.</span><br><span class="line"># log-size: size of each log file, support k,m,g</span><br><span class="line">log-num: number of logs</span><br><span class="line">log-level info</span><br><span class="line">log-file /var/log/smartdns.log</span><br><span class="line">log-size 128k</span><br><span class="line"># dns audit</span><br><span class="line"># audit-enable [yesno]: enable or disable audit.</span><br><span class="line"># audit-enable yes</span><br><span class="line"># audit-SOA [yesno]: enable or disable log soa result.</span><br><span class="line"># audit-size size of each audit file, support k,m,g</span><br><span class="line"># audit-file /var/log/smartdns-audit.log</span><br><span class="line"># audit-size 128k</span><br><span class="line"># audit-num 2</span><br><span class="line"></span><br><span class="line"># certificate file</span><br><span class="line"># ca-file [file]</span><br><span class="line"># ca-file /etc/ssl/certs/ca-certificates.crt</span><br><span class="line"></span><br><span class="line"># certificate path</span><br><span class="line"># ca-path [path]</span><br><span class="line"># ca-path /etc/ss/certs</span><br><span class="line"></span><br><span class="line"># remote udp dns server list</span><br><span class="line"># server [IP]:[PORT] [-blacklist-ip] [-whitelist-ip] [-check-edns] [-group [group] ...] [-exclude-default-group]</span><br><span class="line"># default port is 53</span><br><span class="line">#   -blacklist-ip: filter result with blacklist ip</span><br><span class="line">#   -whitelist-ip: filter result whth whitelist ip,  result in whitelist-ip will be accepted.</span><br><span class="line">#   -check-edns: result must exist edns RR, or discard result.</span><br><span class="line">#   -group [group]: set server to group, use with nameserver /domain/group.</span><br><span class="line">#   -exclude-default-group: exclude this server from default group.</span><br><span class="line"># server 8.8.8.8 -blacklist-ip -check-edns -group g1 -group g2</span><br><span class="line"></span><br><span class="line">#飞书</span><br><span class="line">server 114.114.114.114 -group feishu -exclude-default-group</span><br><span class="line">nameserver /.feishu.cn/feishu</span><br><span class="line">nameserver /.feishucdn.com/feishu</span><br><span class="line">nameserver /.feishu.com/feishu</span><br><span class="line">nameserver /.bytehwm.com/feishu</span><br><span class="line">nameserver /.ibytedapm.com/feishu</span><br><span class="line">nameserver /.zijieapi.com/feishu</span><br><span class="line">nameserver /.feelgood.cn/feishu</span><br><span class="line"># 百度</span><br><span class="line">server 114.114.114.114 -group baidu -exclude-default-group</span><br><span class="line">nameserver /.baidu.com/baidu</span><br><span class="line">#京东</span><br><span class="line">server 114.114.114.114 -group jd -exclude-default-group</span><br><span class="line">nameserver /.jd.com/jd</span><br><span class="line">#淘宝天猫</span><br><span class="line">server 114.114.114.114 -group taobao -exclude-default-group</span><br><span class="line">nameserver /.taobao.com/taobao</span><br><span class="line">nameserver /.tmall.com/taobao</span><br><span class="line">#阿里</span><br><span class="line">server 114.114.114.114 -group ali -exclude-default-group</span><br><span class="line">nameserver /.aliyun.com/ali</span><br><span class="line">#csdn</span><br><span class="line">server 114.114.114.114 -group csdn -exclude-default-group</span><br><span class="line">nameserver /.csdn.net/csdn</span><br><span class="line">#华为</span><br><span class="line">server 114.114.114.114 -group huawei -exclude-default-group</span><br><span class="line">nameserver /.huaweicloud.com/huawei</span><br><span class="line">#todesk</span><br><span class="line">server 114.114.114.114 -group todesk  -exclude-default-group</span><br><span class="line">nameserver /.todesk.com/todesk</span><br><span class="line">#QQ</span><br><span class="line">server 114.114.114.114 -group qq -exclude-default-group</span><br><span class="line">nameserver /.qq.com/qq</span><br><span class="line"></span><br><span class="line"># remote tcp dns server list</span><br><span class="line"># server-tcp [IP]:[PORT] [-blacklist-ip] [-whitelist-ip] [-group [group] ...] [-exclude-default-group]</span><br><span class="line"># default port is 53</span><br><span class="line"># server-tcp 8.8.8.8</span><br><span class="line">server 8.8.8.8</span><br><span class="line">server 8.8.4.4</span><br><span class="line">##server 120.53.129.197</span><br><span class="line">##server 124.70.4.50</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># remote tls dns server list</span><br><span class="line"># server-tls [IP]:[PORT] [-blacklist-ip] [-whitelist-ip] [-spki-pin [sha256-pin]] [-group [group] ...] [-exclude-default-group]</span><br><span class="line">#   -spki-pin: TLS spki pin to verify.</span><br><span class="line">#   -tls-host-verify: cert hostname to verify.</span><br><span class="line">#   -host-name: TLS sni hostname.</span><br><span class="line">#   -no-check-certificate: no check certificate.</span><br><span class="line"># Get SPKI with this command:</span><br><span class="line"># default port is 853</span><br><span class="line">server-tls 8.8.8.8</span><br><span class="line">server-tls 1.0.0.1</span><br><span class="line"></span><br><span class="line"># remote https dns server list</span><br><span class="line"># server-https https://[host]:[port]/path [-blacklist-ip] [-whitelist-ip] [-spki-pin [sha256-pin]] [-group [group] ...] [-exclude-default-group]</span><br><span class="line">#   -spki-pin: TLS spki pin to verify.</span><br><span class="line">#   -tls-host-verify: cert hostname to verify.</span><br><span class="line">#   -host-name: TLS sni hostname.</span><br><span class="line">#   -http-host: http host.</span><br><span class="line">#   -no-check-certificate: no check certificate.</span><br><span class="line"># default port is 443</span><br><span class="line">server-https https://cloudflare-dns.com/dns-query</span><br><span class="line"></span><br><span class="line"># specific nameserver to domain</span><br><span class="line"># nameserver /domain/[group-]</span><br><span class="line"># nameserver /www.example.com/office, Set the domain name to use the appropriate server group.</span><br><span class="line"># nameserver /www.example.com/-, ignore this domain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># specific address to domain</span><br><span class="line"># address /domain/[ip--4-6##4#6]</span><br><span class="line"># address /www.example.com/1.2.3.4, return ip 1.2.3.4 to client</span><br><span class="line"># address /www.example.com/-, ignore address, query from upstream, suffix 4, for ipv4, 6 for ipv6, none for all</span><br><span class="line"># address /www.example.com/#, return SOA to client, suffix 4, for ipv4, 6 for ipv6, none for all</span><br><span class="line"></span><br><span class="line"># enable ipset timeout by ttl feature</span><br><span class="line"># ipset-timeout [yes]</span><br><span class="line"></span><br><span class="line"># specific ipset to domain</span><br><span class="line"># ipset /domain/[ipset-]</span><br><span class="line"># ipset /www.example.com/block, set ipset with ipset name of block</span><br><span class="line"># ipset /www.example.com/-, ignore this domain</span><br><span class="line"></span><br><span class="line"># set domain rules</span><br><span class="line"># domain-rules /domain/ [-speed-check-mode [...]]</span><br><span class="line"># rules:</span><br><span class="line">#   [-c] -speed-check-mode [mode]: speed check mode</span><br><span class="line">#                             speed-check-mode [pingtcp:portnone,]</span><br><span class="line">#   [-a] -address [address-]: same as address option</span><br><span class="line">#   [-n] -nameserver [group-]: same as nameserver option</span><br><span class="line">#   [-p] -ipset [ipset-]: same as ipset option</span><br><span class="line">#   [-d] -dualstack-ip-selection [yesno]: same as dualstack-ip-selection option</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/10/05/tinc-p2p%E7%BB%84%E7%BD%91-%E7%BB%84%E5%BB%BA%E5%A4%A7%E5%B1%80%E5%9F%9F%E7%BD%91%E6%95%99%E7%A8%8B/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/10/05/tinc-p2p%E7%BB%84%E7%BD%91-%E7%BB%84%E5%BB%BA%E5%A4%A7%E5%B1%80%E5%9F%9F%E7%BD%91%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">Tinc P2P组网 组建大局域网教程</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-10-05 16:45:50" itemprop="dateCreated datePublished" datetime="2022-10-05T16:45:50+08:00">2022-10-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>5.2k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>5 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="Tinc介绍"><a href="#Tinc介绍" class="headerlink" title="Tinc介绍"></a>Tinc介绍</h2><p>Tinc 是一个组建虚拟专用网络的工具，以 GNU 协议发布，通过隧道及加密技术在互联网上点与点之间创建专有网络。tinc 在网络层工作，因此无需对现有软件进行修改和配置。您可以使用 tinc 搭建专属的低延迟、高带宽、可扩展的 P2P 虚拟局域网。其数据通讯经过加密和压缩，能避免敏感数据和隐私的泄露。</p><h2 id="选择的理由"><a href="#选择的理由" class="headerlink" title="选择的理由"></a>选择的理由</h2><ol><li>开源，截止目前还在不断更新完善；</li><li>分布式网状路由，避免单点高负载和故障；</li><li>可运行多个实例来接入多个VPN；</li><li>通过虚拟网卡通讯，无需对现有应用软件进行修改和配置；</li><li>通讯支持 加密&#x2F;认证&#x2F;压缩，并支持参数选择；</li><li>支持常见的操作系统和网络拓扑，适用场景广泛；</li><li>支持P2P协议组网。</li></ol><h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>本教程为实现Tinc 虚拟网内设备，能打洞成功的设备将实现直连，打洞失败的设备通过中转节点链接。</p><h2 id="搭建教程"><a href="#搭建教程" class="headerlink" title="搭建教程"></a>搭建教程</h2><h3 id="1）主节点"><a href="#1）主节点" class="headerlink" title="1）主节点"></a>1）主节点</h3><p>这里主节点选择的话必须是有公网IP的节点来进行搭建。</p><h4 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h4><p>系统：<code>Ubuntu 20.04</code> 虚拟内网IP:<code>10.100.1.105</code> 公网IP：<code>1.1.1.1</code> 虚拟网名称：<code>hnvps</code> 主节点名称: <code>hnvps</code></p><h4 id="1、安装Tinc"><a href="#1、安装Tinc" class="headerlink" title="1、安装Tinc"></a>1、安装Tinc</h4><p>这里安装有两种方式</p><ul><li>一种是直接使用apt安装</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install tinc</span><br></pre></td></tr></table></figure><ul><li>本教程采用编译安装 这里安装的是最新的测试版本其他版本请到官网下载：<a target="_blank" rel="noopener" href="https://tinc-vpn.org/">https://tinc-vpn.org</a></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装依赖</span></span><br><span class="line">apt install gcc cmake make zlib1g-dev liblzo2-dev openssl</span><br><span class="line">curl https://cdn.nextrt.com/blog/tinc-1.1pre18.tar.gz -o /tmp/tinc.tar.gz</span><br><span class="line">cd /tmp</span><br><span class="line">tar -zxvf tinc.tar.gz</span><br><span class="line">rm -rf tinc.tar.gz</span><br><span class="line">mv tinc-1.1pre18 tinc</span><br><span class="line">cd tinc</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">建立配置文件储存目录</span></span><br><span class="line">mkdir /usr/local/etc/tinc</span><br><span class="line">mkdir -p /usr/local/var/run/</span><br><span class="line">sudo ln -s /usr/local/etc/tinc /etc/tinc</span><br></pre></td></tr></table></figure><h4 id="2、配置TINC"><a href="#2、配置TINC" class="headerlink" title="2、配置TINC"></a>2、配置TINC</h4><h5 id="准备事项"><a href="#准备事项" class="headerlink" title="准备事项"></a>准备事项</h5><p>1、开启内核的 ip_foward 功能，如果没有开启请手动开启转发.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -agrep ip_forward # 查看 ip_forward 转发是否开启 [ net.ipv4.ip_forward=1 ]</span><br></pre></td></tr></table></figure><p>开启方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br></pre></td></tr></table></figure><p>2、启用 tun 设备</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo modprobe tun</span><br></pre></td></tr></table></figure><p>检查确认是否启用成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /dev/net/tun</span><br></pre></td></tr></table></figure><h5 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h5><p>这里假设我们要建立的虚拟网名称为<code>hnvps</code> 以下为配置完成的配置文件目录结构</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/etc/tinc</span><br><span class="line">└── hnvps</span><br><span class="line">    ├── hosts</span><br><span class="line">    │   ├── hnvps</span><br><span class="line">    │   └── openwrt</span><br><span class="line">    ├── rsa_key.priv</span><br><span class="line">    ├── tinc.conf</span><br><span class="line">    ├── tinc-down</span><br><span class="line">    └── tinc-up</span><br></pre></td></tr></table></figure><p>文件说明</p><ul><li>tinc.conf 为 tincnet 的配置文件，</li><li>tinc-up 为启动该网络时自动执行的脚本</li><li>tinc-down 为关闭该网络时自动执行的脚本</li><li>hosts 文件夹保存着各个节点（路由器）的信息。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 建立配置文件储存目录</span><br><span class="line">mkdir /etc/tinc/hnvps</span><br><span class="line">mkdir /etc/tinc/hnvps/hosts</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image-1647766497412.png" alt="image-1647766497412"></p><p>image-1647766497412</p><p>设置配置文件<code>/etc/tinc/hnvps/tinc.conf</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Name = hnvps</span><br><span class="line">Interface = tinc</span><br><span class="line">Autoconnect = yes</span><br><span class="line">Compression=9</span><br><span class="line">Cipher  = aes-256-cbc</span><br><span class="line">Digest = sha256</span><br><span class="line">#绑定的端口</span><br><span class="line">BindToAddress = * 10010</span><br></pre></td></tr></table></figure><p>编写启动虚拟交换器脚本<code>/etc/tinc/hnvps/tinc-up</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">ip link set $INTERFACE up</span><br><span class="line">ip addr add 10.100.1.105/24 dev $INTERFACE</span><br><span class="line">ip route add 10.100.1.0/24 dev $INTERFACE</span><br></pre></td></tr></table></figure><p>编写错误关闭的脚本<code>/etc/tinc/hnvps/tinc-down</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">ip route del 10.100.1.0/24 dev $INTERFACE</span><br><span class="line">ip addr del 10.100.1.105/24 dev $INTERFACE</span><br><span class="line">ip link set $INTERFACE down</span><br></pre></td></tr></table></figure><p>赋予脚本权限：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/tinc/hnvps/tinc-*</span><br></pre></td></tr></table></figure><p>编写主节点的详细信息<code>/etc/tinc/hnvps/hosts/hnvps</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 主节点公网IP地址</span><br><span class="line">Address = 1.1.1.1</span><br><span class="line"># 主节点内网地址</span><br><span class="line">Subnet = 10.100.1.105/32</span><br><span class="line">Port = 10010</span><br></pre></td></tr></table></figure><p>生成密钥信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/tinc/hnvps/hosts</span><br></pre></td></tr></table></figure><p>执行下面命令后需要输入两次回车确认</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tinc -n hnvps generate-rsa-keys</span><br></pre></td></tr></table></figure><p>执行下面命令后需要输入两次回车确认</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tinc -n hnvps generate-ed25519-keys</span><br></pre></td></tr></table></figure><p>放行防火墙</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ufw allow 10010</span><br></pre></td></tr></table></figure><p>创建服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;</span><br><span class="line"># This is a mostly empty service, but allows commands like stop, start, reload</span><br><span class="line"># to propagate to all tinc@ service instances.</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=Tinc VPN</span><br><span class="line">Documentation=info:tinc</span><br><span class="line">Documentation=man:tinc(8) man:tinc.conf(5)</span><br><span class="line">Documentation=http://tinc-vpn.org/docs/</span><br><span class="line">After=network.target</span><br><span class="line">Wants=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line">ExecStart=/bin/true</span><br><span class="line">ExecReload=/bin/true</span><br><span class="line">WorkingDirectory=/usr/local/etc/tinc</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target&#x27; &gt; /lib/systemd/system/tinc.service</span><br><span class="line"></span><br><span class="line">echo &#x27;</span><br><span class="line">[Unit]</span><br><span class="line">Description=Tinc net %i</span><br><span class="line">Documentation=info:tinc</span><br><span class="line">Documentation=man:tinc(8) man:tinc.conf(5)</span><br><span class="line">Documentation=http://tinc-vpn.org/docs/</span><br><span class="line">PartOf=tinc.service</span><br><span class="line">ReloadPropagatedFrom=tinc.service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">WorkingDirectory=/usr/local/etc/tinc/%i</span><br><span class="line">ExecStart=/usr/local/sbin/tincd -n %i -D</span><br><span class="line">ExecReload=/usr/local/sbin/tincd -n %i reload</span><br><span class="line">KillMode=mixed</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=5</span><br><span class="line">TimeoutStopSec=5</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=tinc.service&#x27; &gt; /lib/systemd/system/tinc@.service</span><br><span class="line"># 刷新服务</span><br><span class="line">sudo systemctl unmask tinc</span><br></pre></td></tr></table></figure><h3 id="2-子节点安装"><a href="#2-子节点安装" class="headerlink" title="2) 子节点安装"></a>2) 子节点安装</h3><p>环境：<code>Openwrt 21.02</code> 网络：<code>10.0.0.0/24</code> 内网IP：<code>10.0.0.1</code> 虚拟网络IP: <code>10.100.1.1</code> 虚拟网络名：openwrt 由于部分固件并没有Tinc 需要自己手工安装</p><ul><li>方法一、</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">opkg update</span><br><span class="line">opkg install tinc</span><br></pre></td></tr></table></figure><ul><li>方法二、 X86 架构的IPK安装包：<a target="_blank" rel="noopener" href="https://downloads.openwrt.org/releases/packages-21.02/x86_64/packages/tinc_1.1-git-2_x86_64.ipk">点我下载</a></li><li>方法三、 我这里编译了X86 的固件：<a target="_blank" rel="noopener" href="https://share.nextrt.com/#/%E8%B7%AF%E7%94%B1%E5%99%A8%E5%9B%BA%E4%BB%B6/%E8%BD%AF%E8%B7%AF%E7%94%B1">点我进入</a></li></ul><p>安装过程与主节点基本一致 开始（已安装tinc）： 1、建立配置文件夹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/tinc/openwrt/hosts/</span><br></pre></td></tr></table></figure><p>1、配置<code>/etc/tinc/openwrt/tinc.conf</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Name = openwrt</span><br><span class="line">Interface = tinc</span><br><span class="line">#Mode = switch</span><br><span class="line">Autoconnect = yes</span><br><span class="line">Compression=9</span><br><span class="line">Cipher  = aes-256-cbc</span><br><span class="line">Digest = sha256</span><br><span class="line">BindToAddress = * 10010</span><br><span class="line">Device = /dev/net/tun</span><br></pre></td></tr></table></figure><p>2、配置<code>/etc/tinc/openwrt/tinc-up</code>： 这里有区别的是，我想让虚拟网内机器能访问到Openwrt 路由网段<code>10.0.0.0/24</code>内网资源，所以这里</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">ip link set $INTERFACE up</span><br><span class="line">ip addr add 10.100.1.1/32 dev $INTERFACE</span><br><span class="line">ip route add 10.100.1.0/24 dev $INTERFACE</span><br><span class="line">iptables -A FORWARD -o &quot;$&#123;INTERFACE&#125;&quot; -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -A FORWARD -i &quot;$&#123;INTERFACE&#125;&quot; -j ACCEPT</span><br><span class="line">iptables -t nat -A POSTROUTING -s &quot;10.100.1.0&quot;/&quot;255.255.255.0&quot; ! -o &quot;$&#123;INTERFACE&#125;&quot; -j MASQUERADE</span><br></pre></td></tr></table></figure><p>3、配置<code>/etc/tinc/openwrt/tinc-down</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">ip route del 10.100.1.0/24 dev $INTERFACE</span><br><span class="line">ip addr del 10.100.1.1/32 dev $INTERFACE</span><br><span class="line">iptables -D FORWARD -o &quot;$&#123;INTERFACE&#125;&quot; -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -D FORWARD -i &quot;$&#123;INTERFACE&#125;&quot; -j ACCEPT</span><br><span class="line">iptables -t nat -D POSTROUTING -s &quot;10.100.1.0&quot;/&quot;255.255.255.0&quot; ! -o &quot;$&#123;INTERFACE&#125;&quot; -j MASQUERADE</span><br><span class="line">ip link set $INTERFACE down</span><br></pre></td></tr></table></figure><p>4、配置节点信息<code>/etc/tinc/openwrt/hosts/openwrt</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 分配给OPENWRT的虚拟LANIP</span><br><span class="line">Subnet=10.100.1.1/32</span><br><span class="line"># 路由器所在的网段</span><br><span class="line">Subnet=10.0.0.0/24</span><br><span class="line">Port = 10010</span><br></pre></td></tr></table></figure><p>5、赋予脚本权限：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/tinc/openwrt/tinc-*</span><br></pre></td></tr></table></figure><p>6、接下来创建密钥信息，在询问保存位置时直接回车使用默认位置即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tinc -n openwrt generate-rsa-keys</span><br><span class="line">tinc -n openwrt generate-ed25519-keys</span><br></pre></td></tr></table></figure><p>7、复制主节点中的<code>/etc/tinc/hnvps/hosts/hnvps</code>到openwrt 路由器节点的<code>/etc/tinc/openwrt/hosts</code>目录下。复制路由器的<code>/etc/tinc/openwrt/hosts/openwrt</code>到主节点的<code>/etc/tinc/hnvps/hosts/</code>目录下 此时路由器openwrt 的 <code>/etc/tinc/openwrt/</code> 目录下的情况为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">├── ed25519_key.priv</span><br><span class="line">├── hosts/</span><br><span class="line">│   └── openwrt</span><br><span class="line">│   └── hnvps</span><br><span class="line">├── rsa_key.priv</span><br><span class="line">├── tinc-down</span><br><span class="line">├── tinc-up</span><br><span class="line">└── tinc.conf</span><br></pre></td></tr></table></figure><p>最后需要编辑 &#x2F;etc&#x2F;config&#x2F;tinc 文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">config tinc-net openwrt</span><br><span class="line">    option enabled 1</span><br><span class="line">    option Name openwrt</span><br><span class="line"></span><br><span class="line">config tinc-host openwrt</span><br><span class="line">    option enabled 1</span><br><span class="line">    option net openwrt</span><br></pre></td></tr></table></figure><p>启动服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/tinc start</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/10/05/manjaro-%E5%AE%89%E8%A3%85%E5%90%8E%E8%AE%BE%E7%BD%AE%E4%B8%8E%E7%BE%8E%E5%8C%96/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/10/05/manjaro-%E5%AE%89%E8%A3%85%E5%90%8E%E8%AE%BE%E7%BD%AE%E4%B8%8E%E7%BE%8E%E5%8C%96/" class="post-title-link" itemprop="url">Manjaro 安装后设置与美化</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-10-05 16:44:14" itemprop="dateCreated datePublished" datetime="2022-10-05T16:44:14+08:00">2022-10-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>3.8k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>3 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="系统配置"><a href="#系统配置" class="headerlink" title="系统配置"></a>系统配置</h2><h3 id="修改软件源为国内镜像，加快软件下载速度"><a href="#修改软件源为国内镜像，加快软件下载速度" class="headerlink" title="修改软件源为国内镜像，加快软件下载速度"></a>修改软件源为国内镜像，加快软件下载速度</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman-mirrors -i -c China -m rank</span><br></pre></td></tr></table></figure><p>更新软件列表和软件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syyuu</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1623675265752.png" alt="image.png"></p><p>image.png</p><h3 id="添加archlinuxcn源"><a href="#添加archlinuxcn源" class="headerlink" title="添加archlinuxcn源"></a>添加archlinuxcn源</h3><blockquote><p>ArchLinuxCN是Arch中文组维护的一个软件合集，包含了中文用户常用的WPS Office、搜狗拼音、Google Chrome等软件。不过系统默认都不包含这个源，因此我们需要手动来配置使用这个源。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;\n[archlinuxcn]\nSigLevel = TrustAll\nServer = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/\$arch\nServer = https://mirrors.163.com/archlinux-cn/\$arch\nServer = https://repo.huaweicloud.com/archlinuxcn/\$arch\n&quot;  sudo tee -a /etc/pacman.conf</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1623675319547.png" alt="image.png"></p><p>image.png</p><p>安装密钥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S archlinuxcn-keyring</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1623675445915.png" alt="image.png"></p><p>image.png</p><p>更新软件列表和软件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syyuu</span><br></pre></td></tr></table></figure><p>源地址参考</p><ol><li>浙江大学： <a target="_blank" rel="noopener" href="https://mirrors.zju.edu.cn/archlinuxcn/$arch">https://mirrors.zju.edu.cn/archlinuxcn/$arch</a></li><li>中国科学技术大学 ：<a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/archlinuxcn/$arch">https://mirrors.ustc.edu.cn/archlinuxcn/$arch</a></li><li>清华大学：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch">https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch</a></li><li>网易 ： <a target="_blank" rel="noopener" href="https://mirrors.163.com/archlinux-cn/$arch">https://mirrors.163.com/archlinux-cn/$arch</a></li></ol><h3 id="运行环境安装"><a href="#运行环境安装" class="headerlink" title="运行环境安装"></a>运行环境安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S clang make cmake gdb git base-devel net-tools curl sqlite dlang pkg-config sqlite ldc</span><br></pre></td></tr></table></figure><h3 id="安装Yaourt和Yay"><a href="#安装Yaourt和Yay" class="headerlink" title="安装Yaourt和Yay"></a>安装Yaourt和Yay</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S yaourt yay</span><br><span class="line">yay --aururl &quot;https://aur.tuna.tsinghua.edu.cn&quot; --save</span><br></pre></td></tr></table></figure><h3 id="时间同步问题"><a href="#时间同步问题" class="headerlink" title="时间同步问题"></a>时间同步问题</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S ntp</span><br><span class="line">sudo ntpdate cn.ntp.org.cn</span><br><span class="line">sudo hwclock --systohc </span><br><span class="line">timedatectl set-ntp true</span><br></pre></td></tr></table></figure><p>解决Windows和Linux双系统时间不一致问题</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo timedatectl set-local-rtc 1 </span><br></pre></td></tr></table></figure><h3 id="解决系统中文乱码"><a href="#解决系统中文乱码" class="headerlink" title="解决系统中文乱码"></a>解决系统中文乱码</h3><p>安装中文字体：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S wqy-zenhei ttf-fireflysung firefox-i18n-zh-cn thunderbird-i18n-zh-cn gimp-help-zh_cn man-pages-zh_cn wqy-microhei-lite wqy-bitmapfont adobe-source-han-sans-cn-fonts adobe-source-han-serif-cn-fonts noto-fonts-cjk wqy-microhei ttf-roboto noto-fonts ttf-dejavu &amp;&amp; sudo fc-cache -fv &amp;&amp; sudo locale-gen</span><br></pre></td></tr></table></figure><p>然后系统设置里面添加中文语言包，然后本地化设置将中文设置为默认语言，重启即可</p><h3 id="图标主题安装"><a href="#图标主题安装" class="headerlink" title="图标主题安装"></a>图标主题安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S gtk-engine-murrine gtk-engines</span><br><span class="line">sudo pacman -S Adapta-gtk-theme-colorpack </span><br><span class="line">sudo pacman -S Adapta-gtk-theme</span><br><span class="line">sudo pacman -S papirus-icon-theme</span><br></pre></td></tr></table></figure><h3 id="输入法解决"><a href="#输入法解决" class="headerlink" title="输入法解决"></a>输入法解决</h3><p>安装Fcitx5中文输入法：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S fcitx5 fcitx5-qt fcitx5-gtk fcitx5-configtool fcitx5-rime fcitx5-chinese-addons fcitx5-chewing fcitx5-pinyin-moegirl</span><br></pre></td></tr></table></figure><p>修改Fcitx5主题</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/tonyfettes/fcitx5-nord.git</span><br><span class="line">mkdir -p ~/.local/share/fcitx5/themes/</span><br><span class="line">cd &amp;&amp; cd fcitx5-nord</span><br><span class="line">cp -r Nord-Dark/ Nord-Light ~/.local/share/fcitx5/themes/</span><br><span class="line">cd &amp;&amp; rm -rf fcitx5-nord</span><br><span class="line">git clone https://github.com/thep0y/fcitx5-themes.git</span><br><span class="line">cd fcitx5-themes &amp;&amp; cp -r winter/ ~/.local/share/fcitx5/themes</span><br></pre></td></tr></table></figure><p>需要修改~&#x2F;.config&#x2F;fcitx5&#x2F;conf&#x2F;classicui.conf 文件为以下内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano ~/.config/fcitx5/conf/classicui.conf</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">垂直候选列表</span></span><br><span class="line">Vertical Candidate List=False</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">按屏幕 DPI 使用</span></span><br><span class="line">PerScreenDPI=True</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用鼠标滚轮翻页</span></span><br><span class="line">WheelForPaging=True</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">字体</span></span><br><span class="line">Font=&quot;思源黑体 CN 12&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">菜单字体</span></span><br><span class="line">MenuFont=&quot;Sans Serif 10&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用输入法的语言来显示文字</span></span><br><span class="line">UseInputMethodLangaugeToDisplayText=True</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">主题</span></span><br><span class="line">Theme=winter</span><br></pre></td></tr></table></figure><p>修改~&#x2F;.config&#x2F;fcitx5&#x2F;conf&#x2F;pinyin.conf 内容为以下附件内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.nextrt.com/blog/pinyin_1623636543395.conf</span><br></pre></td></tr></table></figure><p>修改系统设置使Fcitx5生效</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export LC_ALL=zh_CN.UTF-8</span><br><span class="line">export INPUT_METHOD=&quot;fcitx5&quot;</span><br><span class="line">export XMODIFIERS=&quot;@im=fcitx5&quot;</span><br><span class="line">export GTK_IM_MODULE=&quot;fcitx5&quot;</span><br><span class="line">export QT_IM_MODULE=&quot;fcitx5&quot;</span><br><span class="line">ulimit -HSn 102400</span><br></pre></td></tr></table></figure><h2 id="开发环境及工具"><a href="#开发环境及工具" class="headerlink" title="开发环境及工具"></a>开发环境及工具</h2><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><p>安装JDK</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S jdk8-openjdk jdk11-openjdk jdk-openjdk</span><br></pre></td></tr></table></figure><p>切换java 版本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">archlinux-java status</span><br><span class="line">sudo archlinux-java set java-11-openjdk</span><br></pre></td></tr></table></figure><p>安装Intellij-Idea</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S intellij-idea-ultimate-edition</span><br></pre></td></tr></table></figure><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>###安装AndroidStudio以及安卓开发需要组件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S android-studio</span><br><span class="line">sudo pacman -S android-sdk-platform-tools</span><br><span class="line">sudo pacman -S android-tools</span><br></pre></td></tr></table></figure><h3 id="Go-Nodejs-Npm"><a href="#Go-Nodejs-Npm" class="headerlink" title="Go Nodejs Npm"></a>Go Nodejs Npm</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S go nodejs npm</span><br></pre></td></tr></table></figure><h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p>安装Anaconda</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S anaconda</span><br></pre></td></tr></table></figure><p>安装pyenv</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S pyenv</span><br></pre></td></tr></table></figure><p>安装Pytcharm</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S pycharm</span><br></pre></td></tr></table></figure><p>安装VSCODE</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S visual-studio-code-bin</span><br></pre></td></tr></table></figure><h2 id="其他软件"><a href="#其他软件" class="headerlink" title="其他软件"></a>其他软件</h2><p>Typora MD编辑工具</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo  pacman -S typora</span><br></pre></td></tr></table></figure><p>安装微软EDGE浏览器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S microsoft-edge-dev-bin</span><br></pre></td></tr></table></figure><p>aria2</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S aria2</span><br></pre></td></tr></table></figure><p>mailspring</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S mailspring</span><br></pre></td></tr></table></figure><p>onedrive</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S libnotify</span><br><span class="line">pamac build onedrive-abraunegg</span><br></pre></td></tr></table></figure><p>kate 文本编辑器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S kate</span><br></pre></td></tr></table></figure><p>QQ音乐</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S qqmusic-bin</span><br></pre></td></tr></table></figure><p>ToDesk 远程控制</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S todesk-bin</span><br></pre></td></tr></table></figure><p>Chrome浏览器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S google-chrome</span><br></pre></td></tr></table></figure><p>wps</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S wps-office ttf-wps-fonts</span><br></pre></td></tr></table></figure><p>网易音乐云</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S netease-cloud-music</span><br></pre></td></tr></table></figure><p>压缩解压缩</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S file-roller unrar unzip p7zip </span><br></pre></td></tr></table></figure><p>motrix</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S motrix-bin</span><br></pre></td></tr></table></figure><p>utools</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S utools</span><br></pre></td></tr></table></figure><p>screenfetch</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S screenfetch</span><br><span class="line">screenfetch -A &#x27;Arch Linux&#x27;</span><br></pre></td></tr></table></figure><p>百度网盘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S baidunetdisk-bin</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2022/10/05/dns-over-https-%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content=" | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2022/10/05/dns-over-https-%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">DNS-over-HTTPS 服务搭建教程</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-10-05 16:40:50" itemprop="dateCreated datePublished" datetime="2022-10-05T16:40:50+08:00">2022-10-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>6.6k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>6 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><ol><li>服务域名。</li><li>服务域名对应的SSL证书。</li><li>一台服务器。</li></ol><h2 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h2><blockquote><p>系统: Centos 7 配置信息：1H&#x2F;2G&#x2F;5M</p></blockquote><h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><h3 id="Unbound"><a href="#Unbound" class="headerlink" title="Unbound"></a>Unbound</h3><p>Unbound负责解析、缓、转发查询、 DNS-OVER-TLS</p><h3 id="DOH-Server"><a href="#DOH-Server" class="headerlink" title="DOH Server"></a>DOH Server</h3><p>提供 DNS-OVER-HTTP 服务</p><h3 id="NGINX"><a href="#NGINX" class="headerlink" title="NGINX"></a>NGINX</h3><p>将DNS-OVER-HTTP转DNS-OVER-HTTPS</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="1、配置安装环境"><a href="#1、配置安装环境" class="headerlink" title="1、配置安装环境"></a>1、配置安装环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum install -y crontabs</span><br><span class="line">yum install -y wget gcc tar zip redhat-lsb gawk unzip net-tools psmisc glibc-static expect telnet</span><br><span class="line">yum install -y openssl openssl-devel lzo lzo-devel pam pam-devel automake</span><br><span class="line">yum install -y autoconf libtool make build-essential curl curl-devel zlib-devel perl perl-devel perl-core cpio expat-devel gettext-devel git asciidoc xmlto</span><br><span class="line">yum -y install epel-release bind-util libevent libevent-devel</span><br><span class="line">yum install python-setuptools -y &amp;&amp; easy_install pip</span><br><span class="line">yum install python-devel libffi-devel -y</span><br><span class="line">yum group install &#x27;Development Tools&#x27; -y</span><br></pre></td></tr></table></figure><h3 id="2、安装Go"><a href="#2、安装Go" class="headerlink" title="2、安装Go"></a>2、安装Go</h3><p>dns-over-https 服务基于Go语言编写，所以需要安装GO语言环境。 下面的Go是Linux x86-64的安装包，如果你得机器是其他架构，请到<a target="_blank" rel="noopener" href="https://studygolang.com/dl">https://studygolang.com/dl</a>选择自己机器对应的安装包。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https://studygolang.com/dl/golang/go1.18.2.linux-amd64.tar.gz</span><br><span class="line">tar -C /usr/local -xzf go1.18.2.linux-amd64.tar.gz &amp;&amp; rm -rf go1.18.2.linux-amd64.tar.gz</span><br><span class="line">mkdir -p /root/go</span><br><span class="line">echo &#x27;export GOROOT=/usr/local/go</span><br><span class="line">export PATH=$PATH:$GOROOT/bin</span><br><span class="line">export GOPATH=/root/go&#x27; &gt;&gt;/etc/profile</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1593416570865.png" alt="安装Go"></p><p>安装Go</p><p>配置国内镜像,国外服务器跳过下面步骤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line">go env -w GOPROXY=https://goproxy.cn,direct</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1593416593445.png" alt="配置国内镜像源"></p><p>配置国内镜像源</p><h3 id="3、安装libsodium"><a href="#3、安装libsodium" class="headerlink" title="3、安装libsodium"></a>3、安装libsodium</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /root</span><br><span class="line">wget -N --no-check-certificate https://cdn.nextrt.com/dns/soft/libsodium-1.0.18.tar.gz</span><br><span class="line">tar xf libsodium-1.0.18.tar.gz &amp;&amp; cd libsodium-1.0.18</span><br><span class="line">./configure &amp;&amp; make -j2 &amp;&amp; make install</span><br><span class="line">echo /usr/local/lib &gt;/etc/ld.so.conf.d/usr_local_lib.conf</span><br><span class="line">ldconfig</span><br><span class="line">rm -rf ../libsodium-1.0.18*</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1593417096767.png" alt="安装libsodium"></p><p>安装libsodium</p><h3 id="4、安装DOH-Server"><a href="#4、安装DOH-Server" class="headerlink" title="4、安装DOH Server"></a>4、安装DOH Server</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /root</span><br><span class="line">git clone https://github.com/m13253/dns-over-https.git</span><br><span class="line">cd dns-over-https</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">systemctl start doh-server.service</span><br><span class="line">systemctl enable doh-server.service</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1593417280870.png" alt="安装DOH Server"></p><p>安装DOH Server</p><h3 id="5、安装Unbound"><a href="#5、安装Unbound" class="headerlink" title="5、安装Unbound"></a>5、安装Unbound</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https://nlnetlabs.nl/downloads/unbound/unbound-1.15.0.tar.gz --no-check-certificate</span><br><span class="line">tar -zxvf unbound-1.15.0.tar.gz &amp;&amp; rm -rf unbound-1.15.0.tar.gz &amp;&amp; cd unbound-1.15.0 &amp;&amp; ./configure --enable-subnet --with-libevent --with-pthreads --with-ssl --enable-dnscrypt</span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line">curl -o /usr/local/etc/unbound/root.hints ftp://ftp.internic.net/domain/named.cache</span><br><span class="line">/sbin/ldconfig -v</span><br><span class="line">unbound-anchor</span><br><span class="line">mkdir /etc/unbound</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2022/10/image_1593418381412.png" alt="安装Unbound"></p><p>安装Unbound</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="配置Unbound"><a href="#配置Unbound" class="headerlink" title="配置Unbound"></a>配置Unbound</h3><p>以下是部分需要自己配置的地方文件说明</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">verbosity:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">interface:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">@50</span> <span class="comment">#监听50端口，用于普通查询</span></span><br><span class="line"><span class="attr">interface:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">@853</span> <span class="comment">#监听853端口，用于提供DNS-over-TLS</span></span><br><span class="line"><span class="attr">do-ip6:</span> <span class="literal">no</span> <span class="comment">#如果你有ipv6网络，可以将no改为yes</span></span><br><span class="line"><span class="attr">num-threads:</span> <span class="string">CPU核心数</span></span><br><span class="line"><span class="attr">msg-cache-slabs:</span> <span class="string">CPU核心数</span></span><br><span class="line"><span class="attr">rrset-cache-slabs:</span> <span class="string">CPU核心数</span></span><br><span class="line"><span class="attr">key-cache-slabs:</span> <span class="string">CPU核心数</span></span><br><span class="line"><span class="attr">infra-cache-slabs:</span> <span class="string">CPU核心数</span></span><br><span class="line"></span><br><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/insecure.conf&quot;</span> <span class="comment">#国内机器需要跳过某些域名的DNSSEC校验，国外机器删除此行</span></span><br><span class="line"><span class="attr">tls-port:</span> <span class="number">853</span> <span class="comment">#DOT端口,不需要DOT删除此行</span></span><br><span class="line"><span class="attr">tls-service-key:</span> <span class="string">&quot;TLSKEY&quot;</span> <span class="comment">#SSL密钥文件路径,不需要DOT删除此行</span></span><br><span class="line"><span class="attr">tls-service-pem:</span> <span class="string">&quot;TLSCERT&quot;</span> <span class="comment">#SSL证书文件路径,不需要DOT删除此行</span></span><br><span class="line"></span><br><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/forward.conf&quot;</span> <span class="comment">#国内机器需要转发部分域名的查询，国外机器删除此行</span></span><br><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/domestic.conf&quot;</span> <span class="comment">#国内外机器都需要对某些高防DNS查询请求进行转发</span></span><br></pre></td></tr></table></figure><h4 id="国内机器配置文件参考"><a href="#国内机器配置文件参考" class="headerlink" title="国内机器配置文件参考"></a>国内机器配置文件参考</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">verbosity:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">interface:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">@50</span></span><br><span class="line"><span class="attr">interface:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">@853</span></span><br><span class="line"><span class="attr">username:</span> <span class="string">&quot;root&quot;</span></span><br><span class="line"><span class="attr">access-control:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/0</span> <span class="string">allow</span></span><br><span class="line"><span class="attr">access-control:</span> <span class="string">::1</span> <span class="string">allow</span></span><br><span class="line"><span class="attr">do-ip4:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">do-ip6:</span> <span class="literal">no</span></span><br><span class="line"><span class="attr">do-udp:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">do-tcp:</span> <span class="literal">yes</span></span><br><span class="line"></span><br><span class="line"><span class="attr">num-threads:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">msg-cache-slabs:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">rrset-cache-slabs:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">key-cache-slabs:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">infra-cache-slabs:</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-servfail:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">aggressive-nsec:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">hide-trustanchor:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">hide-version:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">hide-identity:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">qname-minimisation:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">qname-minimisation-strict:</span> <span class="literal">no</span></span><br><span class="line"><span class="attr">minimal-responses:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">rrset-roundrobin:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">so-reuseport:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">do-not-query-localhost:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">infra-cache-numhosts:</span> <span class="number">10000</span></span><br><span class="line"><span class="attr">so-rcvbuf:</span> <span class="string">8m</span></span><br><span class="line"><span class="attr">so-sndbuf:</span> <span class="string">8m</span></span><br><span class="line"><span class="attr">neg-cache-size:</span> <span class="string">32m</span></span><br><span class="line"><span class="attr">msg-cache-size:</span> <span class="string">64m</span></span><br><span class="line"><span class="attr">key-cache-size:</span> <span class="string">64m</span></span><br><span class="line"><span class="attr">neg-cache-size:</span> <span class="string">32m</span></span><br><span class="line"><span class="attr">rrset-cache-size:</span> <span class="string">128m</span></span><br><span class="line"></span><br><span class="line"><span class="attr">outgoing-range:</span> <span class="number">8192</span></span><br><span class="line"><span class="attr">num-queries-per-thread:</span> <span class="number">4096</span></span><br><span class="line"><span class="attr">outgoing-num-tcp:</span> <span class="number">1024</span></span><br><span class="line"><span class="attr">incoming-num-tcp:</span> <span class="number">2048</span></span><br><span class="line"><span class="attr">jostle-timeout:</span> <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cache-min-ttl:</span> <span class="number">120</span></span><br><span class="line"><span class="attr">cache-max-ttl:</span> <span class="number">86400</span></span><br><span class="line"><span class="attr">infra-host-ttl:</span> <span class="number">3600</span></span><br><span class="line"><span class="attr">serve-expired-ttl:</span> <span class="number">86400</span></span><br><span class="line"><span class="attr">cache-max-negative-ttl:</span> <span class="number">360</span></span><br><span class="line"><span class="attr">serve-expired:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">prefetch:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">prefetch-key:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">max-udp-size:</span> <span class="number">4096</span></span><br><span class="line"><span class="attr">edns-buffer-size:</span> <span class="number">4096</span></span><br><span class="line"><span class="attr">send-client-subnet:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/0</span></span><br><span class="line"><span class="attr">send-client-subnet:</span> <span class="string">::0/0</span></span><br><span class="line"><span class="attr">max-client-subnet-ipv6:</span> <span class="number">56</span></span><br><span class="line"><span class="attr">max-client-subnet-ipv4:</span> <span class="number">24</span></span><br><span class="line"><span class="attr">client-subnet-always-forward:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">module-config:</span> <span class="string">&quot;subnetcache validator iterator&quot;</span></span><br><span class="line"><span class="attr">root-hints:</span> <span class="string">&quot;root.hints&quot;</span></span><br><span class="line"><span class="attr">auto-trust-anchor-file:</span> <span class="string">&quot;/usr/local/etc/unbound/root.key&quot;</span></span><br><span class="line"><span class="attr">tls-cert-bundle:</span> <span class="string">&quot;/etc/pki/tls/certs/ca-bundle.crt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">minimal-responses:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/insecure.conf&quot;</span></span><br><span class="line"><span class="attr">tls-port:</span> <span class="number">853</span></span><br><span class="line"><span class="attr">tls-service-key:</span> <span class="string">&quot;/www/server/panel/vhost/cert/dns.233py.com/privkey.pem&quot;</span></span><br><span class="line"><span class="attr">tls-service-pem:</span> <span class="string">&quot;/www/server/panel/vhost/cert/dns.233py.com/fullchain.pem&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/forward.conf&quot;</span></span><br><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/domestic.conf&quot;</span></span><br></pre></td></tr></table></figure><p>国外机器请删除上面文件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/forward.conf&quot;</span></span><br><span class="line"><span class="attr">include:</span> <span class="string">&quot;/etc/unbound/insecure.conf&quot;</span></span><br></pre></td></tr></table></figure><h3 id="配置DNS-OVER-HTTP"><a href="#配置DNS-OVER-HTTP" class="headerlink" title="配置DNS-OVER-HTTP"></a>配置DNS-OVER-HTTP</h3><p>编辑<code>/etc/dns-over-https/doh-server.conf</code>修改内容为下方所示</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># HTTP listen port</span><br><span class="line">listen = [</span><br><span class="line">    &quot;127.0.0.1:8053&quot;,</span><br><span class="line">    &quot;[::1]:8053&quot;,</span><br><span class="line">]</span><br><span class="line">local_addr = &quot;&quot;</span><br><span class="line">cert = &quot;&quot;</span><br><span class="line">key = &quot;&quot;</span><br><span class="line">path = &quot;/dns-query&quot;</span><br><span class="line">upstream = [</span><br><span class="line">    &quot;udp:127.0.0.1:50&quot;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">timeout = 6</span><br><span class="line">tries = 3</span><br><span class="line">verbose = false</span><br><span class="line">log_guessed_client_ip = false</span><br></pre></td></tr></table></figure><h3 id="配置文件自动更新"><a href="#配置文件自动更新" class="headerlink" title="配置文件自动更新"></a>配置文件自动更新</h3><p>因为高防dns列表和转发列表可能每天都在更新所以需要添加一个定时任务来执行以下脚本，具体怎么添加不做赘述，请自行添加。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">echo Restart DNS Serve...</span><br><span class="line">echo &quot;更新转发配置文件&quot;</span><br><span class="line">curl -o /etc/unbound/forward.conf https://download.233py.com/dns/update/forward.conf</span><br><span class="line">curl -o /etc/unbound/domestic.conf https://download.233py.com/dns/update/domestic.conf</span><br><span class="line">curl -o /etc/unbound/insecure.conf https://download.233py.com/dns/update/insecure.conf</span><br><span class="line">echo &quot;重启Unbound&quot;</span><br><span class="line">killall unbound</span><br><span class="line">unbound -v</span><br><span class="line">echo &quot;重启DOH&quot;</span><br><span class="line">systemctl restart doh-server.service</span><br><span class="line">echo &quot;重启完成&quot;</span><br><span class="line">exit 0;</span><br></pre></td></tr></table></figure><h3 id="进程检查，防止宕机"><a href="#进程检查，防止宕机" class="headerlink" title="进程检查，防止宕机"></a>进程检查，防止宕机</h3><p>每分钟运行下面脚本，防止Unbound进程挂了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">PIDS=`ps -ef grep unbound grep -v grep  awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>`</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$PIDS</span>&quot;</span> == <span class="string">&quot;&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"> unbound -v</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="放行防火墙"><a href="#放行防火墙" class="headerlink" title="放行防火墙"></a>放行防火墙</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --zone=public --add-port=853/tcp</span><br><span class="line">firewall-cmd --permanent --zone=public --add-port=443/tcp</span><br><span class="line">firewall-cmd --permanent --zone=public --add-port=80/tcp</span><br><span class="line">firewall-cmd --reload</span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure><h3 id="配置Nginx"><a href="#配置Nginx" class="headerlink" title="配置Nginx"></a>配置Nginx</h3><p>之前dns-over-https服务只是实现dns-over-http而https工作交由nginx来实现。 在nginx配置文件中添加以下内容</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="section">location</span> /dns-query &#123;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> REMOTE-HOST <span class="variable">$remote_addr</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line">    <span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">    <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    <span class="attribute">proxy_read_timeout</span> <span class="number">86400</span>;</span><br><span class="line">    <span class="attribute">proxy_pass</span> http://127.0.0.1:8053/dns-query;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">add_header</span> X-Cache <span class="variable">$upstream_cache_status</span>;</span><br><span class="line">    <span class="attribute">proxy_ignore_headers</span> Set-Cookie Cache-Control expires;</span><br><span class="line">    <span class="attribute">proxy_cache</span> cache_one;</span><br><span class="line">    <span class="attribute">proxy_cache_key</span> <span class="variable">$remote_addr</span><span class="variable">$uri</span><span class="variable">$is_args</span><span class="variable">$args</span>;</span><br><span class="line">    <span class="attribute">proxy_cache_valid</span> <span class="number">200</span> <span class="number">304</span> <span class="number">301</span> <span class="number">302</span> <span class="number">1m</span>;</span><br><span class="line">    <span class="attribute">expires</span> <span class="number">12h</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><nav class="pagination"><a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/30/">30</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/5/"><i class="fa fa-angle-right"></i></a></nav></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Jarod</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">755k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">11:26</span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript></body></html>