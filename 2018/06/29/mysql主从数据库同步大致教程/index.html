<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"jarod.vip",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"always",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="主从数据库 mysql主从复制原理: mysql支持单向、异步复制，复制过程中一个服务器充当主服务器，而一个或多个其它服务器充当从服务器。 mysql复制基于主服务器在二进制日志中跟踪所有对数据库的更改(更新、删除等等)。因此，要进行复制，必须在主服务器上启用二进制日志。 每个从服务器从主服务器接收主服务器已经记录到其二进制日志的保存的更新。当一个从服务器连接主服务器时， 它通知主服务器从服务器在"><meta property="og:type" content="article"><meta property="og:title" content="MySQL主从数据库同步大致教程"><meta property="og:url" content="https://jarod.vip/2018/06/29/mysql%E4%B8%BB%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E5%A4%A7%E8%87%B4%E6%95%99%E7%A8%8B/index.html"><meta property="og:site_name" content="Jarod&#39;s Blog"><meta property="og:description" content="主从数据库 mysql主从复制原理: mysql支持单向、异步复制，复制过程中一个服务器充当主服务器，而一个或多个其它服务器充当从服务器。 mysql复制基于主服务器在二进制日志中跟踪所有对数据库的更改(更新、删除等等)。因此，要进行复制，必须在主服务器上启用二进制日志。 每个从服务器从主服务器接收主服务器已经记录到其二进制日志的保存的更新。当一个从服务器连接主服务器时， 它通知主服务器从服务器在"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-06-29T01:12:14.000Z"><meta property="article:modified_time" content="2022-09-29T13:27:45.832Z"><meta property="article:author" content="Jarod"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://jarod.vip/2018/06/29/mysql%E4%B8%BB%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E5%A4%A7%E8%87%B4%E6%95%99%E7%A8%8B/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>MySQL主从数据库同步大致教程 | Jarod's Blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Jarod's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Jarod's Blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2018/06/29/mysql%E4%B8%BB%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E5%A4%A7%E8%87%B4%E6%95%99%E7%A8%8B/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">MySQL主从数据库同步大致教程</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-06-29 09:12:14" itemprop="dateCreated datePublished" datetime="2018-06-29T09:12:14+08:00">2018-06-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:45" itemprop="dateModified" datetime="2022-09-29T21:27:45+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>3.3k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>3 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>主从数据库</p><p>mysql主从复制原理: mysql支持单向、异步复制，复制过程中一个服务器充当主服务器，而一个或多个其它服务器充当从服务器。 mysql复制基于主服务器在二进制日志中跟踪所有对数据库的更改(更新、删除等等)。因此，要进行复制，必须在主服务器上启用二进制日志。 每个从服务器从主服务器接收主服务器已经记录到其二进制日志的保存的更新。当一个从服务器连接主服务器时， 它通知主服务器从服务器在日志中读取的最后一次成功更新的位置。从服务器接收从那时起发生的任何更新，并在本机上执行相同的更新。 然后封锁并等待主服务器通知新的更新。从服务器执行备份不会干扰主服务器，在备份过程中主服务器可以继续处理更新。</p><p>1、修改主服务器master: #vi &#x2F;etc&#x2F;my.cnf [mysqld] log-bin&#x3D;mysql-bin &#x2F;&#x2F;[必须]启用二进制日志 server-id&#x3D;1 &#x2F;&#x2F;[必须]服务器唯一ID，默认是1，一般取IP最后一段</p><p>2、修改从服务器slave: #vi &#x2F;etc&#x2F;my.cnf [mysqld] log-bin&#x3D;mysql-bin &#x2F;&#x2F;[不是必须]启用二进制日志 server-id&#x3D;226 &#x2F;&#x2F;[必须]服务器唯一ID，默认是1，一般取IP最后一段</p><p>3、重启数据库 service mysqld restart</p><p>4、创建用户 xxxx</p><p>5、登录主服务器的mysql，查询master的状态 mysql&gt;show master status; MySQL [mysql]&gt; show master status; +——————+———-+————–+——————+——————-+ File Position Binlog_Do_DB Binlog_Ignore_DB Executed_Gtid_Set +——————+———-+————–+——————+——————-+ mysql-bin.000020 82373 +——————+———-+————–+——————+——————-+ 1 row in set (0.00 sec)</p><p>6、配置从服务器Slave： Mysql&gt;change master to master_host&#x3D;’xxxx’,master_user&#x3D;’xxxx’,master_password&#x3D;’xxxxx1′,master_log_file&#x3D;’mysql-bin.000020′,master_log_pos&#x3D;14141889; &#x2F;&#x2F;注意不要断开，308数字前后无单引号。 Mysql&gt;flush privileges; Mysql&gt;start slave; &#x2F;&#x2F;启动从服务器复制功能</p><p>7、查看 Mysql&gt; show slave status\G</p><p>*************************** 1. row ***************************</p><p>Slave_IO_State: Waiting for master to send event Master_Host: xxx &#x2F;&#x2F;主服务器地址 Master_User: xxxxx &#x2F;&#x2F;授权帐户名，尽量避免使用root Master_Port: 3306 &#x2F;&#x2F;数据库端口，部分版本没有此行 Connect_Retry: 60 Master_Log_File: mysql-bin.000004 Read_Master_Log_Pos: 600 &#x2F;&#x2F;#同步读取二进制日志的位置，大于等于Exec_Master_Log_Pos Relay_Log_File: ddte-relay-bin.000003 Relay_Log_Pos: 251 Relay_Master_Log_File: mysql-bin.000004 Slave_IO_Running: Yes &#x2F;&#x2F;此状态必须YES Slave_SQL_Running: Yes &#x2F;&#x2F;此状态必须YES ……</p><p>注：Slave_IO及Slave_SQL进程必须正常运行，即YES状态，否则都是错误的状态(如：其中一个NO均属错误)。 主从服务器配置完成。 ————— 错误 2017-06-19 06:37:28 2209 [Warning] ‘proxies_priv’ entry ‘@ root@centos-512mb-ams3-02’ ignored in –skip-name-resolve mode. 2017-06-19 06:37:28 2209 [Warning] Neither –relay-log nor –relay-log-index were used; so replication may break when this MySQL server acts as a slave and has his hostname changed!! Please use ‘–relay-log&#x3D;mysql-relay-bin’ to avoid this problem. 2017-06-19 06:37:28 2209 [Warning] Storing MySQL user name or password information in the master info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START SLAVE; see the ‘START SLAVE Syntax’ in the MySQL Manual for more information. 2017-06-19 06:37:28 2209 [Warning] Slave SQL: If a crash happens this configuration does not guarantee that the relay log info will be consistent, Error_code: 0 2017-06-19 06:37:28 2209 [Note] Slave SQL thread initialized, starting replication in log ‘mysql-bin.000020’ at position 82373, relay log ‘.&#x2F;mysql-relay-bin.000002’ position: 283 2017-06-19 06:37:28 2209 [ERROR] Slave SQL: Error ‘Table ‘ba.tc_options’ doesn’t exist’ on query. Default database: ‘ba’. Query: ‘INSERT INTO `tc_options` (`name`, `value`) VALUES (‘cron_sign_again’,’a:2:{s:3:”num”;i:0;s:6:”lastdo”;s:10:”2017-06-18″;}’) ON DUPLICATE KEY UPDATE `value` &#x3D; ‘a:2:{s:3:”num”;i:0;s:6:”lastdo”;s:10:”2017-06-18″;}”, Error_code: 1146</p><p>1、锁定主服务器数据库 mysql&gt; flush tables with read lock; 2、 导出全部数据库 mysqldump -uroot -pxxxx -A &gt; all_database.mysql</p><p>3、从服务器停止slave，情况配置 mysql&gt; stop slave; reset slave; 4、导入数据库 mysql -uroot -pxxxx &lt; all_database.mysql</p><p>5、解锁主服务器数据库mysql&gt; unlock tables;</p><p>6、从数据库查看 show slave status\G</p></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>Jarod</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://jarod.vip/2018/06/29/mysql%E4%B8%BB%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E5%A4%A7%E8%87%B4%E6%95%99%E7%A8%8B/" title="MySQL主从数据库同步大致教程">https://jarod.vip/2018/06/29/mysql主从数据库同步大致教程/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/MySQL/" rel="tag"># MySQL</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2018/06/28/debian%E5%8D%87%E7%BA%A7%E5%88%B0debian8%E3%80%819%E4%B8%80%E9%94%AE%E8%84%9A%E6%9C%AC/" rel="prev" title="Debian升级到debian8、9一键脚本"><i class="fa fa-chevron-left"></i> Debian升级到debian8、9一键脚本</a></div><div class="post-nav-item"><a href="/2018/06/29/%E7%AE%80%E5%8D%95%E4%B8%BAvps%E6%88%96%E8%80%85%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A2%9E%E5%8A%A0swap/" rel="next" title="简单为VPS或者服务器增加SWAP">简单为VPS或者服务器增加SWAP <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Jarod</p><div class="site-description" itemprop="description">记录生活中的点点滴滴</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">258</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">306</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/jarodvip" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jarodvip" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Jarod</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">647k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">9:48</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script></body></html>