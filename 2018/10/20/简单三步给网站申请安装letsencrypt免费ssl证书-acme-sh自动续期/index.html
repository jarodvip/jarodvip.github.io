<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"jarod.vip",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"always",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="昨天晚上花了一个小时的时间把挖站否VPS监控SSL证书由原来的TrustAsia即赛门铁克(Symantec)个人DV SSL证书换成了letsencrypt免费SSL证书，原因是Chrome 70开始将开始不再信任 Symantec证书了，自己正在用的Chromium浏览器已经不能再打开Symantec证书的网站了。 赛门铁克(Symantec)个人DV SSL证书是在腾讯云申请的，实际上国内的"><meta property="og:type" content="article"><meta property="og:title" content="简单三步给网站申请安装letsencrypt免费SSL证书-acme.sh自动续期"><meta property="og:url" content="https://jarod.vip/2018/10/20/%E7%AE%80%E5%8D%95%E4%B8%89%E6%AD%A5%E7%BB%99%E7%BD%91%E7%AB%99%E7%94%B3%E8%AF%B7%E5%AE%89%E8%A3%85letsencrypt%E5%85%8D%E8%B4%B9ssl%E8%AF%81%E4%B9%A6-acme-sh%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F/index.html"><meta property="og:site_name" content="Jarod&#39;s Blog"><meta property="og:description" content="昨天晚上花了一个小时的时间把挖站否VPS监控SSL证书由原来的TrustAsia即赛门铁克(Symantec)个人DV SSL证书换成了letsencrypt免费SSL证书，原因是Chrome 70开始将开始不再信任 Symantec证书了，自己正在用的Chromium浏览器已经不能再打开Symantec证书的网站了。 赛门铁克(Symantec)个人DV SSL证书是在腾讯云申请的，实际上国内的"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/15396999612187d2e20ad1b.jpg"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961197b8ffc25e88.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961258598e4684a7.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/153969996126143bb7e5bbc.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/15396999612225e64847789.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961184b536dc483c.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961531adf860a02c.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961534906ab4cb21.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961547719746a31b.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/15396999616206e31fe7f6a.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961579ab93c65bee.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/1539699961561d925775d3d.gif"><meta property="og:image" content="https://www.jarods.org/wp-content/uploads/2018/10/15396999618600251bd9718.jpg"><meta property="article:published_time" content="2018-10-19T17:03:24.000Z"><meta property="article:modified_time" content="2022-09-29T13:27:45.933Z"><meta property="article:author" content="Jarod"><meta property="article:tag" content="SSL"><meta property="article:tag" content="Letsencrypt"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.jarods.org/wp-content/uploads/2018/10/15396999612187d2e20ad1b.jpg"><link rel="canonical" href="https://jarod.vip/2018/10/20/%E7%AE%80%E5%8D%95%E4%B8%89%E6%AD%A5%E7%BB%99%E7%BD%91%E7%AB%99%E7%94%B3%E8%AF%B7%E5%AE%89%E8%A3%85letsencrypt%E5%85%8D%E8%B4%B9ssl%E8%AF%81%E4%B9%A6-acme-sh%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>简单三步给网站申请安装letsencrypt免费SSL证书-acme.sh自动续期 | Jarod's Blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Jarod's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Jarod's Blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2018/10/20/%E7%AE%80%E5%8D%95%E4%B8%89%E6%AD%A5%E7%BB%99%E7%BD%91%E7%AB%99%E7%94%B3%E8%AF%B7%E5%AE%89%E8%A3%85letsencrypt%E5%85%8D%E8%B4%B9ssl%E8%AF%81%E4%B9%A6-acme-sh%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">简单三步给网站申请安装letsencrypt免费SSL证书-acme.sh自动续期</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-10-20 01:03:24" itemprop="dateCreated datePublished" datetime="2018-10-20T01:03:24+08:00">2018-10-20</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-29 21:27:45" itemprop="dateModified" datetime="2022-09-29T21:27:45+08:00">2022-09-29</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>8.3k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>8 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>昨天晚上花了一个小时的时间把挖站否VPS监控SSL证书由原来的TrustAsia即赛门铁克(Symantec)个人DV SSL证书换成了letsencrypt免费SSL证书，原因是Chrome 70开始将开始不再信任 Symantec证书了，自己正在用的Chromium浏览器已经不能再打开Symantec证书的网站了。</p><p>赛门铁克(Symantec)个人DV SSL证书是在腾讯云申请的，实际上国内的阿里云、七牛云、又拍云等都提供了免费一年赛门铁克(Symantec)个人DV SSL证书。<strong>自己犯了错，干脆把之前的SSL产品趁“打烊”之前清仓大处理了？</strong>这也怪不得赛门铁克(Symantec)在国内搞了这么多的<strong>免费推广</strong>。</p><p>本篇文章就来分享一下利用<strong>acme.sh</strong>来一键申请和安装letsencrypt免费SSL证书，基本上可以适合各大VPS主机服务器，而且acme.sh可以自动更新SSL证书，再也不用担心SSL证书会过期的问题的。从我的个人使用经验来看，官方推荐的Certbot还是不如<strong>acme.sh</strong>好用一些。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/15396999612187d2e20ad1b.jpg"></p><p>更多的VPS主机及SSL证书还可以看看：</p><ol><li>免费SSL证书收集整理汇总-免费给网站添加Https安全加密访问</li><li>CN2 GIA VPS主机收集整理汇总-电信,联通,移动三网CN2 GIA线路VPS主机</li><li>启用HSTS并加入HSTS Preload List让网站Https访问更加安全-附删除HSTS方法</li></ol><p><strong>一、第一步：一键安装acme.sh</strong></p><p>网站：</p><ol><li><a target="_blank" rel="noopener" href="https://letsencrypt.org/">https://letsencrypt.org/</a></li><li><a target="_blank" rel="noopener" href="https://github.com/Neilpang/acme.sh">https://github.com/Neilpang/acme.sh</a></li></ol><p>使用以下可以一键安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://get.acme.sh  sh</span><br></pre></td></tr></table></figure><p>或者:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O - https://get.acme.sh  sh</span><br></pre></td></tr></table></figure><p>使用喜欢Git命令也可以用以下命令安装:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Neilpang/acme.sh.git</span><br><span class="line">cd ./acme.sh</span><br><span class="line">./acme.sh --install</span><br></pre></td></tr></table></figure><p>脚本主要做了以下事情:</p><blockquote><p>1.生成复制了acme.sh 到你的($HOME): ~&#x2F;.acme.sh&#x2F;目录下 ，后面所有的证书都会在这个目录生成.</p><p>2.Create alias for: acme.sh&#x3D;~&#x2F;.acme.sh&#x2F;acme.sh. 注意：<strong>安装完成后你需要关闭再打开终端才可以让alias 生效。</strong></p><p>3.增加了一个定时任务，用于SSL证书更新.</p></blockquote><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961197b8ffc25e88.gif"></p><p>你可以使用Crontab -l来查看当前的定时任务：</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961258598e4684a7.gif"></p><p>同时你也可以使用SFTP来查看acme.sh 文件夹。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/153969996126143bb7e5bbc.gif"></p><p><strong>二、第二步：一键签发SSL证书</strong></p><p>2.1 单个域名SSL</p><p>注意：-w后面是域名的根目录，请根据实际修改.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue -d wzfou.com -w /home/wwwroot/wzfou.com</span><br><span class="line">#默认签发的是RSA，如果你想签发ECC证书，请使用以下命令</span><br><span class="line">acme.sh --issue -d wzfou.com -w /home/wwwroot/wzfou.com --keylength ec-256 </span><br></pre></td></tr></table></figure><p>或者:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue -d wzfou.com -w /home/wzfou/public_html</span><br><span class="line">#默认签发的是RSA，如果你想签发ECC证书，请使用以下命令</span><br><span class="line">acme.sh --issue -d wzfou.com -w /home/wzfou/public_html --keylength ec-256</span><br></pre></td></tr></table></figure><p>或者:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue -d wzfou.com -w /var/www/html</span><br><span class="line">#默认签发的是RSA，如果你想签发ECC证书，请使用以下命令</span><br><span class="line">acme.sh --issue -d wzfou.com -w /var/www/html --keylength ec-256</span><br></pre></td></tr></table></figure><p>2.2 多个域名SSL</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue -d wzfou.com -d www.wzfou.com -d cp.wzfou.com -w /home/wwwroot/wzfou.com</span><br><span class="line">#默认签发的是RSA，如果你想签发ECC证书，请使用以下命令</span><br><span class="line">acme.sh --issue -d wzfou.com -d www.wzfou.com -d cp.wzfou.com -w /home/wwwroot/wzfou.com --keylength ec-256 </span><br></pre></td></tr></table></figure><p>2.3 泛域名SSL</p><p>注意：泛域名SSL证书签发要用到DNS验证的方式，参考2.4部分。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_dp -d wzfou.com -d *.wzfou.com</span><br><span class="line">#默认签发的是RSA，如果你想签发ECC证书，请使用以下命令</span><br><span class="line">acme.sh --issue --dns dns_dp -d wzfou.com -d *.wzfou.com --keylength ec-256</span><br><span class="line">#可选长度有：</span><br><span class="line"> ec-256 (prime256v1, “ECDSA P-256”)</span><br><span class="line"> ec-384 (secp384r1, “ECDSA P-384”)</span><br></pre></td></tr></table></figure><p>2.4 无法验证域名？</p><p>上面通过指定网站根目录的验证域名的方法有时会失效，也有朋友VPS上没有安装Web环境，无法使用80端口。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/15396999612225e64847789.gif"></p><p>这里acme.sh 提供了一个添加DNS API自动验证域名的方式，首先到你的域名DNS处获得API，这里我以NS1 DNS域名解析来作为演示，首先到官网后台获得API（<strong>其它的DNS，如DNSPOD、Cloudxns、阿里云DNS等使用API的方法见本文第四部分</strong>）。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961184b536dc483c.gif"></p><p>然后是导入NS1.com API</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export NS1_Key=&quot;fdmlfxxxxxxxfk&quot;</span><br></pre></td></tr></table></figure><p>现在就可以开始签发SSL证书了:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_nsone -d wzfou.com -d www.wzfou.com</span><br><span class="line">#或者签发ECC证书</span><br><span class="line">acme.sh --issue --dns dns_nsone -d wzfou.com -d www.wzfou.com --keylength ec-256</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961531adf860a02c.gif"></p><p>使用DNS API验证域名的方式有一个好处就是不需要WEB访问就可以签发SSL证书，acme.sh 会在你的DNS域名解析处添加一个TXT记录，验证成功后会自动删除该TXT记录。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961534906ab4cb21.gif"></p><p><strong>三、第三步：安装letsencrypt SSL证书</strong></p><p>这一步部分其实可以根据各自的实际来执行了，为了让acme.sh 可以自动更新续期SSL证书，建议使用以下操作方法来执行，这样acme.sh 每次更新完了SSL证书后都自动按照你第一次安装SSL证书的方法执行一遍同步SSL证书的命令。</p><p><strong>Apache</strong> 服务器安装letsencrypt SSL证书如下：:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --install-cert -d wzfou.com \</span><br><span class="line">--cert-file /path/to/certfile/in/apache/cert.pem \</span><br><span class="line">--key-file /path/to/keyfile/in/apache/key.pem \</span><br><span class="line">--fullchain-file /path/to/fullchain/certfile/apache/fullchain.pem \</span><br><span class="line">--reloadcmd &quot;service apache2 force-reload&quot;</span><br></pre></td></tr></table></figure><p><strong>Nginx</strong> 服务器安装letsencrypt SSL证书e:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --install-cert -d wzfou.com \</span><br><span class="line">--key-file /path/to/keyfile/in/nginx/key.pem \</span><br><span class="line">--fullchain-file /path/to/fullchain/nginx/cert.pem \</span><br><span class="line">--reloadcmd &quot;service nginx force-reload&quot;</span><br></pre></td></tr></table></figure><p>实际操作中，大家根据需要调整好证书和密钥的路径，由于我使用的ECC证书，并且重启Apache2的命令无效，所以我用的以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --install-cert -d ping.wzfou.com --ecc \</span><br><span class="line">--cert-file /etc/pki/tls/certs/ping.wzfou.com.cer \</span><br><span class="line">--key-file /etc/pki/tls/certs/ping.wzfou.com.key \</span><br><span class="line">--fullchain-file /etc/pki/tls/certs/fullchain.cer \</span><br><span class="line">--reloadcmd &quot;/etc/init.d/httpd force-reload&quot;</span><br></pre></td></tr></table></figure><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961547719746a31b.gif"></p><p>执行命令后，我们就可以在路径中看到已经复制过来的证书还有Key等文件了，下次acme.sh 执行更新SSL证书时也会同样执行上述的命令。否则，需要自己手动复制粘贴证书。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/15396999616206e31fe7f6a.gif"></p><p>最后记得到Apache或者Nginx的配置中调整好证书和Key的路径，重启Apache或者Nginx就算完成了。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961579ab93c65bee.gif"></p><p>如果你发现letsencrypt SSL证书不能定时更新，你也可以自己手动强制更新:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --renew -d example.com --force</span><br></pre></td></tr></table></figure><p>如果是ECC cert，使用以下命令:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --renew -d example.com --force --ecc</span><br></pre></td></tr></table></figure><p>目前wzfou.com用的就是letsencrypt SSL证书。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/1539699961561d925775d3d.gif"></p><p><strong>四、附录：各大DNS API获取与签发SSL</strong></p><p><strong>说明</strong>：</p><ol><li>附录参考自：<a target="_blank" rel="noopener" href="https://github.com/Neilpang/acme.sh/blob/master/dnsapi/README.md">https://github.com/Neilpang/acme.sh/blob/master/dnsapi/README.md</a></li><li>DNS解析服务汇总：<a target="_blank" rel="noopener" href="https://wzfou.com/mianfei-dns/">https://wzfou.com/mianfei-dns/</a></li><li>签发泛域名SSL时请把命令部分：-d <a target="_blank" rel="noopener" href="http://www.example.com/">www.example.com</a> 改成 ：-d *.example.com</li></ol><p><strong>4.1 CloudFlare DNS API</strong></p><p>First you need to login to your CloudFlare account to get your API key.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export CF_Key=&quot;sdfsdfsdfljlbjkljlkjsdfoiwje&quot;</span><br><span class="line">export CF_Email=&quot;xxxx@sss.com&quot;</span><br></pre></td></tr></table></figure><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_cf -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The CF_Key and CF_Email will be saved in ~&#x2F;.acme.sh&#x2F;account.conf and will be reused when needed.</p><p><strong>4.2 DNSPod DNS API</strong></p><p>First you need to login to your DNSPod account to get your API Key and ID.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export DP_Id=&quot;1234&quot;</span><br><span class="line">export DP_Key=&quot;sADDsdasdgdsf&quot;</span><br></pre></td></tr></table></figure><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_dp -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The DP_Id and DP_Key will be saved in ~&#x2F;.acme.sh&#x2F;account.conf and will be reused when needed.</p><p><strong>4.3 CloudXNS DNS API</strong></p><p>First you need to login to your CloudXNS account to get your API Key and Secret.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export CX_Key=&quot;1234&quot;</span><br><span class="line">export CX_Secret=&quot;sADDsdasdgdsf&quot;</span><br></pre></td></tr></table></figure><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_cx -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The CX_Key and CX_Secret will be saved in ~&#x2F;.acme.sh&#x2F;account.conf and will be reused when needed.</p><p><strong>4.4 阿里云Aliyun DNS API</strong></p><p>First you need to login to your 阿里云 Aliyun account to get your API key. <a target="_blank" rel="noopener" href="https://ak-console.aliyun.com/#/accesskey">https://ak-console.aliyun.com/#/accesskey</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export Ali_Key=&quot;sdfsdfsdfljlbjkljlkjsdfoiwje&quot;</span><br><span class="line">export Ali_Secret=&quot;jlsdflanljkljlfdsaklkjflsa&quot;</span><br></pre></td></tr></table></figure><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_ali -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The Ali_Key and Ali_Secret will be saved in ~&#x2F;.acme.sh&#x2F;account.conf and will be reused when needed.</p><p><strong>4.5 GoDaddy DNS API</strong></p><p>First you need to login to your GoDaddy account to get your API Key and Secret. <a target="_blank" rel="noopener" href="https://developer.godaddy.com/keys/">https://developer.godaddy.com/keys/</a></p><p>Please create a Production key, instead of a Test key.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export GD_Key=&quot;sdfsdfsdfljlbjkljlkjsdfoiwje&quot;</span><br><span class="line">export GD_Secret=&quot;asdfsdafdsfdsfdsfdsfdsafd&quot;</span><br></pre></td></tr></table></figure><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_gd -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The GD_Key and GD_Secret will be saved in ~&#x2F;.acme.sh&#x2F;account.conf and will be reused when needed.</p><p><strong>4.6 PowerDNS DNS API</strong></p><p>First you need to login to your PowerDNS account to enable the API and set your API-Token in the configuration. <a target="_blank" rel="noopener" href="https://doc.powerdns.com/md/httpapi/README/">https://doc.powerdns.com/md/httpapi/README/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export PDNS_Url=&quot;http://ns.example.com:8081&quot;</span><br><span class="line">export PDNS_ServerId=&quot;localhost&quot;</span><br><span class="line">export PDNS_Token=&quot;0123456789ABCDEF&quot;</span><br><span class="line">export PDNS_Ttl=60</span><br></pre></td></tr></table></figure><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_pdns -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The PDNS_Url, PDNS_ServerId, PDNS_Token and PDNS_Ttl will be saved in ~&#x2F;.acme.sh&#x2F;account.confand will be reused when needed.</p><p><strong>4.7 Amazon Route53 DNS API</strong></p><p>方法见：<a target="_blank" rel="noopener" href="https://github.com/Neilpang/acme.sh/wiki/How-to-use-Amazon-Route53-API">https://github.com/Neilpang/acme.sh/wiki/How-to-use-Amazon-Route53-API</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export AWS_ACCESS_KEY_ID=XXXXXXXXXX</span><br><span class="line">export AWS_SECRET_ACCESS_KEY=XXXXXXXXXXXXXXX</span><br></pre></td></tr></table></figure><p>To issue a cert:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_aws -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY will be saved in ~&#x2F;.acme.sh&#x2F;account.conf and will be reused when needed.</p><p><strong>4.8 Linode DNS API</strong></p><p>First you need to login to your Linode account to get your API Key. <a target="_blank" rel="noopener" href="https://manager.linode.com/profile/api">https://manager.linode.com/profile/api</a></p><p>Then add an API key with label <em>ACME</em> and copy the new key.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LINODE_API_KEY=&quot;...&quot;</span><br></pre></td></tr></table></figure><p>Due to the reload time of any changes in the DNS records, we have to use the dnssleep option to wait at least 15 minutes for the changes to take effect.</p><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_linode --dnssleep 900 -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p>The LINODE_API_KEY will be saved in ~&#x2F;.acme.sh&#x2F;account.conf and will be reused when needed.</p><p><strong>4.9 DigitalOcean DNS API (native)</strong></p><p>You need to obtain a read and write capable API key from your DigitalOcean account. See: <a target="_blank" rel="noopener" href="https://www.digitalocean.com/help/api/">https://www.digitalocean.com/help/api/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export DO_API_KEY=&quot;75310dc4ca779ac39a19f6355db573b49ce92ae126553ebd61ac3a3ae34834cc&quot;</span><br></pre></td></tr></table></figure><p>Ok, let’s issue a cert now:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_dgon -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p><strong>4.10 Namesilo DNS API</strong></p><p>You’ll need to generate an API key at <a target="_blank" rel="noopener" href="https://www.namesilo.com/account/_api.php">https://www.namesilo.com/account\_api.php</a> Optionally you may restrict the access to an IP range there.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export Namesilo_Key=&quot;xxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><br></pre></td></tr></table></figure><p>And now you can issue certs with:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_namesilo --dnssleep 900 -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p><strong>4.11 使用自定义API</strong></p><p>If your API is not supported yet, you can write your own DNS API.</p><p>Let’s assume you want to name it ‘myapi’:</p><ol><li>Create a bash script named ~&#x2F;.acme.sh&#x2F;dns_myapi.sh,</li><li>In the script you must have a function named dns_myapi_add() which will be called by acme.sh to add the DNS records.</li><li>Then you can use your API to issue cert like this:</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue --dns dns_myapi -d example.com -d www.example.com</span><br></pre></td></tr></table></figure><p><strong>五、总结</strong></p><p>letsencrypt免费SSL证书申请与安装过程还是挺简单的，只需要一个VPS主机，不管有没有安装Web环境都可以签发SSL证书，个人觉得DNS验证方式是最方便的。</p><p><img src="https://www.jarods.org/wp-content/uploads/2018/10/15396999618600251bd9718.jpg"></p><p>没有VPS主机的同学该如何使用letsencrypt免费SSL证书呢？<strong>方法一：</strong>手动在线申请，三个在线免费SSL证书申请地址; <strong>方法二：</strong>直接用Cpanel、DirectAdmin面板自带的SSL申请。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>Jarod</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://jarod.vip/2018/10/20/%E7%AE%80%E5%8D%95%E4%B8%89%E6%AD%A5%E7%BB%99%E7%BD%91%E7%AB%99%E7%94%B3%E8%AF%B7%E5%AE%89%E8%A3%85letsencrypt%E5%85%8D%E8%B4%B9ssl%E8%AF%81%E4%B9%A6-acme-sh%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F/" title="简单三步给网站申请安装letsencrypt免费SSL证书-acme.sh自动续期">https://jarod.vip/2018/10/20/简单三步给网站申请安装letsencrypt免费ssl证书-acme-sh自动续期/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/SSL/" rel="tag"># SSL</a> <a href="/tags/Letsencrypt/" rel="tag"># Letsencrypt</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2018/10/19/%E4%BD%BF%E7%94%A8overture%E6%90%AD%E5%BB%BA%E6%94%AF%E6%8C%81edns%E7%9A%84%E7%A7%81%E4%BA%BAdns/" rel="prev" title="使用Overture搭建支持EDNS的私人DNS"><i class="fa fa-chevron-left"></i> 使用Overture搭建支持EDNS的私人DNS</a></div><div class="post-nav-item"><a href="/2018/10/23/proxmox%E7%BB%88%E6%9E%81%E6%95%99%E7%A8%8B-%E6%89%93%E9%80%A0%E7%BA%AFipv6%E8%99%9A%E6%8B%9F%E6%9C%BA-%E7%8B%AC%E7%AB%8Bip%E8%99%9A%E6%8B%9F%E6%9C%BA-proxmox%E9%9B%86%E7%BE%A4/" rel="next" title="Proxmox终极教程/打造纯IPV6虚拟机/独立IP虚拟机/proxmox集群/">Proxmox终极教程/打造纯IPV6虚拟机/独立IP虚拟机/proxmox集群/ <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let t=CONFIG.comments["activeClass"];var e;(t=CONFIG.comments.storage?localStorage.getItem("comments_active")||t:t)&&(e=document.querySelector(`a[href="#comment-${t}"]`))&&e.click()}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Jarod</p><div class="site-description" itemprop="description">记录生活中的点点滴滴</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">258</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">306</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/jarodvip" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jarodvip" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Jarod</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">647k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">9:48</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script></body></html>