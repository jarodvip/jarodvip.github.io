<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"jarod.vip","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script><meta name="description" content="Table of Contents  一、Ubuntu 16.04搭建方法 1.系统软硬件要求 2.配置DNS 3.系统环境的设置 4.下载并安装软件包 5.选择安装组件 6, 配置Zimbra 7.配置SSL   二、CentOS 7的搭建方法 安装要求 开始 域名解析 反向DNS解析 关闭sendmail或postfix服务，避免25端口被占用 关闭selinux 防火墙 配置主机名HOSTN"><meta property="og:type" content="article"><meta property="og:title" content="搭建高大上的Zimbra办公与邮件服务系统"><meta property="og:url" content="https://jarod.vip/2018/10/18/%E6%90%AD%E5%BB%BA%E9%AB%98%E5%A4%A7%E4%B8%8A%E7%9A%84zimbra%E5%8A%9E%E5%85%AC%E4%B8%8E%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F/index.html"><meta property="og:site_name" content="Jarod&#39;s Blog"><meta property="og:description" content="Table of Contents  一、Ubuntu 16.04搭建方法 1.系统软硬件要求 2.配置DNS 3.系统环境的设置 4.下载并安装软件包 5.选择安装组件 6, 配置Zimbra 7.配置SSL   二、CentOS 7的搭建方法 安装要求 开始 域名解析 反向DNS解析 关闭sendmail或postfix服务，避免25端口被占用 关闭selinux 防火墙 配置主机名HOSTN"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-10-18T03:59:08.000Z"><meta property="article:modified_time" content="2025-12-28T07:54:18.479Z"><meta property="article:author" content="Jarod"><meta property="article:tag" content="Zimbra"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://jarod.vip/2018/10/18/%E6%90%AD%E5%BB%BA%E9%AB%98%E5%A4%A7%E4%B8%8A%E7%9A%84zimbra%E5%8A%9E%E5%85%AC%E4%B8%8E%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://jarod.vip/2018/10/18/%E6%90%AD%E5%BB%BA%E9%AB%98%E5%A4%A7%E4%B8%8A%E7%9A%84zimbra%E5%8A%9E%E5%85%AC%E4%B8%8E%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F/","path":"2018/10/18/搭建高大上的zimbra办公与邮件服务系统/","title":"搭建高大上的Zimbra办公与邮件服务系统"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>搭建高大上的Zimbra办公与邮件服务系统 | Jarod's Blog</title><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script><script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="Jarod's Blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Jarod's Blog</p><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81Ubuntu-16-04%E6%90%AD%E5%BB%BA%E6%96%B9%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">一、Ubuntu 16.04搭建方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E7%B3%BB%E7%BB%9F%E8%BD%AF%E7%A1%AC%E4%BB%B6%E8%A6%81%E6%B1%82"><span class="nav-number">1.1.</span> <span class="nav-text">1.系统软硬件要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AEDNS"><span class="nav-number">1.2.</span> <span class="nav-text">2.配置DNS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.3.</span> <span class="nav-text">3.系统环境的设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E4%B8%8B%E8%BD%BD%E5%B9%B6%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="nav-number">1.4.</span> <span class="nav-text">4.下载并安装软件包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E9%80%89%E6%8B%A9%E5%AE%89%E8%A3%85%E7%BB%84%E4%BB%B6"><span class="nav-number">1.5.</span> <span class="nav-text">5.选择安装组件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E9%85%8D%E7%BD%AEZimbra"><span class="nav-number">1.6.</span> <span class="nav-text">6, 配置Zimbra</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E9%85%8D%E7%BD%AESSL"><span class="nav-number">1.7.</span> <span class="nav-text">7.配置SSL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81CentOS-7%E7%9A%84%E6%90%AD%E5%BB%BA%E6%96%B9%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">二、CentOS 7的搭建方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E8%A6%81%E6%B1%82"><span class="nav-number">2.1.</span> <span class="nav-text">安装要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B"><span class="nav-number">2.2.</span> <span class="nav-text">开始</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="nav-number">2.2.1.</span> <span class="nav-text">域名解析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E5%90%91DNS%E8%A7%A3%E6%9E%90"><span class="nav-number">2.2.2.</span> <span class="nav-text">反向DNS解析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%ADsendmail%E6%88%96postfix%E6%9C%8D%E5%8A%A1%EF%BC%8C%E9%81%BF%E5%85%8D25%E7%AB%AF%E5%8F%A3%E8%A2%AB%E5%8D%A0%E7%94%A8"><span class="nav-number">2.2.3.</span> <span class="nav-text">关闭sendmail或postfix服务，避免25端口被占用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%ADselinux"><span class="nav-number">2.2.4.</span> <span class="nav-text">关闭selinux</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">2.2.5.</span> <span class="nav-text">防火墙</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%B8%BB%E6%9C%BA%E5%90%8DHOSTNAME"><span class="nav-number">2.2.6.</span> <span class="nav-text">配置主机名HOSTNAME</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEHOSTS"><span class="nav-number">2.2.7.</span> <span class="nav-text">配置HOSTS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NTP"><span class="nav-number">2.2.8.</span> <span class="nav-text">NTP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%8C%85-wiki"><span class="nav-number">2.2.9.</span> <span class="nav-text">安装依赖包 wiki</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8"><span class="nav-number">2.2.10.</span> <span class="nav-text">安装及使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SPF"><span class="nav-number">2.2.11.</span> <span class="nav-text">SPF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DKIM"><span class="nav-number">2.2.12.</span> <span class="nav-text">DKIM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DMARC"><span class="nav-number">2.2.13.</span> <span class="nav-text">DMARC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E8%AE%B0%E5%BD%95"><span class="nav-number">2.2.14.</span> <span class="nav-text">域名解析记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81DKIM"><span class="nav-number">2.2.15.</span> <span class="nav-text">验证DKIM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E6%96%B0%E7%AD%BE%E5%8F%91%E8%AF%81%E4%B9%A6"><span class="nav-number">2.2.16.</span> <span class="nav-text">重新签发证书</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E4%BB%A5%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%86%85%E5%AE%B9"><span class="nav-number">2.2.17.</span> <span class="nav-text">可以学习的内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E5%B7%A5%E5%85%B7"><span class="nav-number">2.2.18.</span> <span class="nav-text">小工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="nav-number">2.2.19.</span> <span class="nav-text">参考文章</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Jarod</p><div class="site-description" itemprop="description">记录生活中的点点滴滴</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">299</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></div><div class="site-state-item site-state-tags"><span class="site-state-item-count">345</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/jarodvip" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jarodvip" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://jarod.vip/2018/10/18/%E6%90%AD%E5%BB%BA%E9%AB%98%E5%A4%A7%E4%B8%8A%E7%9A%84zimbra%E5%8A%9E%E5%85%AC%E4%B8%8E%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Jarod"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jarod's Blog"><meta itemprop="description" content="记录生活中的点点滴滴"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="搭建高大上的Zimbra办公与邮件服务系统 | Jarod's Blog"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">搭建高大上的Zimbra办公与邮件服务系统</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-10-18 11:59:08" itemprop="dateCreated datePublished" datetime="2018-10-18T11:59:08+08:00">2018-10-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-12-28 15:54:18" itemprop="dateModified" datetime="2025-12-28T15:54:18+08:00">2025-12-28</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">Linux教程</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>14k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>13 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Table of Contents</p><ul><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#Ubuntu_1604" title="一、Ubuntu 16.04搭建方法">一、Ubuntu 16.04搭建方法</a><ul><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#1" title="1.系统软硬件要求">1.系统软硬件要求</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#2DNS" title="2.配置DNS">2.配置DNS</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#3" title="3.系统环境的设置">3.系统环境的设置</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#4" title="4.下载并安装软件包">4.下载并安装软件包</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#5" title="5.选择安装组件">5.选择安装组件</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#6_Zimbra" title="6, 配置Zimbra">6, 配置Zimbra</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#7SSL" title="7.配置SSL">7.配置SSL</a></li></ul></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#CentOS_7" title="二、CentOS 7的搭建方法">二、CentOS 7的搭建方法</a><ul><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i" title="安装要求">安装要求</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-2" title="开始">开始</a><ul><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-3" title="域名解析">域名解析</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#DNS" title="反向DNS解析">反向DNS解析</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#sendmailpostfix25" title="关闭sendmail或postfix服务，避免25端口被占用">关闭sendmail或postfix服务，避免25端口被占用</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#selinux" title="关闭selinux">关闭selinux</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-4" title="防火墙">防火墙</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#HOSTNAME" title="配置主机名HOSTNAME">配置主机名HOSTNAME</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#HOSTS" title="配置HOSTS">配置HOSTS</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#NTP" title="NTP">NTP</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#_wiki" title="安装依赖包 wiki">安装依赖包 wiki</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-5" title="安装及使用">安装及使用</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#SPF" title="SPF">SPF</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#DKIM" title="DKIM">DKIM</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#DMARC" title="DMARC">DMARC</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-6" title="域名解析记录">域名解析记录</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#DKIM-2" title="验证DKIM">验证DKIM</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-7" title="重新签发证书">重新签发证书</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-8" title="可以学习的内容">可以学习的内容</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-9" title="小工具">小工具</a></li><li><a target="_blank" rel="noopener" href="https://www.zrj96.com/post-884.html#i-10" title="参考文章">参考文章</a></li></ul></li></ul></li></ul><h1 id="一、Ubuntu-16-04搭建方法"><a href="#一、Ubuntu-16-04搭建方法" class="headerlink" title="一、Ubuntu 16.04搭建方法"></a>一、Ubuntu 16.04搭建方法</h1><p>Zimbra是著名的开源系统，它一体化地提供了邮件收发、文件共享、协同办公、即时聊天等一系列解决方案，是开源软件中的精品。它拥有美观大气的使用界面，以及非常实用的功能。作为邮件服务器系统，Zimbra更是凭借卓越的稳定性和功能当之无愧地成为开源邮件服务器系统的首选，适合各类型&#x2F;人数的用户群，尤其适合团队使用。之前我们写过一个简单的Zimbra邮件服务器安装的教程，然而那篇文章写于五年前，对于现在的版本已经不再适用。正好由于前天，Online.net服务器大幅提价，我们不得不迁移之前的服务器，于是需要在新的系统上重新搭建一次Zimbra. 因此，我们这里凭借这个机会再介绍一下如何安装与配置独立的Zimbra开源办公与邮件服务系统，希望对大家有所帮助。多台服务器协同部署的步骤这里不做太多介绍。</p><h2 id="1-系统软硬件要求"><a href="#1-系统软硬件要求" class="headerlink" title="1.系统软硬件要求"></a>1.系统软硬件要求</h2><p>Zimbra的体量较大，因此对于系统环境的要求较高。首先，系统必须为64位。目前，Zimbra支持的操作系统包括：CentOS 6, CentOS 7, Ubuntu 14.04 LTS, Ubuntu 16.04 LTS, Red Hat Linux 6&#x2F;7, 以及Oracle Linux 6&#x2F;7. 关于硬件需求，首先，内存需要8 GB或者以上，建议16 GB. 系统的硬盘占用约为8 GB左右，视自己的需要而定。CPU和其他硬件没有特别需求，但是Zimbra官方说明中有提到，<strong>强烈不建议在RAID 5 (包括50)的服务器上搭建Zimbra</strong>. 如果您有类似的服务器，建议更改RAID模式，避免RAID 5或者50. 鉴于Zimbra的体量，我们不建议在VPS上安装Zimbra, 而最好是在一台独立服务器上安装。本文的操作环境为Ubuntu 16.04 LTS 64bit.</p><h2 id="2-配置DNS"><a href="#2-配置DNS" class="headerlink" title="2.配置DNS"></a>2.配置DNS</h2><p>我们简要说明一下一个最简单的zimbra邮件服务器的DNS配置需求。 如果以qing.su域名为例，我们将域名本身qing.su以A记录解析到任意IP, 然后将邮件服务器的hostname, 比如mx.qing.su以A记录解析到我们将要搭建的邮件服务器的IP上。 然后，我们分别将qing.su与mx.qing.su以MX记录解析到mx.qing.su, 优先级可以为任意值。 如果需要用web访问邮箱，可以将mail.qing.su解析到邮件服务器的IP上。 其他记录的设置，比如TXT, SRV等，可以后期根据自己的需要来自行配制。</p><h2 id="3-系统环境的设置"><a href="#3-系统环境的设置" class="headerlink" title="3.系统环境的设置"></a>3.系统环境的设置</h2><p>毫无疑问，对于任何邮件服务器来说，最重要的前提步骤是正确设置服务器的hostname. 如何正确设置服务器的hostname我们已经强调过多次。我们以mx.example.com为例，当在SSH中执行hostname命令时，应当看到的回显为短主机名，即mx; 而在SSH中执行hostname -f命令时，应当看到的回显为长主机名(FQDN), 即mx.example.com. 若hostname没有正确设置好，请不要继续。 然后，我们用root账户登录SSH, 即可开始安装。(不要sudo, 请直接su到root, 否则会出错)</p><h2 id="4-下载并安装软件包"><a href="#4-下载并安装软件包" class="headerlink" title="4.下载并安装软件包"></a>4.下载并安装软件包</h2><p>Zimbra各系统软件包的下载地址如下：<a target="_blank" rel="noopener" href="https://www.zimbra.com/downloads/zimbra-collaboration-open-source/">https://www.zimbra.com/downloads/zimbra-collaboration-open-source/</a> 请按照自己的需求下载。我们这里以Ubuntu 16.04为例。执行： <code>apt-get update &amp;&amp; apt-get upgrade cd /tmp wget https://files.zimbra.com/downloads/8.8.9_GA/zcs-8.8.9_GA_2055.UBUNTU16_64.20180703080917.tgz tar xvzf *.tgz rm -f zcs*.tgz cd zcs* ./install.sh</code></p><h2 id="5-选择安装组件"><a href="#5-选择安装组件" class="headerlink" title="5.选择安装组件"></a>5.选择安装组件</h2><p>正确执行上述步骤后，首先会提示是否同意用户协议，选择Y即可。 <code>Do you agree with the terms of the https://qing.su software license agreement? [N] Y</code> 然后会提示选择需要安装的组件，如果您不是特别了解的话可以直接选择默认选项。 <code>Use Zimbra&#39;s package repository [Y] Install zimbra-ldap [Y] Install zimbra-logger [Y] Install zimbra-mta [Y] Install zimbra-dnscache [Y] Install zimbra-snmp [Y] Install zimbra-store [Y] Install zimbra-apache [Y] Install https://qing.su[Y] Install zimbra-spell [Y] Install zimbra-memcached [Y] Install zimbra-proxy [Y] Install zimbra-drive [Y] Install zimbra-imapd (BETA - for evaluation only) [N] Install zimbra-chat [Y]</code> 最后，系统会提示是否确认更改，我们需要选择Y。 <code>The system will be modified.  Continue? [N] Y</code> 至此，系统将会下载必要的安装包并自动安装。</p><h2 id="6-配置Zimbra"><a href="#6-配置Zimbra" class="headerlink" title="6, 配置Zimbra"></a>6, 配置Zimbra</h2><p>安装完毕后，系统会弹出命令行菜单，如下面这样： <code>Main menu 1) Common Configuration: 2) zimbra-ldap: Enabled 3) zimbra-logger: Enabled 4) zimbra-mta: Enabled 5) zimbra-dnscache: Enabled 6) zimbra-snmp: Enabled 7) zimbra-store: Enabled +Create Admin User: yes +Admin user to create: admin@mx.example.com ******* +Admin Password UNSET +Anti-virus quarantine user: virus-quarantine.6zk4_0qy@mx.example.com +Enable automated spam training: yes +Spam training user: spam.zc3z28w0@mx.example.com +Non-spam(Ham) training user: ham.bkojeqoiq@mx.example.com +SMTP host: mx.example.com +Web server HTTP port: 8080 +Web server HTTPS port: 8443 +Web server mode: https +IMAP server port: 7143 +IMAP server SSL port: 7993 +POP server port: 7110 +POP server SSL port: 7995 +Use spell check server: yes +Spell server URL: http://mx.example.com:7780/aspell.php +Enable version update checks: TRUE +Enable version update notifications: TRUE +Version update notification email: admin@mx.example.com +Version update source email: admin@mx.example.com +Install mailstore (service webapp): yes +Install UI (zimbra,zimbraAdmin webapps): yes 8) zimbra-spell: Enabled 9) zimbra-proxy: Enabled 10) Default Class of Service Configuration: s) Save config to file x) Expand menu q) Quit Address unconfigured (**) items (? - help) 7</code> 这里我们选择7,  进入Store configuration, 并在下一步选择4, 设置管理员密码。 <code>Store configuration 1) Status:                                  Enabled 2) Create Admin User:                       yes 3) Admin user to create:                    admin@mx.example.com ** 4) Admin Password                           UNSET 5) Anti-virus quarantine user:              virus-quarantine.6zk4_0qy@mx.example.com 6) Enable automated spam training:          yes 7) Spam training user:                      spam.zc3z28w0@mx.example.com 8) Non-spam(Ham) training user:             ham.bkojeqoiq@mx.example.com 9) SMTP host:                               mx.example.com 10) Web server HTTP port:                    8080 11) Web server HTTPS port:                   8443 12) Web server mode:                         https 13) IMAP server port:                        7143 14) IMAP server SSL port:                    7993 15) POP server port:                         7110 16) POP server SSL port:                     7995 17) Use spell check server:                  yes 18) Spell server URL:                        http://mx.example.com:7780/aspell.php 19) Enable version update checks:            TRUE 20) Enable version update notifications:     TRUE 21) Version update notification email:       admin@mx.example.com 22) Version update source email:             admin@mx.example.com 23) Install mailstore (service webapp):      yes 24) Install UI (zimbra,zimbraAdmin webapps): yes Select, or &#39;r&#39; for previous menu [r]</code> 如果有其他选项您希望更改的，也可以一并更改（但是不建议更改端口地址）。更改完毕后，输入r返回上级菜单，然后输入a让更改生效并将配置写入至文件。 <code>*** CONFIGURATION COMPLETE - press &#39;a&#39; to apply Select from menu, or press &#39;a&#39; to apply config (? - help) a Save configuration data to a file? [Yes] Save config in file: [/opt/zimbra/config.11819] Saving config in /opt/zimbra/config.11819...done. The system will be modified - continue? [No] Yes</code> 要忘记最后要输入Yes来保存更改。几秒钟之后，系统就配置完毕。至此，Zimbra安装完毕，我们可以登录后台添加域名、添加用户等进行一系列的管理了。</p><h2 id="7-配置SSL"><a href="#7-配置SSL" class="headerlink" title="7.配置SSL"></a>7.配置SSL</h2><p>安装完毕Zimbra以后，我们就可以通过<a href="https://mx.example.com:7071登录后台，进行管理。此时，SSL证书还没有配置好，我们需要配置SSL">https://mx.example.com:7071登录后台，进行管理。此时，SSL证书还没有配置好，我们需要配置SSL</a>, 否则浏览器会一直报错。点击界面下方Get Started –&gt; Install Certificates, 选择Next然后选择Generate the CSR for the commercial certificate authorizer, 然后在弹出来的界面中生成CSR. 我们需要将主域名mx.example.com填在Common Name中，然后在Subjective Alternative Name中添加需要一并生成证书的其他域名，比如example.com, <a target="_blank" rel="noopener" href="http://www.example.com/">www.example.com</a>, mail.example.com等。点击Next即可生成证书CSR. 有了CSR之后，我们即可申请证书了。Zimbra配置证书的过程比较tricky, 经常会报错，特别是如果在网页后台安装证书时报错的原因很不清晰，导致无法分析错误发生的原因。因此，我们一般选择在SSH中使用命令行的方式安装证书。下面我们以Let’s Encrypt为例安装证书，其他的商业证书的安装较为简单，这里就不再重复。 我们用SSH登录服务器，然后su切换至root. 首先，我们将刚才的CSR保存至&#x2F;tmp&#x2F;mx.example.com.csr文件。然后，安装certbot, 签发Let’s Encrypt证书。 <code>apt-get install software-properties-common add-apt-repository ppa:certbot/certbot apt-get update apt-get install certbot</code> 这里有一个小技巧，通常我们签发Let’s Encrypt证书的时候是让它自己生成私钥和CSR的，但是在需要的时候，certbot可以根据已有的CSR来签发证书，只需使用–csr参数即可。因此，我们基于刚刚生成的CSR来签发证书。 <code>certbot certonly --standalone --csr /tmp/mx.example.com.csr</code> 签发的证书和链文件位于&#x2F;tmp目录内。需要注意的是，Certbot生成的中间链会在Zimbra中校验失败，我们需要下载额外的Root CA和中间链证书。 <code>wget https://letsencrypt.org/certs/isrgrootx1.pem.txt -O ca.crt wget https://letsencrypt.org/certs/letsencryptauthorityx3.pem.txt -O ca_intermediary.crt</code> 然后再整理、合并一下证书： <code>mv 0000_cert.pem commercial.crt cat /tmp/ca_intermediary.crt /tmp/ca.crt &gt; /tmp/ca_chain.crt</code> 现在就可以开始签发安装证书了。安装证书需要使用zimbra用户，这是在安装Zimbra的时候新建的内置用户。 <code>su zimbra</code> 安装之前，我们先验证一下证书。执行 <code>/opt/zimbra/bin/zmcertmgr verifycrt comm /opt/zimbra/ssl/zimbra/commercial/commercial.key /tmp/commercial.crt /tmp/ca_chain.crt</code> 如果看到类似于下面的回显，说明合格了。如果报错，大概率是因为Root CA和中间链哪里没有弄对，请仔细检查后再试。 <code>** Verifying &#39;/tmp/commercial.crt&#39; against &#39;/opt/zimbra/ssl/zimbra/commercial/commercial.key&#39; **Tutorial written by https://qing.su** Certificate &#39;/tmp/commercial.crt&#39; and private key &#39;/opt/zimbra/ssl/zimbra/commercial/commercial.key&#39; match. ** Verifying &#39;/tmp/commercial.crt&#39; against &#39;/tmp/ca_chain.crt&#39; Valid certificate chain: /tmp/commercial.crt: OK</code> 证书验证完毕后，执行下面的命令安装并检验： <code>/opt/zimbra/bin/zmcertmgr deploycrt comm /tmp/commercial.crt /tmp/ca_chain.crt /opt/zimbra/bin/zmcertmgr viewdeployedcrt</code> 最后，我们要重启zimbra服务器，让证书生效。 <code>exit service zimbra restart</code> 再次登录<a target="_blank" rel="noopener" href="https://mx.example.com:7071/">https://mx.example.com:7071</a>, 已经可以看到证书生效了。 至此，Zimbra服务器安装完毕并成功配置了SSL证书。在添加好相应的域名之后，即可使用相关用户名和密码登录<a target="_blank" rel="noopener" href="https://mail.example.com来登录邮箱,界面非常美观大气.可以看到,在邮箱右下角还有聊天窗口,可以和同一个工作组内的伙伴实时通讯并传输文件./">https://mail.example.com来登录邮箱，界面非常美观大气。可以看到，在邮箱右下角还有聊天窗口，可以和同一个工作组内的伙伴实时通讯并传输文件。</a></p><h1 id="二、CentOS-7的搭建方法"><a href="#二、CentOS-7的搭建方法" class="headerlink" title="二、CentOS 7的搭建方法"></a>二、CentOS 7的搭建方法</h1><h2 id="安装要求"><a href="#安装要求" class="headerlink" title="安装要求"></a>安装要求</h2><p>1、64位服务器并能设置反向DNS解析（zimbra新版不支持32位操作系统） 2、磁盘空间≥5GB（zimbra默认安装位置&#x2F;opt 请确保磁盘空间足够 可以挂载到新磁盘） 3、内存≥4GB（编译对内存要求较高，内存小的用户可以设置swap来缓解内存压力） 4、域名一枚</p><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><h3 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h3><p>zimbra在线安装时要检查MX 安装之前配置好dns MX解析并确认已生效 未生效安装过程会终止 假如&gt;&gt; 邮件服务器IP：138.68.227.28 邮件服务器采用的域名：mail.example.com 对外发送和接收邮件的域名：example.com</p><p>mail.example.com. IN A 138.68.227.28</p><p>example.com. IN MX 10 mail.example.com.</p><h3 id="反向DNS解析"><a href="#反向DNS解析" class="headerlink" title="反向DNS解析"></a>反向DNS解析</h3><p>反向解析由主机商提供（有些面板可以设置，不行提交工单） 主要用于发件，确认邮件来源的有效性。 命令查看反向解析是否生效：<code>nslookup -qt=ptr 138.68.227.28</code> 返回指向mail.example.com则成功</p><h3 id="关闭sendmail或postfix服务，避免25端口被占用"><a href="#关闭sendmail或postfix服务，避免25端口被占用" class="headerlink" title="关闭sendmail或postfix服务，避免25端口被占用"></a>关闭sendmail或postfix服务，避免25端口被占用</h3><p># centos 6</p><p>&#x2F;etc&#x2F;init.d&#x2F;sendmail stop &amp;&amp; chkconfig sendmail off</p><p>&#x2F;etc&#x2F;init.d&#x2F;postfix stop &amp;&amp; chkconfig postfix off</p><p># centos 7</p><p>systemctl stop postfix &amp;&amp; yum erase postfix</p><p>systemctl stop sendmail &amp;&amp; systemctl disable sendmail</p><h3 id="关闭selinux"><a href="#关闭selinux" class="headerlink" title="关闭selinux"></a><a target="_blank" rel="noopener" href="https://www.zephyr.vip/204">关闭selinux</a></h3><h3 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a><strong>防火墙</strong></h3><p>根据自已需求选择要不要关闭，也可以选用设置防火墙规则 <strong>关闭防火墙功能</strong></p><p># centos 6</p><p>service iptables stop &amp;&amp; chkconfig iptables off</p><p># centos 7</p><p>systemctl stop firewalld.service &amp;&amp; systemctl disable firewalld.service</p><p><strong>添加防火墙规则 开放端口</strong></p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 80 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 443 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 7071 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 8087 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 8080 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 8443 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 25 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 110 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 143 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 993 –j ACCEPT</p><p>–A INPUT –m state —state NEW –m tcp –p tcp —dport 995 –j ACCEPT</p><p># iptables -F</p><p># iptables -P INPUT DROP</p><p># iptables -P OUTPUT ACCEPT</p><p># iptables -A INPUT -i lo -j ACCEPT</p><p># iptables -A INPUT -s IP-Address-of-your-server&#x2F;32 -j ACCEPT</p><p># iptables -A INPUT -m state –state ESTABLISHED,RELATED -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 22 -j ACCEPT</p><p># iptables -A INPUT -p icmp -j ACCEPT</p><p>## Zimbra rules for external access ##</p><p># iptables -A INPUT -p tcp –dport 25  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 80  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 110  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 143 -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 443  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 465  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 587  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 993  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 995  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 3443  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 9071  -j ACCEPT</p><p># iptables -A INPUT -p tcp –dport 7071  -j ACCEPT</p><h3 id="配置主机名HOSTNAME"><a href="#配置主机名HOSTNAME" class="headerlink" title="配置主机名HOSTNAME"></a>配置主机名HOSTNAME</h3><p><strong>修改配置文件</strong> <code>vi /etc/sysconfig/network</code> 内容 <code>HOSTNAME=mail.example.com</code> 或 <strong>命令设置</strong></p><p>hostnamectl set–hostname mail.example.com</p><p>hostnamectl status</p><p>hostname</p><h3 id="配置HOSTS"><a href="#配置HOSTS" class="headerlink" title="配置HOSTS"></a>配置HOSTS</h3><p>安装时会检查hosts文件内容要否符合要求：<ip><fqhn> <hn>核查hosts文件中的FQHN是否与与hostname一致，不一致安装中止</hn></fqhn></ip></p><p>不设置<ip><fqhn><hn>返回的错误信息：</hn></fqhn></ip></p><p>ERROR: Installation can not proceeed. Please fix your &#x2F;etc&#x2F;hosts file</p><p>to contain:</p><p>&lt;ip&gt; &lt;FQHN&gt; &lt;HN&gt;</p><p>Where &lt;IP&gt; is the ip address of the host,</p><p>&lt;FQHN&gt; is the FULLY QUALIFIED host name, and</p><p>&lt;HN&gt; is the (optional) hostname–only portion</p><p>错误信息2 出错原因也说的很详细了 注释掉有12.0.0.1的行 DO服务器注释掉<code>#centos-512mb-ams2-01 centos-512mb-ams2-01的行</code></p><p>ERROR: Installation can not proceeed. Please fix your &#x2F;etc&#x2F;hosts file</p><p>to contain:</p><p>127.0.0.1 localhost.localdomain localhost</p><p>Zimbra install grants mysql permissions only to localhost and</p><p>localhost.localdomain users. But Fedora&#x2F;RH installs leave lines such</p><p>as these in &#x2F;etc&#x2F;hosts:</p><p>127.0.0.1 myhost.mydomain.com myhost localhost.localdomain localhost</p><p>This causes MySQL to reject users coming from 127.0.0.1 as users from</p><p>myhost.mydomain.com. You can read more details at:</p><p><a target="_blank" rel="noopener" href="http://bugs.mysql.com/bug.php?id=11822">http://bugs.mysql.com/bug.php?id=11822</a></p><p><em>服务器IP</em> <em>完整域名</em> 主机名称（hostname命令显示的）</p><p>vi &#x2F;etc&#x2F;hosts</p><p>138.68.243.239 mail.example.com mail.example.com</p><h3 id="NTP"><a href="#NTP" class="headerlink" title="NTP"></a>NTP</h3><blockquote><p>Network Time Protocol（NTP）是用来使计算机时间同步化的一种协议，它可以使计算机对其服务器或时钟源（如石英钟，GPS等等)做同步化，它可以提供高精准度的时间校正（LAN上与标准间差小于1毫秒，WAN上几十毫秒），且可介由加密确认的方式来防止恶毒的协议攻击。</p></blockquote><p>yum install ntp</p><p>systemctl start ntpd</p><p>systemctl enable ntpd</p><h3 id="安装依赖包-wiki"><a href="#安装依赖包-wiki" class="headerlink" title="安装依赖包 wiki"></a>安装依赖包 <a target="_blank" rel="noopener" href="https://wiki.zimbra.com/wiki/Zimbra_dependencies_per_Operating_System">wiki</a></h3><p>从Zimbra Collaboration 8.7开始，Zimbra依赖于自己的存储库打包系统，这意味着Zimbra安装脚本会自动处理操作系统的依赖关系。</p><h3 id="安装及使用"><a href="#安装及使用" class="headerlink" title="安装及使用"></a>安装及使用</h3><p>wget <a target="_blank" rel="noopener" href="https://files.zimbra.com/downloads/8.7.5/_GA/zcs-8.7.5/_GA/_1764.RHEL7/_64.20170314032533.tgz">https://files.zimbra.com/downloads/8.7.5\_GA/zcs-8.7.5\_GA\_1764.RHEL7\_64.20170314032533.tgz</a></p><p>tar zxvf zcs–8.7.5_GA_1764.RHEL7_64.20170314032533.tgz</p><p>cd zcs–8.7.5_GA_1764.RHEL7_64.20170314032533</p><p># .&#x2F;install.sh</p><p>.&#x2F;install.sh —platform–override</p><p>安装出错可行一次：<code>/opt/zimbra/libexec/zmsetup.pl</code> 日志分析，不行就卸载重装了<code>./install.sh -u</code> 安装过程就不一一列出来了，能y的设置y，跳到菜单的时候选7、选4设置管理员密码，r返回，a 查看占用空间：<code>du -sh /opt/zimbra/</code> 切换到zimbra用户：<code>su - zimbra</code> 查看运行状态：<code>zmcontrol status</code> 重启服务：<code>zmcontrol restart</code> web管理界面：<a target="_blank" rel="noopener" href="https://mail.example.com:7071/">https://mail.example.com:7071/</a> web用户界面：<a target="_blank" rel="noopener" href="https://mail.example.com:7073/">https://mail.example.com:7073/</a> <strong>添加新域名</strong> example.com <strong>简单的收发邮件</strong>：example.com 设置@的MX记录到mail.example.com SPF,DKIM,DMARC <a target="_blank" rel="noopener" href="https://wiki.zimbra.com/wiki/Best_Practices_on_Email_Protection:_SPF,_DKIM_and_DMARC">wiki</a> <a target="_blank" rel="noopener" href="http://www.mail163.cn/anti-spam/">spam</a></p><h3 id="SPF"><a href="#SPF" class="headerlink" title="SPF"></a>SPF</h3><p>什么是SPF？ (Sender Policy Framework) 的缩写，一种以IP地址认证电子邮件发件人身份的技术，是非常高效的垃圾邮件解决方案。 接收邮件方会首先检查域名的SPF记录，来确定发件人的IP地址是否被包含在SPF记录里面，如果在，就认为是一封正确的邮件，否则会认为是一封伪造的邮件进行退回。 example.com 设置@的SPF和txt记录：v&#x3D;spf1 mx ~all（允许当前域名的mx记录对应的IP地址）</p><h3 id="DKIM"><a href="#DKIM" class="headerlink" title="DKIM"></a>DKIM</h3><p>Bug：</p><p>ZCS 8.7.x 已知问题 BUG zmdkimkeyutil 生成非有效的2048位DKIM 解决：&#x2F;opt&#x2F;zimbra&#x2F;libexec&#x2F;zmdkimkeyutil 修改所有2048关键字为1024 》升级DKIM签名：<code>/opt/zimbra/libexec/zmdkimkeyutil -u -d example.com</code> 》更改DNS设置 <strong>命令生成2048位DKIM</strong>：&#x2F;opt&#x2F;zimbra&#x2F;libexec&#x2F;zmdkimkeyutil -a -b 2048 -d example.com</p><p>DKIM是利用加密签名和验证的原理，发件人在发送邮件时候，将与域名相关的加密签名插入邮件，收件人收到邮件后就可以对签名进行验证，判断发件人地址的真实性。</p><ul><li>添加DKIM &#x2F;opt&#x2F;zimbra&#x2F;libexec&#x2F;zmdkimkeyutil -a -d example.com</li><li>升级DKIM &#x2F;opt&#x2F;zimbra&#x2F;libexec&#x2F;zmdkimkeyutil -u -d example.com</li><li>删除DKIM &#x2F;opt&#x2F;zimbra&#x2F;libexec&#x2F;zmdkimkeyutil -r -d example.com</li><li>查看DKIM &#x2F;opt&#x2F;zimbra&#x2F;libexec&#x2F;zmdkimkeyutil -q -d example.com</li></ul><p>生成1024位的DKIM 内容为</p><p>DKIM Data added to LDAP for domain example.com with selector E298BEBE–2D5A–11E7–9E70–F55E985B5BE7</p><p>Public signature to enter into DNS:</p><p>E298BEBE–2D5A–11E7–9E70–F55E985B5B17._domainkey IN TXT ( “v&#x3D;DKIM1; k&#x3D;rsa; “</p><p>“p&#x3D;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC5Lkk2XnUgA9LoHWYgDb1URxyTnab0WuHA9CKUFtLWrjV6S87bcpzoVa3</p><h3 id="DMARC"><a href="#DMARC" class="headerlink" title="DMARC"></a>DMARC</h3><p>[DMARC]协议的主要目的是识别并拦截钓鱼邮件 DNS记录 名称：_dmarc  值：v&#x3D;DMARC1; p&#x3D;none</p><h3 id="域名解析记录"><a href="#域名解析记录" class="headerlink" title="域名解析记录"></a>域名解析记录</h3><p>类型：txt DNS名称：E298BEBE-2D5A-11E7-9E70-F55E985B5B17._domainkey 值：”v&#x3D;DKIM1; k&#x3D;rsa;p&#x3D;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC5Lkk2XnUgA9LoHWYgDb1URxyTnab0WuHA9CKUFtLWrjV6S87bcpzoVa3fGVc&#x2F;jChVfu5E4ZTif&#x2F;jNkBPeow7wnwajEpFo8G&#x2F;yR0e8aNwDghW8DYf9B21QPAtB9NqoNjoUSD1tDsTXor2tSqf8wormbVhN3Y9aWkAxMEUP594zUwIDAQAB”</p><h3 id="验证DKIM"><a href="#验证DKIM" class="headerlink" title="验证DKIM"></a>验证DKIM</h3><p><strong>验证公钥是否与私钥匹配</strong> 测试通过没有任何信息返回，否则返回record not found &#x2F;opt&#x2F;zimbra&#x2F;common&#x2F;sbin&#x2F;opendkim-testkey -d example.com -s E298BEBE-2D5A-11E7-9E70-F55E985B5B17 -x &#x2F;opt&#x2F;zimbra&#x2F;conf&#x2F;opendkim.conf</p><h3 id="重新签发证书"><a href="#重新签发证书" class="headerlink" title="重新签发证书"></a>重新签发证书</h3><p>zimbra的证书有效期为365天，为了避免下次的麻烦，可以重新签发一个证书，有效期20年。</p><p>&#x2F;opt&#x2F;zimbra&#x2F;bin&#x2F;zmcertmgr createca –new</p><p>&#x2F;opt&#x2F;zimbra&#x2F;bin&#x2F;zmcertmgr deployca</p><p>&#x2F;opt&#x2F;zimbra&#x2F;bin&#x2F;zmcertmgr createcrt –new –days 7300</p><p>&#x2F;opt&#x2F;zimbra&#x2F;bin&#x2F;zmcertmgr deploycrt self</p><p>&#x2F;opt&#x2F;zimbra&#x2F;bin&#x2F;zmcertmgr viewdeployedcrt</p><h3 id="可以学习的内容"><a href="#可以学习的内容" class="headerlink" title="可以学习的内容"></a>可以学习的内容</h3><p>dnsmasq named</p><h3 id="小工具"><a href="#小工具" class="headerlink" title="小工具"></a>小工具</h3><p><a target="_blank" rel="noopener" href="https://intodns.com/one.one">https://intodns.com/one.one</a> DNS检查 <a target="_blank" rel="noopener" href="http://www.mail-tester.com/">http://www.mail-tester.com/</a> 邮件评分 <a target="_blank" rel="noopener" href="https://dmarcian.com/dmarc-inspector/mgtgxp.pw">https://dmarcian.com/dmarc-inspector/mgtgxp.pw</a> dmarc测试</p><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a target="_blank" rel="noopener" href="https://www.renfei.org/blog/introduction-to-spf.html">https://www.renfei.org/blog/introduction-to-spf.html</a> <a target="_blank" rel="noopener" href="http://170182.blog.51cto.com/160182/1272569">http://170182.blog.51cto.com/160182/1272569</a> <a target="_blank" rel="noopener" href="https://www.mawenbao.com/research/email-spf-and-exim4-dkim-dmarc-config.html">https://www.mawenbao.com/research/email-spf-and-exim4-dkim-dmarc-config.html</a> <a target="_blank" rel="noopener" href="http://imzhen.com/note/2015/08/09/20150809/">http://imzhen.com/note/2015/08/09/20150809/</a></p><blockquote><p><a target="_blank" rel="noopener" href="http://blog.topspeedsnail.com/archives/5546">CentOS 7 安装配置Zimbra邮件服务器</a></p></blockquote><p><a target="_blank" rel="noopener" href="https://www.chenxie.net/archives/1476.html">https://www.chenxie.net/archives/1476.html</a> <a target="_blank" rel="noopener" href="http://www.bkjia.com/Linux/1112319.html">http://www.bkjia.com/Linux/1112319.html</a> <a target="_blank" rel="noopener" href="https://bbotte.com/server-config/zimbra-configuration-mail-service-full-record/">https://bbotte.com/server-config/zimbra-configuration-mail-service-full-record/</a></p><blockquote><p><a target="_blank" rel="noopener" href="http://www.huike007.cn/?p=463">Zimbra8 安装说明</a></p></blockquote><p><a target="_blank" rel="noopener" href="http://blog.csdn.net/zzban/article/details/8640510">http://blog.csdn.net/zzban/article/details/8640510</a> <a target="_blank" rel="noopener" href="https://www.kenceng-solusindo.net/read/intalasi-zimbra-mail-server-ubuntu-16-04/">https://www.kenceng-solusindo.net/read/intalasi-zimbra-mail-server-ubuntu-16-04/</a> <a target="_blank" rel="noopener" href="http://record.blog.51cto.com/3300006/1206745">http://record.blog.51cto.com/3300006/1206745</a> <a target="_blank" rel="noopener" href="https://www.chenxie.net/archives/1476.html">https://www.chenxie.net/archives/1476.html</a> <a target="_blank" rel="noopener" href="http://www.linuxyw.com/linux/qitafuwu/20130605/540.html">http://www.linuxyw.com/linux/qitafuwu/20130605/540.html</a> <a target="_blank" rel="noopener" href="http://m.blog.chinaunix.net/uid-31075838-id-5698408.html">http://m.blog.chinaunix.net/uid-31075838-id-5698408.html</a></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Zimbra/" rel="tag"># Zimbra</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2018/10/18/hetzner%E4%BD%BF%E7%94%A8proxmox%E6%88%96%E8%80%85solusvm%E5%BC%80nat-kvm%E7%8B%AC%E7%AB%8Bipv6%E6%A1%A5%E6%8E%A5%E7%BD%91%E5%8D%A1%E8%AE%BE%E7%BD%AE/" rel="prev" title="hetzner使用proxmox或者solusvm开Nat kvm独立ipv6桥接网卡设置"><i class="fa fa-angle-left"></i> hetzner使用proxmox或者solusvm开Nat kvm独立ipv6桥接网卡设置</a></div><div class="post-nav-item"><a href="/2018/10/19/ssl%E4%BC%98%E5%8C%96/" rel="next" title="SSL优化">SSL优化 <i class="fa fa-angle-right"></i></a></div></div></footer></article></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Jarod</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">755k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">11:26</span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript></body></html>